require=function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Log",{enumerable:true,get:function get(){return _log["default"]}});exports.cookie=exports.calendar=exports.asCookie=exports.aria=void 0;Object.defineProperty(exports,"env",{enumerable:true,get:function get(){return _env.env}});exports.fcsStorage=exports.eventTrigger=exports.event=void 0;Object.defineProperty(exports,"fetchJSON",{enumerable:true,get:function get(){return _fetch.fetchJSON}});Object.defineProperty(exports,"fetchWithTimeout",{enumerable:true,get:function get(){return _fetch.fetchWithTimeout}});exports.jsonRpc=exports.imageReplacer=void 0;Object.defineProperty(exports,"scrollToElement",{enumerable:true,get:function get(){return _scroll.scrollToElement}});Object.defineProperty(exports,"scrollToPosition",{enumerable:true,get:function get(){return _scroll.scrollToPosition}});exports.support=exports.string=void 0;Object.defineProperty(exports,"telLinkReplacer",{enumerable:true,get:function get(){return _telLinkReplacer["default"]}});exports.userInputType=exports.truncate=void 0;var aria=_interopRequireWildcard(require("./src/aria/aria.js"));exports.aria=aria;var asCookie=_interopRequireWildcard(require("./src/cookie/asCookie.js"));exports.asCookie=asCookie;var cookie=_interopRequireWildcard(require("./src/cookie/cookie.js"));exports.cookie=cookie;var _env=require("./src/env/env.js");var event=_interopRequireWildcard(require("./src/event/event.js"));exports.event=event;var eventTrigger=_interopRequireWildcard(require("./src/eventTrigger/eventTrigger.js"));exports.eventTrigger=eventTrigger;var fcsStorage=_interopRequireWildcard(require("./src/fcsStorage/fcsStorage.js"));exports.fcsStorage=fcsStorage;var _fetch=require("./src/fetch/fetch.js");var imageReplacer=_interopRequireWildcard(require("./src/imageReplacer/imageReplacer.js"));exports.imageReplacer=imageReplacer;var jsonRpc=_interopRequireWildcard(require("./src/jsonRpc/jsonRpc.js"));exports.jsonRpc=jsonRpc;var _scroll=require("./src/scroll/scroll.js");var string=_interopRequireWildcard(require("./src/string/string.js"));exports.string=string;var support=_interopRequireWildcard(require("./src/support/support.js"));exports.support=support;var truncate=_interopRequireWildcard(require("./src/truncate/truncate.js"));exports.truncate=truncate;var userInputType=_interopRequireWildcard(require("./src/userInputType/userInputType.js"));exports.userInputType=userInputType;var calendar=_interopRequireWildcard(require("./src/calendar/calendar.js"));exports.calendar=calendar;var _log=_interopRequireDefault(require("./src/log/log.js"));var _telLinkReplacer=_interopRequireDefault(require("./src/telLinkReplacer/telLinkReplacer.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}},{"./src/aria/aria.js":2,"./src/calendar/calendar.js":3,"./src/cookie/asCookie.js":4,"./src/cookie/cookie.js":5,"./src/env/env.js":6,"./src/event/event.js":7,"./src/eventTrigger/eventTrigger.js":8,"./src/fcsStorage/fcsStorage.js":9,"./src/fetch/fetch.js":10,"./src/imageReplacer/imageReplacer.js":11,"./src/jsonRpc/jsonRpc.js":12,"./src/log/log.js":13,"./src/scroll/scroll.js":14,"./src/string/string.js":15,"./src/support/support.js":16,"./src/telLinkReplacer/telLinkReplacer.js":17,"./src/truncate/truncate.js":18,"./src/userInputType/userInputType.js":19}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.showOthers=exports.restoreFocusable=exports.hideOthers=exports.findStashedFocusable=exports.findFocusable=exports.disassociateNodes=exports.disableFocusable=exports.canBeDisabled=exports.associateNodes=void 0;var focusablesQuery="a,input,select,button,textarea,iframe,*[tabindex]";var savedFocusablesAttr="data-ariafocusable";var tabIndexSaveAttr="data-ariasaved-tabindex";var disabledSaveAttr="data-ariasaved-disabled";var ariaDisabledSaveAttr="data-ariasaved-ariadisabled";var hrefSaveAttr="data-ariasaved-href";var savedFocusablesQuery="*["+savedFocusablesAttr+"]";var ariaIdPrefix="aria-id-";var ariaIdCount=-1;var canBeDisabled=exports.canBeDisabled=function canBeDisabled(el){return el.tagName==="BUTTON"||el.tagName==="INPUT"};var getAriaGuid=function getAriaGuid(){return ariaIdPrefix+(ariaIdCount+=1)};var $$=function $$(sel){var el=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;return Array.from(el.querySelectorAll(sel))};var getSiblings=function getSiblings(el){var parent=el.parentNode;var children=parent?Array.from(parent.children):[];return children.filter(function(n){return n.nodeType===1&&n!==el})};var hideOthers=exports.hideOthers=function hideOthers(el){el.removeAttribute("aria-hidden");el.removeAttribute("tabindex");getSiblings(el).forEach(function(e){return e.setAttribute("aria-hidden","true")});var parent=el.parentElement;if(parent&&parent!==document.body){hideOthers(parent)}return el};var showOthers=exports.showOthers=function showOthers(el){$$("*[aria-hidden]").forEach(function(e){return e.removeAttribute("aria-hidden")});el.setAttribute("aria-hidden","true");el.setAttribute("tabindex","-1");return el};var associateNodes=exports.associateNodes=function associateNodes(el,describedBy){var describer=typeof describedBy==="string"?document.querySelector(describedBy):describedBy;if(describer){var originalId=describer.getAttribute("id");var newId=originalId||getAriaGuid();if(!originalId){describer.setAttribute("id",newId)}el.setAttribute("aria-describedby",newId)}return el};var disassociateNodes=exports.disassociateNodes=function disassociateNodes(el){el.removeAttribute("aria-describedby");return el};var tabIndexFilter=function tabIndexFilter(el){var tabIndex=parseInt(el.getAttribute("tabindex")||"",10);return isNaN(tabIndex)||tabIndex>=0};var findFocusable=exports.findFocusable=function findFocusable(el,count){var ignoreHidden=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var focusables=$$(focusablesQuery,el).filter(tabIndexFilter);var filtered=ignoreHidden?focusables.filter(function(e){return e.style.display!=="none"}):focusables;return count?filtered.slice(0,count):filtered};var findStashedFocusable=exports.findStashedFocusable=function findStashedFocusable(el){return $$(savedFocusablesQuery,el)};var disableFocusable=exports.disableFocusable=function disableFocusable(elements){elements.forEach(function(el){el.setAttribute(savedFocusablesAttr,"true");if(canBeDisabled(el)){var curDisabled=el.disabled;var oldDisabled=Boolean(el.getAttribute(disabledSaveAttr));var savedValue=oldDisabled||curDisabled?"true":"";el.setAttribute(disabledSaveAttr,savedValue);el.disabled=true}var curAriaDisabled=el.getAttribute("aria-disabled")||"";var oldAriaDisabled=el.getAttribute(ariaDisabledSaveAttr)||"";el.setAttribute(ariaDisabledSaveAttr,oldAriaDisabled||curAriaDisabled);el.setAttribute("aria-disabled","true");var curHref=el.getAttribute("href")||"";var oldHref=el.getAttribute(hrefSaveAttr)||"";if(curHref){el.setAttribute(hrefSaveAttr,oldHref||curHref);el.removeAttribute("href")}var curTabIndex=el.getAttribute("tabindex")||"";var oldTabIndex=el.getAttribute(tabIndexSaveAttr)||"";el.setAttribute(tabIndexSaveAttr,oldTabIndex||curTabIndex);el.setAttribute("tabindex","-1")})};var restoreFocusable=exports.restoreFocusable=function restoreFocusable(elements){elements.forEach(function(el){el.removeAttribute(savedFocusablesAttr);if(canBeDisabled(el)){var curDisabled=el.disabled;var oldDisabled=el.getAttribute(disabledSaveAttr);if(curDisabled){el.disabled=Boolean(oldDisabled)}el.removeAttribute(disabledSaveAttr)}var curAriaDisabled=el.getAttribute("aria-disabled")||"";var oldAriaDisabled=el.getAttribute(ariaDisabledSaveAttr)||"";if(curAriaDisabled==="true"){oldAriaDisabled?el.setAttribute("aria-disabled",oldAriaDisabled):el.removeAttribute("aria-disabled")}el.removeAttribute(ariaDisabledSaveAttr);var curHref=el.getAttribute("href")||"";var oldHref=el.getAttribute(hrefSaveAttr)||"";if(curHref===""&&oldHref)el.setAttribute("href",oldHref);el.removeAttribute(hrefSaveAttr);var curTabIndex=el.getAttribute("tabindex")||"";var oldTabIndex=el.getAttribute(tabIndexSaveAttr)||"";if(parseInt(curTabIndex,10)<0){if(oldTabIndex){el.setAttribute("tabindex",oldTabIndex)}else{el.removeAttribute("tabindex")}}el.removeAttribute(tabIndexSaveAttr)})}},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createEventFileURL=exports.createEvent=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var createEvent=exports.createEvent=function createEvent(_ref){var _event;var title=_ref.title,body=_ref.body,start=_ref.start,end=_ref.end,timeZone=_ref.timeZone,_ref$URL=_ref.URL,URL=_ref$URL===void 0?"":_ref$URL;var startKey="DTSTART;TZID=".concat(timeZone);var endKey="DTEND;TZID=".concat(timeZone);var calStart={BEGIN:"VCALENDAR",VERSION:"2.0",CALSCALE:"GREGORIAN"};var calEnd={END:"VCALENDAR"};var event=(_event={BEGIN:"VEVENT",SUMMARY:title,STATUS:"CONFIRMED"},_defineProperty(_event,startKey,start),_defineProperty(_event,endKey,end),_defineProperty(_event,"DESCRIPTION",body),_defineProperty(_event,"URL",URL),_defineProperty(_event,"END","VEVENT"),_event);var stringify=function stringify(acc,line){var _line=_slicedToArray(line,2),key=_line[0],val=_line[1];return"".concat(acc).concat(key,":").concat(val,"\n")};var calStartString=Object.entries(calStart).reduce(stringify,"");var eventString=Object.entries(event).reduce(stringify,"");var calEndString=Object.entries(calEnd).reduce(stringify,"");var _final="".concat(calStartString).concat(eventString).concat(calEndString);return _final};var createEventFileURL=exports.createEventFileURL=function createEventFileURL(event){var fileOptions=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var eventFile=new File([event],"",_objectSpread({type:"text/calendar"},fileOptions));var eventFileURL=window.URL.createObjectURL(eventFile);return eventFileURL}},{}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.getMapName=exports.getEnvName=exports.get=void 0;var _cookie=require("./cookie.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var getEnvName=exports.getEnvName=function getEnvName(cookieStr){var suffix=window.envCookieSuffix;var prefix=cookieStr.indexOf("as_")===-1?"as_":"";return suffix?prefix+cookieStr+suffix:cookieStr};var getMapName=exports.getMapName=function getMapName(cookieStr){var cookieMap=window.cookieMap;return cookieMap&&_typeof(cookieMap)==="object"&&cookieStr in cookieMap?cookieMap[cookieStr]:cookieStr};var set=exports.set=function set(key,value){var opts=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return(0,_cookie.set)(getMapName(key),value,opts)};var get=exports.get=function get(key){return(0,_cookie.get)(getMapName(key))}},{"./cookie.js":5}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.get=void 0;var _env=require("../env/env.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var expiresToDate=function expiresToDate(expires){if(typeof expires==="number"){var date=new Date;date.setTime(date.getTime()+(expires||0)*24*60*60*1e3);return date}return expires};var set=exports.set=function set(key,value){var opts=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var expiresOn=expiresToDate(value===null?-1:opts.expires);value=value===null?"":value;value=_typeof(value)==="object"?JSON.stringify(value):value;var expires=expiresOn?"; expires="+expiresOn.toUTCString():"";var path=opts.path?"; path="+opts.path:"";var domain=opts.domain?"; domain="+opts.domain:"";var secure=opts.secure?"; secure":"";var sameSite=opts.sameSite?"; samesite="+opts.sameSite:"";_env.env.setCookie(key+"="+encodeURIComponent(value)+expires+path+domain+secure+sameSite)};var get=exports.get=function get(key){var val=null;if(!key)return val;var cookies=(_env.env.getCookies()||"").split(";");for(var i=0;i<cookies.length;i++){var cookie=(cookies[i]||"").trim();if(cookie.substring(0,key.length+1)===key+"="){val=decodeURIComponent(cookie.substring(key.length+1));break}}if(val&&val.match(/^\s*\{/)){try{val=JSON.parse(val)}catch(e){}}return val}},{"../env/env.js":6}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.env=exports["default"]=void 0;var userAgent=function userAgent(ua){var isWebKit=/(AppleWebkit)/i.test(ua);var isChrome=/Chrome/.test(ua)&&/Google Inc/.test(navigator.vendor);var isAndroidMobile=/Android.*Mobile|Mobile.*Android/i.test(ua);var oldIe=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(ua);var newIe=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(ua);var allIe=oldIe&&oldIe[1]||newIe&&newIe[1];var isIpad=/(ipad)/i.test(ua);var isMobileIos=/(iphone|ipod)/i.test(ua)&&isWebKit;var iosMatch=isMobileIos||isIpad?ua.match(/os ([\d_]*)/i):null;var isIosChrome=/CriOS/.test(ua)&&isMobileIos;var iosVersionStr=iosMatch&&iosMatch[1]||"0";return{isMobileIos:isMobileIos,isIpad:isIpad,isAndroidMobile:isAndroidMobile,isIosChrome:isIosChrome,userAgent:ua,isPhantom:/Phantom/i.test(ua),isFirefox:/(Firefox)/i.test(ua),isChrome:/(Chrome)/i.test(ua),isSafari:/(Safari)/i.test(ua)&&!/(Chrome)/i.test(ua),isHandheldPhone:isMobileIos||isAndroidMobile,iosVersion:parseFloat(iosVersionStr.replace("_",".")),isIe:Boolean(allIe),ieVersion:parseFloat(allIe||"0"),isAndroidInternet:isAndroidMobile&&!isChrome&&isWebKit,androidVersion:isAndroidMobile?parseFloat(ua.slice(ua.indexOf("Android")+8)):0}};var env=exports.env={userAgent:userAgent,getReferrer:function getReferrer(){return document.referrer},getUrlHash:function getUrlHash(){return window.location.hash},setUrlHash:function setUrlHash(hash){window.location.hash=hash},doRedirect:function doRedirect(url){window.location.href=url},isOnline:function isOnline(){return window.navigator.onLine},getWindowQueryString:function getWindowQueryString(){return window.location.search},getCurrentPathname:function getCurrentPathname(){return window.location.pathname},getViewportScrollX:function getViewportScrollX(){return window.scrollX},getViewportScrollY:function getViewportScrollY(){return window.scrollY},getViewportHeight:function getViewportHeight(){return window.innerHeight||document.documentElement.clientHeight},getViewportWidth:function getViewportWidth(){return window.innerWidth||document.documentElement.clientWidth},submit:function submit(form){var formEl=form&&"get"in form?form.get(0):form;formEl.submit()},getFocused:function getFocused(){return document.activeElement},focus:function focus(element){return element.focus()},pixelRatio:window.devicePixelRatio,devicePixelRatio:function devicePixelRatio(newRatio){env.pixelRatio=newRatio!==undefined?newRatio:env.pixelRatio;return env.pixelRatio},selectedText:function selectedText(){var sel=window.getSelection();return sel?sel.toString():""},getCookies:function getCookies(){return document.cookie||""},setCookie:function setCookie(cookie){document.cookie=cookie}};var _default=exports["default"]=env},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.keys=exports.keyNames=exports.keyCodes=exports.isNumpadNumKey=exports.isMetaKey=exports.isAlphaNumKey=exports.StandardDeferredInputTimeout=exports.Mouse=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var keys=exports.keys={Backspace:8,Tab:9,Clear:12,Return:13,Shift:16,Ctrl:17,Alt:18,Esc:27,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45,CapsLock:20,LeftCommand:91,RightCommand:93,MozillaCommand:224,RightWindowsStart:92,Pause:19,Space:32,Help:47,LeftWindow:91,Select:93,NumPad0:96,NumPad1:97,NumPad2:98,NumPad3:99,NumPad4:100,NumPad5:101,NumPad6:102,NumPad7:103,NumPad8:104,NumPad9:105,NumPadMultiply:106,NumPadPlus:107,NumPadEnter:108,NumPadMinus:109,NumPadPeriod:110,NumPadDivide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NumLock:144,ScrollLock:145};var keyCodes=exports.keyCodes={};Object.entries(keys).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],val=_ref2[1];return keyCodes[val]=key});var keyNames=exports.keyNames={Unidentified:"Unidentified",Alt:"Alt",AltGraph:"AltGraph",CapsLock:"CapsLock",Control:"Control",Fn:"Fn",FnLock:"FnLock",Meta:"Meta",NumLock:"NumLock",ScrollLock:"ScrollLock",Shift:"Shift",Symbol:"Symbol",SymbolLock:"SymbolLock",Enter:"Enter",Tab:"Tab",Space:" ",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",End:"End",Home:"Home",PageDown:"PageDown",PageUp:"PageUp",Backspace:"Backspace",Clear:"Clear",Copy:"Copy",CrSel:"CrSel",Cut:"Cut",Delete:"Delete",EraseEof:"EraseEof",ExSel:"ExSel",Insert:"Insert",Paste:"Paste",Redo:"Redo",Undo:"Undo",Accept:"Accept",Again:"Again",Attn:"Attn",Cancel:"Cancel",ContextMenu:"ContextMenu",Escape:"Escape",Execute:"Execute",Find:"Find",Help:"Help",Pause:"Pause",Play:"Play",Props:"Props",Select:"Select",ZoomIn:"ZoomIn",ZoomOut:"ZoomOut"};var Mouse=exports.Mouse={Left:1,Right:3};var isMetaKey=exports.isMetaKey=function isMetaKey(event){return event.keyCode===keys.Tab||event.keyCode===keys.Clear||event.keyCode===keys.Return||event.keyCode===keys.Shift||event.keyCode===keys.Ctrl||event.keyCode===keys.Alt||event.keyCode===keys.Esc||event.keyCode===keys.ArrowLeft||event.keyCode===keys.ArrowUp||event.keyCode===keys.ArrowRight||event.keyCode===keys.ArrowDown||event.keyCode===keys.Home||event.keyCode===keys.End||event.keyCode===keys.PageUp||event.keyCode===keys.PageDown||event.keyCode===keys.Insert||event.keyCode===keys.CapsLock||event.keyCode===keys.LeftCommand||event.keyCode===keys.RightCommand||event.keyCode===keys.MozillaCommand||event.keyCode===keys.RightWindowsStart};var StandardDeferredInputTimeout=exports.StandardDeferredInputTimeout=333;var isNumpadNumKey=exports.isNumpadNumKey=function isNumpadNumKey(ev){return 96<=ev.keyCode&&ev.keyCode<=111};var isAlphaNumKey=exports.isAlphaNumKey=function isAlphaNumKey(ev){return isNumpadNumKey(ev)||!(ev.keyCode in keyCodes)}},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stop=exports.setup=void 0;var _event=require("../event/event.js");var parser=/^(\S+)\s*(.+)?$/;var triggerAttr="data-trigger";var contextAttr="data-trigger-context";var stopPropagationAttr="data-trigger-stoppropagation";var isSetup=false;var parsedStrings={};var $$=function $$(sel){var el=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;return Array.from(el.querySelectorAll(sel))};var getContext=function getContext(fromEl){for(var el=fromEl;el;el=el.parentElement){if(el.hasAttribute(contextAttr)){return el}}return document.body};var parseTrigger=function parseTrigger(action){action=action.trim();if(!parsedStrings[action]){var parts=action.split(",").map(function(p){return p.trim()}).filter(function(p){return!!p});var triggers=parts.map(function(part){var tokens=part.match(parser);return{type:tokens&&tokens[1],sel:tokens&&tokens[2]}});parsedStrings[action]=triggers}return parsedStrings[action]};var eventTrigger=function eventTrigger(triggerEl,action,ev){var actions=parseTrigger(action);var context=null;actions.forEach(function(_ref){var type=_ref.type,sel=_ref.sel;if(type==="preventDefault"){ev.preventDefault()}else if(type==="focus"||type==="click"){context=context||getContext(triggerEl);var targets=sel?$$(sel,context):[triggerEl];targets.forEach(function(target){return target[type]?target[type]():null})}})};var eventBubble=function eventBubble(ev){var initTarget=ev.target;var code=ev&&"keyCode"in ev?ev.keyCode:null;var hasCode=code!==null;var codeName=code!==null&&_event.keyCodes[code];for(var target=initTarget;target;target=target.parentElement){if(target&&target.hasAttribute(stopPropagationAttr))return;var attrValue=!hasCode&&target.getAttribute("".concat(triggerAttr,"-").concat(ev.type))||hasCode&&target.getAttribute("".concat(triggerAttr,"-").concat(code))||hasCode&&target.getAttribute("".concat(triggerAttr,"-").concat(codeName));if(attrValue){eventTrigger(target,attrValue,ev)}}};var setup=exports.setup=function setup(){if(isSetup){return}document.addEventListener("click",eventBubble);document.addEventListener("focusin",eventBubble);document.addEventListener("focusout",eventBubble);document.addEventListener("keydown",eventBubble);isSetup=true};var stop=exports.stop=function stop(){document.removeEventListener("click",eventBubble);document.removeEventListener("focusin",eventBubble);document.removeEventListener("focusout",eventBubble);document.removeEventListener("keydown",eventBubble);isSetup=false}},{"../event/event.js":7}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.storeFcsData=exports.setFcsDataForQbe=exports.setAcceptCookie=exports.flushFcsData=exports.appendFcsData=void 0;var getReferrerDomain=function getReferrerDomain(){var ref=document.referrer;var refUrl="";var refUrlArray=null;if(ref){refUrlArray=ref.split("/");if(refUrlArray!==null&&refUrlArray.length>=3){refUrl=refUrlArray[2]}return refUrl||""}return""};var localStorageToDom=function localStorageToDom(name,localKey){try{var fcs=document.querySelector('[name="'+name+'"]');var domValue=fcs?fcs.getAttribute("value"):null;if(fcs&&!domValue){var value=window.localStorage.getItem(localKey);fcs.setAttribute("value",value||"")}else if(fcs&&domValue){fcs.setAttribute("value",decodeURIComponent(domValue))}window.localStorage.removeItem(localKey)}catch(e){}};var localStorageToUrl=function localStorageToUrl(urlKey,url,localKey){try{var localVal=window.localStorage.getItem(localKey);var hasQuery=url.indexOf("?")>=0;if(localVal){url+=hasQuery?"&":"?";url+=urlKey+"="+encodeURIComponent(localVal)}}catch(e){}return url};var setFcsDataForQbe=exports.setFcsDataForQbe=function setFcsDataForQbe(){localStorageToDom("as-fcs1","as-fcs1");localStorageToDom("as-fcs2","as-fcs2")};var storeFcsData=exports.storeFcsData=function storeFcsData(){var key1="as-fcs1";var key2="as-fcs2";try{var bFirstPage=window.localStorage.getItem(key1);if(bFirstPage===null){var data={RD:getReferrerDomain(),LPU:document.URL,AC:false,SST:Math.round((new Date).getTime()/1e3)};window.localStorage.setItem(key1,JSON.stringify(data));window.localStorage.setItem(key2,"1")}else{var curCount=parseInt(window.localStorage.getItem(key2)||"0",10);window.localStorage.setItem(key2,(curCount+1).toString())}}catch(e){}};var appendFcsData=exports.appendFcsData=function appendFcsData(url){url=localStorageToUrl("f1",url,"as-fcs1");url=localStorageToUrl("f2",url,"as-fcs2");return url};var flushFcsData=exports.flushFcsData=function flushFcsData(){try{window.localStorage.removeItem("as-fcs1");window.localStorage.removeItem("as-fcs2")}catch(e){}};var setAcceptCookie=exports.setAcceptCookie=function setAcceptCookie(){try{var fcsData=window.localStorage.getItem("as-fcs1");if(fcsData){fcsData=JSON.parse(fcsData,function(k,v){if(k==="AC"){return true}return v});window.localStorage.setItem("as-fcs1",JSON.stringify(fcsData))}}catch(e){}}},{}],10:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.fetchWithTimeout=exports.fetchJSON=exports.TimeoutError=exports.JSONError=exports.HTTPError=void 0;function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(h).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)})}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct.bind()}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _isNativeFunction(fn){try{return Function.toString.call(fn).indexOf("[native code]")!==-1}catch(e){return typeof fn==="function"}}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var HTTPError=exports.HTTPError=function(_Error){_inherits(HTTPError,_Error);var _super=_createSuper(HTTPError);function HTTPError(response,request){var _this;_classCallCheck(this,HTTPError);var code=response.status||response.status===0?response.status:"";var title=response.statusText||"";var status="".concat(code," ").concat(title).trim();var reason=status?"response.status: ".concat(status):"an unknown error";request.options&&delete request.options.body;request.options&&delete request.options.headers;_this=_super.call(this,"Request failed with ".concat(reason,", response.type: ").concat(response.type,", response.redirected: ").concat(response.redirected,", request.options: ").concat(JSON.stringify(request.options),", content-type: ").concat(response.headers&&response.headers.get("Content-Type"),", x-request-id: ").concat(response.headers&&response.headers.get("x-request-id")));_this.name="HTTPError";_this.code=code;return _this}return _createClass(HTTPError)}(_wrapNativeSuper(Error));var JSONError=exports.JSONError=function(_Error2){_inherits(JSONError,_Error2);var _super2=_createSuper(JSONError);function JSONError(response,request,error){var _this2;_classCallCheck(this,JSONError);var code=response.status||response.status===0?response.status:"";var title=response.statusText||"";var status="".concat(code," ").concat(title).trim();var reason=status?"response.status: ".concat(status):"an unknown error";request.options&&delete request.options.body;request.options&&delete request.options.headers;_this2=_super2.call(this,"Received non-JSON response from JSON API with error.message: ".concat(error&&error.message,", ").concat(reason,", response.type: ").concat(response.type,", response.redirected: ").concat(response.redirected,", request.options: ").concat(JSON.stringify(request.options),", content-type: ").concat(response.headers&&response.headers.get("Content-Type"),", x-request-id: ").concat(response.headers&&response.headers.get("x-request-id")));_this2.name="JSONError";_this2.code=code;return _this2}return _createClass(JSONError)}(_wrapNativeSuper(Error));var TimeoutError=exports.TimeoutError=function(_Error3){_inherits(TimeoutError,_Error3);var _super3=_createSuper(TimeoutError);function TimeoutError(request){var _this3;_classCallCheck(this,TimeoutError);request.options&&delete request.options.body;request.options&&delete request.options.headers;_this3=_super3.call(this,"Request timed out after ".concat(request.options&&request.options.timeout," ms, request.options: ").concat(JSON.stringify(request.options)));_this3.name="TimeoutError";_this3.code=408;return _this3}return _createClass(TimeoutError)}(_wrapNativeSuper(Error));var fetchWithTimeout=exports.fetchWithTimeout=function(){var _ref=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(url){var options,timerId,abortController,req,fetchCall,timer,res,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:options=_args.length>1&&_args[1]!==undefined?_args[1]:{};options.timeout=options.timeout||1e4;abortController=new AbortController;req={url:url,options:_objectSpread({method:"GET",credentials:"same-origin",signal:abortController.signal},options)};fetchCall=fetch(req.url,req.options).then(function(res){return res});timer=new Promise(function(_resolve,reject){timerId=setTimeout(function(){abortController.abort();reject(new TimeoutError(req))},options.timeout)});_context.prev=6;_context.next=9;return Promise.race([fetchCall,timer]);case 9:res=_context.sent;if(!res.ok){_context.next=14;break}return _context.abrupt("return",res);case 14:throw new HTTPError(res,req);case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context["catch"](6);throw _context.t0;case 20:_context.prev=20;clearTimeout(timerId);return _context.finish(20);case 23:case"end":return _context.stop()}},_callee,null,[[6,17,20,23]])}));return function fetchWithTimeout(_x){return _ref.apply(this,arguments)}}();var fetchJSON=exports.fetchJSON=function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark(function _callee2(url){var options,res,req,data,_args2=arguments;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:options=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};req={url:url,options:options};_context2.prev=2;_context2.next=5;return fetchWithTimeout(req.url,req.options);case 5:res=_context2.sent;_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](2);throw _context2.t0;case 11:_context2.prev=11;_context2.next=14;return res.json();case 14:data=_context2.sent;return _context2.abrupt("return",data);case 18:_context2.prev=18;_context2.t1=_context2["catch"](11);throw new JSONError(res,req,_context2.t1);case 21:case"end":return _context2.stop()}},_callee2,null,[[2,8],[11,18]])}));return function fetchJSON(_x2){return _ref2.apply(this,arguments)}}()},{}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setup=exports.replace=exports.forceReplace=void 0;var _cookie=require("../cookie/cookie.js");var attrImg="data-scale-image-";var attrPar="data-scale-params-";var attrInitialScale="data-scale-initial";var cookieName="pxro";var pxOld=1;var pxNew=1;var cookieOpts={path:"/",domain:".apple.com",expires:365,secure:true};var $$=function $$(sel){var el=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;return Array.from(el.querySelectorAll(sel))};var replace=exports.replace=function replace(){if(pxNew===pxOld||pxNew&&pxOld&&pxNew<pxOld){return}$$("img").forEach(function(el){var initialScale=parseInt(el.getAttribute(attrInitialScale)||"1",10);var attr=el.getAttribute(attrImg+pxNew)?attrImg:el.getAttribute(attrPar+pxNew)?attrPar:null;if(el.classList.contains("ir")&&attr&&initialScale<pxNew){var src=el.getAttribute("src")||"";var srcSep=src.lastIndexOf(attr===attrImg?"/":"?");var srcPre=src.slice(0,srcSep+1);var srcPost=src.slice(srcSep+1);el.setAttribute("src",srcPre+el.getAttribute(attr+pxNew));el.setAttribute(attr+pxOld,srcPost);el.removeAttribute(attr+pxNew)}})};var forceReplace=exports.forceReplace=function forceReplace(){if(window.irOn){pxNew=Math.round(window.devicePixelRatio||1)>=2?2:1;replace()}};var setup=exports.setup=function setup(){pxOld=parseFloat((0,_cookie.get)(cookieName));pxNew=pxOld;var pxDevice=Math.round(window.devicePixelRatio||1)>=2?2:1;var inDebugMode=window.location.search&&window.location.search.match("debug.pixelRatio");if(inDebugMode){return}if(window.irOn){if(!pxOld||pxOld!==pxDevice){(0,_cookie.set)(cookieName,pxDevice,cookieOpts);pxNew=pxDevice;replace()}}else{(0,_cookie.set)(cookieName,1,cookieOpts)}}},{"../cookie/cookie.js":5}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.convertJsonRpc=void 0;var _env=require("../env/env.js");var unencodedDoubleQuote=/"/g;var encodedDoubleQuote="&quot;";var createHidden=function createHidden(form,k,v){var input=document.createElement("input");input.setAttribute("type","hidden");input.setAttribute("name",k.replace(unencodedDoubleQuote,encodedDoubleQuote));input.setAttribute("value",v.replace(unencodedDoubleQuote,encodedDoubleQuote));form.appendChild(input)};var post=function post(url,args){if(!url){return}var form=document.createElement("form");var paramCache={};form.setAttribute("id","AsJsonRpcForm");form.setAttribute("action",url);form.setAttribute("method","post");if(args){for(var argKey in args){var arg=args[argKey];if(Array.isArray(arg)){for(var k=0;k<arg.length;k++){if(paramCache[k]!==arg[k]){createHidden(form,k+"",arg[k]+"");paramCache[k]=arg[k]}}}else{if(paramCache[argKey]!==arg){createHidden(form,argKey,arg+"");paramCache[argKey]=arg}}}}form.style.display="none";document.body.appendChild(form);form.submit()};var get=function get(url,args){if(!url){return}var params=[];if(args){for(var key in args){params.push(encodeURIComponent(key)+"="+encodeURIComponent(args[key]+""))}url+=(url.indexOf("?")>-1?"&":"?")+params.join("&")}_env.env.doRedirect(url)};var convertJsonRpc=exports.convertJsonRpc=function convertJsonRpc(response){if(!response){return null}var head=response.head&&response.head.data||{};var method=head.method?(head.method+"").toLowerCase():"get";var status=parseInt((response.head&&response.head.status)+"",10);var isRedirect=status>=301&&status<=307;var isError=status>=400&&status<600;var useGet=method==="get"||method==="delete"||method==="put";if(isRedirect&&useGet){get(head.url,head.args)}else if(isRedirect&&method==="post"){post(head.url,head.args)}return isError||isRedirect?null:response.body||null}},{"../env/env.js":6}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var createAndDispatchEchoEvent=function createAndDispatchEchoEvent(data){var event=new CustomEvent("echoLogEvent",{detail:data});window.dispatchEvent(event)};function formatErrorOrObject(error){var errorData={message:error.message,colno:error.colno,lineno:error.lineno,stack:error.stack||error.error&&error.error.stack,name:error.name,code:error.code};return _objectSpread(_objectSpread({},error),errorData)}var Log=function Log(moduleName){if(!moduleName){throw new Error("moduleName parameter required for Logger")}var LOG_LEVELS={TRACE:4,DEBUG:3,INFO:2,WARN:1,ERROR:0};var logLevel;var globalLevel;var sendEvent=function sendEvent(level){return function(message){globalLevel=window.sessionStorage.getItem("AS_LOG_LEVEL")||window.AS_LOG_LEVEL||LOG_LEVELS.ERROR;if(globalLevel in LOG_LEVELS){logLevel=LOG_LEVELS[globalLevel]}else{logLevel=LOG_LEVELS.ERROR}if(LOG_LEVELS[level]<=logLevel){try{var enrichedMessage;if(typeof message==="string"||typeof message==="number"||typeof message==="boolean"||typeof message==="bigint"){enrichedMessage={message:message}}else if(Array.isArray(message)){enrichedMessage={message:message.toString()}}else{enrichedMessage=formatErrorOrObject(message)}createAndDispatchEchoEvent(_objectSpread(_objectSpread({},enrichedMessage),{},{id:moduleName,type:level.toLowerCase()}));console[level.toLowerCase()](message)}catch(ex){console.error("as-utilities/logger: could not log message",ex)}}}};return{error:sendEvent("ERROR"),warn:sendEvent("WARN"),info:sendEvent("INFO"),debug:sendEvent("DEBUG"),trace:sendEvent("TRACE")}};var _default=exports["default"]=Log},{}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.scrollToPosition=exports.scrollToElement=void 0;var EasingFunctions={linear:function linear(t){return t},"ease-in":function easeIn(t){return Math.pow(t,2)},"ease-out":function easeOut(t){return t*(2-t)},"ease-in-out":function easeInOut(t){return t<.5?2*Math.pow(t,2):(4-2*t)*t-1},"ease-in-cubic":function easeInCubic(t){return Math.pow(t,3)},"ease-out-cubic":function easeOutCubic(t){return Math.pow(t-1,3)+1}};var scrollToPosition=exports.scrollToPosition=function scrollToPosition(scrollEl,position){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new window.Promise(function(resolve){var _options$duration=options.duration,duration=_options$duration===void 0?400:_options$duration,_options$easing=options.easing,easing=_options$easing===void 0?"linear":_options$easing,_options$abortAfterTi=options.abortAfterTimeout,abortAfterTimeout=_options$abortAfterTi===void 0?true:_options$abortAfterTi;var easingFunction=EasingFunctions[easing]||EasingFunctions.linear;var startPosition=window.scrollY;var targetPosition=Math.min(Math.max(0,position),scrollEl.scrollHeight-window.innerHeight);var start;var abort=false;var animate=function animate(now){if(!start)start=now;var time=(now-start)/duration;var progress=easingFunction(time);var distance=Math.abs(startPosition-targetPosition);var direction=Math.sign(targetPosition-startPosition);var delta=direction*progress*distance;var bound=direction>0?Math.min:Math.max;var currentPosition=bound(startPosition+delta,targetPosition);scrollEl.scrollTop=currentPosition;var done=direction>0?currentPosition>=targetPosition:currentPosition<=targetPosition;if(!done&&!abort){requestAnimationFrame(animate)}else{resolve("done")}};if(startPosition!==targetPosition){requestAnimationFrame(animate);if(abortAfterTimeout){window.setTimeout(function(){abort=true},duration)}}else{resolve("done")}})};var scrollToElement=exports.scrollToElement=function scrollToElement(scrollEl,el,options){var targetPosition=el.offsetTop;return scrollToPosition(scrollEl,targetPosition,options)}},{}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.truncate=exports.stripTags=exports.stripPunctuationAtStart=exports.stripPunctuationAtEnd=exports.queryParams=exports.parseUrl=exports.parseQueryString=exports.makeUrl=exports.isNumeric=exports.format=exports.extendUrlQuery=exports.escapeRegExp=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var anchorElementCache=null;var punctuationCharacters=""+"[\\s!\\?\\.\\,:;_\\-~`'\"#\\$&\\*@\\^\\|\\/]";var punctuationStart=new RegExp("^"+punctuationCharacters+"+");var punctuationEnd=new RegExp(punctuationCharacters+"+$");var tagContent=/<[^>]*>/g;var encodedSpace=/\+/g;var defaultTruncateLength=30;var defaultTruncateOmission="";var defaultTruncateFrom="end";var canBeInterpolated=function canBeInterpolated(value){return value===0||!!value};var stripPunctuationAtEnd=exports.stripPunctuationAtEnd=function stripPunctuationAtEnd(s){return s.replace(punctuationEnd,"")};var stripPunctuationAtStart=exports.stripPunctuationAtStart=function stripPunctuationAtStart(str){return str.replace(punctuationStart,"")};var stripTags=exports.stripTags=function stripTags(str){return str.replace(tagContent,"")};var isNumeric=exports.isNumeric=function isNumeric(n){var number=parseFloat(n);return!isNaN(number)&&isFinite(number)};var queryParams=exports.queryParams=function queryParams(source){return Object.keys(source).map(function(k){return encodeURIComponent(k)+"="+encodeURIComponent(""+source[k])}).join("&")};var truncate=exports.truncate=function truncate(str){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var length=options.length||defaultTruncateLength;var omit=options.omission||defaultTruncateOmission;var from=options.from||defaultTruncateFrom;if(str&&str.length>length){var sliceLength=from==="middle"?Math.floor(length/2):length;var start=from==="start"?"":str.slice(0,sliceLength);var end=from==="end"?"":str.slice(-1*sliceLength);return stripPunctuationAtEnd(start).trim()+omit+stripPunctuationAtStart(end).trim()}return str};var parseQueryString=exports.parseQueryString=function parseQueryString(qs){var result={};qs=qs.charAt(0)==="?"||qs.charAt(0)==="#"?qs.substring(1):qs;qs.split("&").forEach(function(keyValue){var _keyValue$split=keyValue.split("="),_keyValue$split2=_slicedToArray(_keyValue$split,2),key=_keyValue$split2[0],_keyValue$split2$=_keyValue$split2[1],rawValue=_keyValue$split2$===void 0?"":_keyValue$split2$;var value=decodeURIComponent(rawValue.replace(encodedSpace," "));var curValue=result[key];if(value&&curValue){var curArray=Array.isArray(curValue)?curValue:[curValue];curArray.push(value);result[key]=curArray}else if(value){result[key]=value}});return result};var parseUrl=exports.parseUrl=function parseUrl(url){var anchor=anchorElementCache||document.createElement("a");anchorElementCache=anchor;anchor.href=url;var protocol=anchor.protocol,hostname=anchor.hostname,search=anchor.search,hash=anchor.hash;var hasSlash=(anchor.pathname||"").charAt(0)==="/";var pathname=hasSlash?anchor.pathname:"/"+anchor.pathname;var port=anchor.port==="0"?"":anchor.port;return{protocol:protocol,hostname:hostname,pathname:pathname,port:port,search:search,hash:hash}};var makeUrl=exports.makeUrl=function makeUrl(options){var protocol=options.protocol,hostname=options.hostname,pathname=options.pathname,port=options.port,search=options.search,hash=options.hash;var prefixedPort=port?":"+port:"";var prefix=hostname?protocol+"//"+hostname+prefixedPort:"";return prefix+pathname+search+hash};var extendUrlQuery=exports.extendUrlQuery=function extendUrlQuery(url,map){var parsedUrl=parseUrl(url);var params=parseQueryString(parsedUrl.search);Object.keys(map).forEach(function(k){return params[k]=map[k]});parsedUrl.search="?"+queryParams(params);return makeUrl(parsedUrl)};var escapeRegExp=exports.escapeRegExp=function escapeRegExp(str){return str.replace(/([[\\^$.|?*+(){}])/g,"\\$1")};var format=exports.format=function format(str,params){var start=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"{";var end=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"}";if(str===null||str===undefined){return String(str)}var startEscaped=escapeRegExp(start);var endEscaped=escapeRegExp(end);return str.replace(new RegExp("".concat(startEscaped,"([\\w-]+)").concat(endEscaped),"g"),function(all,key){return canBeInterpolated(params[key])?params[key]+"":""})}},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.threeDTransformsSupport=exports.supportsARFun=exports.setup=exports.getSupportedFeatures=exports.cssSupport=exports.cssPropertyValuePrefix=exports.cssPropertyName=void 0;var _env=require("../env/env.js");var dashPrefixes=["","-webkit-","-moz-","-o-","-ms-","-khtml-"];var prefixes=["","Webkit","Moz","O","ms","Khtml"];var supportCache=null;var domCache=null;var getDomCache=function getDomCache(){var element=domCache||document.createElement("div");domCache=element;return element};var isValidCssStr=function isValidCssStr(str){return Boolean(str||str==="")};var cssPropertyValuePrefix=exports.cssPropertyValuePrefix=function cssPropertyValuePrefix(cssName,cssValue){if(cssName==="length"||cssName==="parentRule"){return null}var domTestSupport=getDomCache();domTestSupport.style[cssName]="";var oldCssVal=domTestSupport.style[cssName];var domSupportPrefix=dashPrefixes.find(function(prefix){domTestSupport.style[cssName]=prefix+cssValue;var doesSupport=domTestSupport.style[cssName]!==oldCssVal;domTestSupport.style[cssName]="";return doesSupport});if(typeof domSupportPrefix==="string"){return domSupportPrefix}return null};var cssPropertyName=exports.cssPropertyName=function cssPropertyName(cssName){var docStyle=document&&document.documentElement.style;var cssUpper=cssName.charAt(0).toUpperCase()+cssName.slice(1);var cssNames=prefixes.map(function(pre){return pre?pre+cssUpper:cssName});return cssNames.find(function(name){return name in docStyle})||null};var cssSupport=exports.cssSupport=function cssSupport(cssName,usePrefixes){var prefix=usePrefixes&&cssPropertyName(cssName);return prefix?true:isValidCssStr(getDomCache().style[cssName])};var createTestHtml=function createTestHtml(parent,tagName,id,text){var el=document.createElement(tagName);el.id=id;el.textContent=text;parent.appendChild(el);return el};var threeDTransformsSupport=exports.threeDTransformsSupport=function threeDTransformsSupport(){var hasOwnProp=Object.prototype.hasOwnProperty;try{var hasMedium=hasOwnProp.call(window,"styleMedia")&&window.styleMedia.matchMedium("(-webkit-transform-3d)");if(hasMedium){return true}else{var style=document.getElementById("supportsThreeDStyle")||createTestHtml(document.head,"style","supportsThreeDStyle","@media (transform-3d),"+"(-o-transform-3d),(-moz-transform-3d),"+"(-ms-transform-3d),(-webkit-transform-3d) "+"{ #supportsThreeD { height:3px } }");var div=document.getElementById("supportsThreeD")||createTestHtml(document.body,"div","supportsThreeD","");return div.offsetHeight===3||"MozTransform"in style.style||"WebkitTransform"in style.style}}catch(e){return false}};var supportsARFun=exports.supportsARFun=function supportsARFun(){try{var testEl=document.createElement("a");return testEl.relList?testEl.relList.supports("ar"):false}catch(e){return false}};var getSupportedFeatures=exports.getSupportedFeatures=function getSupportedFeatures(){if(supportCache){return supportCache}var input=document.createElement("input");var textarea=document.createElement("textarea");var svgNsUrl="http://www.w3.org/2000/svg";var userAgentInfo=_env.env.userAgent(navigator.userAgent);var userAgent=userAgentInfo.userAgent;var isMobileIos=userAgentInfo.isMobileIos;var isIpad=userAgentInfo.isIpad;var iosVersion=userAgentInfo.iosVersion;var isIe=userAgentInfo.isIe;var ieVersion=userAgentInfo.ieVersion;var isPhantom=userAgentInfo.isPhantom;var isAndroidMobile=userAgentInfo.isAndroidMobile;var isAndroidInternet=userAgentInfo.isAndroidInternet;var androidVersion=userAgentInfo.androidVersion;var isHandheldPhone=userAgentInfo.isHandheldPhone;var isSafari=userAgentInfo.isSafari;var appVersion=navigator.appVersion;var docStyle=document&&document.documentElement.style;var domTestSupport=getDomCache();var webkitMatch=userAgent.match(/AppleWebKit\/(\d+)/);var webkitVersionStr=webkitMatch&&webkitMatch[1]||"";var webkitVersion=parseFloat(webkitVersionStr)||null;var os=appVersion.indexOf("Mac")!==-1?"macosx":appVersion.indexOf("X11")!==-1?"linux":appVersion.indexOf("Linux")!==-1?"linux":appVersion.indexOf("SunOS")!==-1?"sunos":"windows";var hasOnTransitionEnd=Boolean(window.ontransitionend);var usesModernTransition=("transition"in docStyle||"MozTransition"in docStyle)&&(!isAndroidMobile||isAndroidMobile&&hasOnTransitionEnd);var transitionEndName=usesModernTransition?"transitionend":"msTransition"in docStyle?"MSTransitionEnd":"WebkitTransition"in docStyle?"webkitTransitionEnd":null;var animationEndName=usesModernTransition?"animationend":"msTransition"in docStyle?"MSAnimationEnd":"WebkitTransition"in docStyle?"webkitAnimationEnd":null;try{domTestSupport.style.height="100vh"}catch(e){}var vhHeight=domTestSupport.style.height==="100vh";try{domTestSupport.style.height=""}catch(e){}var support={cssPropertyName:cssPropertyName,cssPropertyValuePrefix:cssPropertyValuePrefix,inputPlaceholder:"placeholder"in input,maxlengthTextarea:"maxLength"in textarea,onInput:"oninput"in input,touch:!!("ontouchstart"in window)&&!isPhantom,overflowScrolling:cssSupport("overflowScrolling",true),textOverflow:cssSupport("textOverflow",true),transform:cssSupport("transform",true),boxShadow:cssSupport("boxShadow",true),opacity:cssSupport("opacity",false),animation:cssSupport("animationName",true),transition:cssSupport("transitionProperty",true),transformProperty:cssPropertyName("transform"),positionSticky:cssPropertyValuePrefix("position","sticky")!==null,gradient:cssPropertyValuePrefix("backgroundImage","linear-gradient(top, black, white)")!==null,backgroundSvg:Boolean(document.createElementNS&&document.createElementNS(svgNsUrl,"svg").createSVGRect),threeDTransforms:threeDTransformsSupport(),supportsAR:supportsARFun(),webkitVersion:webkitVersion,iosVersion:iosVersion,ieVersion:ieVersion,androidVersion:androidVersion,os:os,vhHeight:vhHeight,transitionEndName:transitionEndName,animationEndName:animationEndName,isMobileIos:isMobileIos,isIpad:isIpad,isSafari:isSafari,isIe:isIe,isAndroidMobile:isAndroidMobile,isAndroidInternet:isAndroidInternet,isHandheldPhone:isHandheldPhone,rtl:false,isMobileOptimized:false};supportCache=support;return support};var setup=exports.setup=function setup(){var htm=document.documentElement;var support=getSupportedFeatures();htm.classList.add(support.backgroundSvg?"svg":"no-svg");htm.classList.add(support.touch?"touch":"no-touch");htm.classList.add(support.isIe&&support.ieVersion>=9?"ie":"no-ie");htm.classList.add(support.isIe&&support.ieVersion<9?"oldie":"no-oldie");htm.classList.add(support.isMobileIos||support.isIpad?"ios":"no-ios");htm.classList.add(support.animation?"supports-animation":"no-supports-animation");htm.classList.add(cssSupport("columns",true)?"supports-columns":"no-supports-columns");htm.classList.add(cssSupport("backdropFilter",true)?"supports-backdrop-filter":"no-supports-backdrop-filter");htm.classList.add(support.isSafari&&support.supportsAR?"supports-ar":"no-supports-ar");support.rtl=window.getComputedStyle(document.body).direction==="rtl"}},{"../env/env.js":6}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var telLinkReplacer=function telLinkReplacer(){var telLinkSelector="[data-tel-link].tel-link";var telLinkReplacedClass="tel-link-replaced";var telLinkElems=Array.from(document.querySelectorAll(telLinkSelector));if(telLinkElems.length){telLinkElems.forEach(function(el){var telHref=el.getAttribute("data-tel-link");if(!telHref){return}el.setAttribute("data-tel-link","");el.classList.remove("tel-link");if(el.nodeName==="A"){el.setAttribute("href","tel: ".concat(telHref));el.classList.add(telLinkReplacedClass)}else{el.outerHTML="\n                    <a class=".concat(telLinkReplacedClass,' href="tel: ').concat(telHref,'">\n                        ').concat(el.outerHTML,"\n                    </a>\n                ")}})}};var _default=exports["default"]=telLinkReplacer},{}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.truncateElementText=exports.truncateAll=exports.stop=exports.setup=exports["default"]=exports.attrTruncate=void 0;var _string=require("../string/string.js");var attrTruncate=exports.attrTruncate="data-as-truncate";var attrOriginalText="title";var ellipsis="";var handlerResize=null;var handlerLoad=null;var exceedsHeight=function exceedsHeight(el,maxHeight){return el.getBoundingClientRect().height>maxHeight};var exceedsWidth=function exceedsWidth(el){var TOLERANCE=1;var parent=el.parentElement;return parent?parent.scrollWidth-TOLERANCE>parent.clientWidth:false};var findNextBreakpoint=function findNextBreakpoint(text,start,end){var index=text.substring(start,end+1).search(/(\s|-)/);return index>-1?start+index:-1};var truncateElementText=exports.truncateElementText=function truncateElementText(el){var maxLines=parseInt(el.getAttribute(attrTruncate)||"",10)||1;var textAttr=el.getAttribute(attrOriginalText);var textContent=el.textContent||"";var text=textAttr||textContent.replace(/\.\.\./g,ellipsis).trim();el.innerHTML=Array(maxLines).fill("i").join("<br/>");var maxHeight=el.getBoundingClientRect().height;if(!textAttr){el.setAttribute(attrOriginalText,text)}el.textContent=text;var hasManyWords=exceedsHeight(el,maxHeight);var hasLongWord=exceedsWidth(el);var canSplit=hasLongWord||el.matches(":lang(zh), :lang(jp)");if(!hasLongWord&&!hasManyWords){el.removeAttribute(attrOriginalText);return}var lo=0;var hi=text.length;while(hi>lo){var mid=Math.ceil((lo+hi)/2);var nextBreak=findNextBreakpoint(text,mid,hi);var length=nextBreak>-1?nextBreak:canSplit?mid:-1;if(length>-1){el.textContent=(0,_string.truncate)(text,{length:length})}var isTooLong=length<0||exceedsWidth(el);var hasOverflow=isTooLong||exceedsHeight(el,maxHeight);hi=hasOverflow?mid-1:hi;lo=hasOverflow?lo:mid}el.textContent=(0,_string.truncate)(text,{length:lo})};var truncateAll=exports.truncateAll=function truncateAll(){var container=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document.body;var els=container.querySelectorAll("[".concat(attrTruncate,"]"));Array.from(els).forEach(function(el){return truncateElementText(el)})};var setup=exports.setup=function setup(){var container=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document.body;stop();var handlerBound=function handlerBound(){truncateAll(container)};var resizeTimer=-1;handlerLoad=handlerBound;handlerResize=function handlerResize(){window.clearTimeout(resizeTimer);resizeTimer=window.setTimeout(handlerBound,100)};window.addEventListener("load",handlerLoad);window.addEventListener("resize",handlerResize);handlerBound()};var stop=exports.stop=function stop(){if(handlerLoad){window.removeEventListener("load",handlerLoad);handlerLoad=null}if(handlerResize){window.removeEventListener("resize",handlerResize);handlerResize=null}};var _default=exports["default"]=truncateElementText},{"../string/string.js":15}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stop=exports.setup=exports.isKeyboardType=exports.classIsMouse=exports.classIsKeyboard=void 0;var _event=require("../event/event.js");var classIsMouse=exports.classIsMouse="as-mouseuser";var classIsKeyboard=exports.classIsKeyboard="as-keyboarduser";var keyList=[_event.keys.Tab,_event.keys.Esc,_event.keys.Alt,_event.keys.Ctrl,_event.keys.ArrowDown,_event.keys.ArrowLeft,_event.keys.ArrowRight,_event.keys.ArrowUp];var domMain=null;var isMouse=false;var isKeyboard=false;var isSetup=false;var updateClasses=function updateClasses(){if(!domMain){return}domMain.classList.toggle(classIsMouse,isMouse);domMain.classList.toggle(classIsKeyboard,isKeyboard)};var handleMouse=function handleMouse(){if(!isMouse){isMouse=true;isKeyboard=false;updateClasses()}};var handleKey=function handleKey(ev){if(!isKeyboard&&keyList.indexOf(ev.keyCode)>-1){isMouse=false;isKeyboard=true;updateClasses()}};var setup=exports.setup=function setup(){var target=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document.documentElement;domMain=target;if(!isSetup){handleMouse();document.addEventListener("mousedown",handleMouse);document.addEventListener("keyup",handleKey);isSetup=true}};var stop=exports.stop=function stop(){document.removeEventListener("mousedown",handleMouse);document.removeEventListener("keyup",handleKey);isSetup=false};var isKeyboardType=exports.isKeyboardType=function isKeyboardType(){var el=domMain||document.documentElement;return el.classList.contains(classIsKeyboard)}},{"../event/event.js":7}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.vars=exports.varOverheadLength=exports.uidPropName=exports.maxPropLength=exports.maxEventsLength=exports.maxEvarLength=exports.dataLayerPath=exports.cookieOpts=exports.cookieName=exports.beaconMaxLength=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _analyticsDataLayer=require("@apple/analytics-data-layer");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _index=require("./sanitizers/index.js");var beaconMaxLength=exports.beaconMaxLength=500;var varOverheadLength=exports.varOverheadLength=6;var maxEvarLength=exports.maxEvarLength=250;var maxPropLength=exports.maxPropLength=100;var maxEventsLength=exports.maxEventsLength=150;var cookieName=exports.cookieName="mk_epub";var cookieOpts=exports.cookieOpts={path:"/",secure:true};var dataLayerPath=exports.dataLayerPath=[_analyticsDataLayer.KEYS.PERSISTED,_analyticsDataLayer.KEYS.DEFERRED_BEACON];var uidPropName=exports.uidPropName="btuid";var uidMaxLength=7;var purchaseJourneyPropName="pj";var purchaseJourneyPropMaxLength=100;var vars=exports.vars=[{name:uidPropName,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(uidMaxLength)]},{name:_analyticsOmnitureConstants.VARS.EVENTS,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxEventsLength)]},{name:_analyticsOmnitureConstants.VARS.EVAR_1,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxEvarLength)]},{name:_analyticsOmnitureConstants.VARS.PROP_14,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxPropLength)]},{name:_analyticsOmnitureConstants.VARS.PROP_57,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxPropLength)]},{name:_analyticsOmnitureConstants.VARS.PROP_7,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxPropLength)]},{name:_analyticsOmnitureConstants.VARS.EVAR_15,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxEvarLength)]},{name:_analyticsOmnitureConstants.VARS.EVAR_23,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxEvarLength)]},{name:_analyticsOmnitureConstants.VARS.PROP_25,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxPropLength)]},{name:_analyticsOmnitureConstants.VARS.EVAR_2,sanitizers:[_analyticsUtils.beaconHelpers.toBeaconSafeVal,(0,_index.lengthLimitFactory)(maxEvarLength)]},{name:purchaseJourneyPropName,sanitizers:[(0,_index.lengthLimitFactory)(purchaseJourneyPropMaxLength)]}]},{"./sanitizers/index.js":32,"@apple/analytics-data-layer":46,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.get=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _getCookieDomain=_interopRequireDefault(require("./getCookieDomain.js"));var _config=require("./config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var get=exports.get=function get(){var deferredBeacon=_analyticsUtils.cookieJson.get(_config.cookieName);_analyticsUtils.cookieJson.set(_config.cookieName,null,_objectSpread(_objectSpread({},_config.cookieOpts),{},{domain:(0,_getCookieDomain["default"])()}));return deferredBeacon};var set=exports.set=function set(deferredBeacon){if(_analyticsUtils.beaconHelpers.isNotEmpty(deferredBeacon)){_analyticsUtils.cookieJson.set(_config.cookieName,deferredBeacon,_objectSpread(_objectSpread({},_config.cookieOpts),{},{domain:(0,_getCookieDomain["default"])()}))}}},{"./config.js":20,"./getCookieDomain.js":26,"@apple/analytics-utils":190}],22:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.get=void 0;var _analyticsUtils=require("@apple/analytics-utils");var dataLayer=_interopRequireWildcard(require("@apple/analytics-data-layer"));var _config=require("../config.js");var _getUid=require("./getUid.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}var get=exports.get=function get(){var deferredBeacon=dataLayer.get(_config.dataLayerPath);if(_analyticsUtils.beaconHelpers.isNotEmpty(deferredBeacon)){deferredBeacon[_config.uidPropName]=(0,_getUid.getUid)();dataLayer.set(_config.dataLayerPath,deferredBeacon)}return deferredBeacon}},{"../config.js":20,"./getUid.js":23,"@apple/analytics-data-layer":46,"@apple/analytics-utils":190}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getUid=void 0;var RADIX=36;var getUid=exports.getUid=function getUid(){return window.crypto.getRandomValues(new Uint32Array(1))[0].toString(RADIX)}},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get.get}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set.set}});var _get=require("./get.js");var _set=require("./set.js")},{"./get.js":22,"./set.js":25}],25:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.set=void 0;var _analyticsUtils=require("@apple/analytics-utils");var dataLayer=_interopRequireWildcard(require("@apple/analytics-data-layer"));var _config=require("../config.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var set=exports.set=function set(newDeferredBeacon){var currentDeferredBeacon=dataLayer.get(_config.dataLayerPath);if(_analyticsUtils.beaconHelpers.isNotEmpty(newDeferredBeacon)&&(!_analyticsUtils.beaconHelpers.isNotEmpty(currentDeferredBeacon)||newDeferredBeacon[_config.uidPropName]!==currentDeferredBeacon[_config.uidPropName])){dataLayer.set(_config.dataLayerPath,newDeferredBeacon)}dataLayer.remove([].concat(_toConsumableArray(_config.dataLayerPath),[_config.uidPropName]))}},{"../config.js":20,"@apple/analytics-data-layer":46,"@apple/analytics-utils":190}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsDataLayer=require("@apple/analytics-data-layer");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var cookieDomainKey=[].concat(_toConsumableArray(_analyticsDataLayer.KEYS.PATHS.CONFIG),["global","cookieDomain"]);var getCookieDomain=function getCookieDomain(){return(0,_analyticsDataLayer.get)(cookieDomainKey)};var _default=exports["default"]=getCookieDomain},{"@apple/analytics-data-layer":46}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"retrieve",{enumerable:true,get:function get(){return _retrieve["default"]}});Object.defineProperty(exports,"store",{enumerable:true,get:function get(){return _store["default"]}});var _retrieve=_interopRequireDefault(require("./retrieve.js"));var _store=_interopRequireDefault(require("./store.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./retrieve.js":28,"./store.js":34}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=require("./dataLayer/index.js");var _cookie=require("./cookie.js");var retrieve=(0,_analyticsUtils.pipe)(_cookie.get,_index.set);var _default=exports["default"]=retrieve},{"./cookie.js":21,"./dataLayer/index.js":24,"@apple/analytics-utils":190}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _sanitizeBeaconVars=_interopRequireDefault(require("./sanitizeBeaconVars.js"));var _sanitizeBeaconLength=_interopRequireDefault(require("./sanitizeBeaconLength.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var sanitizeBeacon=(0,_analyticsUtils.pipe)(_sanitizeBeaconVars["default"],_sanitizeBeaconLength["default"]);var _default=exports["default"]=sanitizeBeacon},{"./sanitizeBeaconLength.js":30,"./sanitizeBeaconVars.js":31,"@apple/analytics-utils":190}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var sanitizeBeaconLength=function sanitizeBeaconLength(originalBeacon){return _analyticsUtils.beaconHelpers.isNotEmpty(originalBeacon)?_config.vars.reduce(function(_ref,variable){var beacon=_ref.beacon,beaconLength=_ref.beaconLength;var varName=variable.name;var varValue=(0,_analyticsUtils.toStr)(originalBeacon[varName]);var varLength=varName.length+varValue.length+_config.varOverheadLength;if(varValue&&beaconLength+varLength<=_config.beaconMaxLength){beacon[varName]=varValue;return{beacon:beacon,beaconLength:beaconLength+varLength}}return{beacon:beacon,beaconLength:beaconLength}},{beacon:{},beaconLength:0}).beacon:null};var _default=exports["default"]=sanitizeBeaconLength},{"./config.js":20,"@apple/analytics-utils":190}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var sanitizeBeaconVars=function sanitizeBeaconVars(beacon){return _analyticsUtils.beaconHelpers.isNotEmpty(beacon)?_config.vars.reduce(function(sanitizedBeacon,variable){var sanitizers=variable.sanitizers||[];var sanitizedValue=_analyticsUtils.pipe.apply(void 0,_toConsumableArray(sanitizers))(beacon[variable.name]);if(sanitizedValue){sanitizedBeacon[variable.name]=sanitizedValue}return sanitizedBeacon},{}):null};var _default=exports["default"]=sanitizeBeaconVars},{"./config.js":20,"@apple/analytics-utils":190}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"lengthLimitFactory",{enumerable:true,get:function get(){return _lengthLimitFactory["default"]}});var _lengthLimitFactory=_interopRequireDefault(require("./lengthLimitFactory.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./lengthLimitFactory.js":33}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var lengthLimitFactory=function lengthLimitFactory(maxLength){return function(str){return typeof str==="string"?str.slice(0,maxLength):null}};var _default=exports["default"]=lengthLimitFactory},{}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=require("./dataLayer/index.js");var _sanitizeBeacon=_interopRequireDefault(require("./sanitizeBeacon.js"));var _cookie=require("./cookie.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var store=(0,_analyticsUtils.pipe)(_index.get,_sanitizeBeacon["default"],_cookie.set);var _default=exports["default"]=store},{"./cookie.js":21,"./dataLayer/index.js":24,"./sanitizeBeacon.js":29,"@apple/analytics-utils":190}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"passiveTrackerLoader",{enumerable:true,get:function get(){return _passiveTrackerLoader.passiveTrackerLoader}});var _passiveTrackerLoader=require("./passiveTrackerLoader.js")},{"./passiveTrackerLoader.js":36}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.passiveTrackerLoader=void 0;var _analyticsMergeBeacons=require("@apple/analytics-merge-beacons");var _analyticsPassiveTrackerLoaders=require("@apple/analytics-passive-tracker-loaders");var types={pageLoad:"page",userInteraction:"next"};var isModalOrJavaScriptLink=function isModalOrJavaScriptLink(element){if(!element){return false}var linkEl=element.closest("a");if(linkEl===null){return false}if(linkEl.dataset.aseLoader||linkEl.dataset.aseTabsLoader||linkEl.getAttribute("href")==="#"){return true}return false};var passiveTrackerLoader=exports.passiveTrackerLoader=function passiveTrackerLoader(data){var type=data.type,globalTracking=data.globalTracking,element=data.element;if(!Object.keys(types).includes(type)||globalTracking&&isModalOrJavaScriptLink(element)||data.deferred&&data.deferred===true){return data}var loadersBeacon=(0,_analyticsPassiveTrackerLoaders.loaders)(types[type]);if(loadersBeacon!==null){data.beacon=(0,_analyticsMergeBeacons.merge)({target:data.beacon,source:loadersBeacon})}return data};passiveTrackerLoader.label="analytics-bp-passive-tracker-loader"},{"@apple/analytics-merge-beacons":94,"@apple/analytics-passive-tracker-loaders":116}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SESSION_STORE=exports.RELAY=exports.REFERRER=exports.PURCHASE_JOURNEY=exports.PERSISTED=exports.PATHS=exports.PAGE_LOAD=exports.PAGE_DATA_MODEL_LEGACY=exports.PAGE_DATA_MODEL=exports.METADATA=exports.DEFERRED_BEACON=exports.CLICK_TIMER=void 0;var METADATA=exports.METADATA="metaData";var PAGE_DATA_MODEL=exports.PAGE_DATA_MODEL="pageDataModel";var PAGE_DATA_MODEL_LEGACY=exports.PAGE_DATA_MODEL_LEGACY="pageDataModel.data.properties";var PERSISTED=exports.PERSISTED="persisted";var SESSION_STORE=exports.SESSION_STORE="sessionStore";var DEFERRED_BEACON=exports.DEFERRED_BEACON="deferredBeacon";var PAGE_LOAD=exports.PAGE_LOAD="pageLoad";var PURCHASE_JOURNEY=exports.PURCHASE_JOURNEY="purchaseJourney";var CLICK_TIMER=exports.CLICK_TIMER="clickTimer";var RELAY=exports.RELAY="relay";var REFERRER=exports.REFERRER="referrer";var PATHS=exports.PATHS={CONFIG:[PAGE_DATA_MODEL,"config"],PAGE_DATA:[PAGE_DATA_MODEL,"data"],DEFERRED_BEACON:[PERSISTED,DEFERRED_BEACON]}},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var config={};var _default=exports["default"]=config},{}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"config",{enumerable:true,get:function get(){return _config["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _config=_interopRequireDefault(require("./config.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./config.js":38,"./set.js":41}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var mandatoryProps={pageDataModel:["key","selector"],meta:["key","selector","keyAttribute","valueAttribute"],state:["defaultState"],persisted:["key"],sessionStore:["key"]};var _default=exports["default"]=mandatoryProps},{}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../utils/index.js");var _mandatoryProps=_interopRequireDefault(require("./mandatoryProps.js"));var _config2=_interopRequireDefault(require("./config.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var set=function set(_config){if(!(0,_index.isObject)(_config)){return}Object.keys(_mandatoryProps["default"]).forEach(function(propName){if((0,_index.isValidObject)(_config[propName],_mandatoryProps["default"][propName])){_config2["default"][propName]=_objectSpread({},_config[propName])}})};var _default=exports["default"]=set},{"../utils/index.js":70,"./config.js":38,"./mandatoryProps.js":40}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _state=require("./state.js");var get=function get(path){return path?(0,_state.get)(_analyticsUtils.objectPath.formatPath(path)):(0,_state.get)()};var _default=exports["default"]=get},{"./state.js":69,"@apple/analytics-utils":190}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../localStoreSync/index.js");var _index2=require("../sessionStoreSync/index.js");var _state=require("../state.js");var _index3=require("../config/index.js");var _readMeta=_interopRequireDefault(require("./readMeta.js"));var _readPageDataModel=_interopRequireDefault(require("./readPageDataModel.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var hydrate=function hydrate(){(0,_state.reset)(_index3.config.state&&_index3.config.state.defaultState);(0,_readMeta["default"])();(0,_readPageDataModel["default"])();(0,_index.syncLocalStoreToState)();(0,_index2.syncSessionStoreToState)()};var _default=exports["default"]=hydrate},{"../config/index.js":39,"../localStoreSync/index.js":56,"../sessionStoreSync/index.js":65,"../state.js":69,"./readMeta.js":44,"./readPageDataModel.js":45}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../config/index.js");var _set=_interopRequireDefault(require("../set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var readMeta=function readMeta(){if(!_index.config.meta){return}var _config$meta=_index.config.meta,key=_config$meta.key,selector=_config$meta.selector,keyAttribute=_config$meta.keyAttribute,keyPrefix=_config$meta.keyPrefix,valueAttribute=_config$meta.valueAttribute;var result={};var metas=document.querySelectorAll(selector);for(var i=0;i<metas.length;i++){var metaKey=metas[i].getAttribute(keyAttribute).replace(keyPrefix,"");result[metaKey]=metas[i].getAttribute(valueAttribute)}(0,_set["default"])(key,result)};var _default=exports["default"]=readMeta},{"../config/index.js":39,"../set.js":68}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../config/index.js");var _set=_interopRequireDefault(require("../set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var readPageDataModel=function readPageDataModel(){if(!_index.config.pageDataModel){return}var result={};var element=window.document.querySelector(_index.config.pageDataModel.selector);try{result=JSON.parse(element.textContent)}catch(e){}(0,_set["default"])(_index.config.pageDataModel.key,result)};var _default=exports["default"]=readPageDataModel},{"../config/index.js":39,"../set.js":68}],46:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.KEYS=void 0;Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"init",{enumerable:true,get:function get(){return _init["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var KEYS=_interopRequireWildcard(require("@apple/analytics-data-layer-keys"));exports.KEYS=KEYS;var _init=_interopRequireDefault(require("./init.js"));var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}},{"./get.js":42,"./init.js":47,"./remove.js":59,"./set.js":68,"@apple/analytics-data-layer-keys":37}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("./localStore/index.js");var _index2=_interopRequireDefault(require("./hydrate/index.js"));var _index3=require("./localStoreSync/index.js");var _index4=require("./config/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var initDone=false;var init=function init(config){if(initDone){return}initDone=true;(0,_index4.set)(config);(0,_index2["default"])();_index4.config.persisted&&(0,_index.registerStoreEventCallback)(_index3.syncLocalStoreToState)};var _default=exports["default"]=init},{"./config/index.js":39,"./hydrate/index.js":43,"./localStore/index.js":51,"./localStoreSync/index.js":56}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.expiryKey=exports.expiryExtendTimeout=exports.expiryDuration=exports.dataKey=void 0;var dataKey=exports.dataKey="mk_epub";var expiryKey=exports.expiryKey="mk_epub_expiry";var expiryDuration=exports.expiryDuration=2*60*60*1e3;var expiryExtendTimeout=exports.expiryExtendTimeout=5*60*1e3},{}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var _isExpired=_interopRequireDefault(require("./isExpired.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var extendExpiryTimer;var extend=function extend(force){if(!force&&(0,_isExpired["default"])()){return}_analyticsUtils.localStorage.set(_config.expiryKey,Date.now()+_config.expiryDuration);extendExpiryTimer=setTimeout(extend,_config.expiryExtendTimeout)};var expiryExtender=function expiryExtender(){clearTimeout(extendExpiryTimer);extend(true)};var _default=exports["default"]=expiryExtender},{"./config.js":48,"./isExpired.js":52,"@apple/analytics-utils":190}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var _remove=_interopRequireDefault(require("./remove.js"));var _isExpired=_interopRequireDefault(require("./isExpired.js"));var _expiryExtender=_interopRequireDefault(require("./expiryExtender.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=function get(){if((0,_isExpired["default"])()){(0,_remove["default"])();return{}}var data=_analyticsUtils.localStorageJson.get(_config.dataKey);if(!data){(0,_remove["default"])();return{}}(0,_expiryExtender["default"])();return data};var _default=exports["default"]=get},{"./config.js":48,"./expiryExtender.js":49,"./isExpired.js":52,"./remove.js":54,"@apple/analytics-utils":190}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"registerStoreEventCallback",{enumerable:true,get:function get(){return _registerStoreEventCallback["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));var _remove=_interopRequireDefault(require("./remove.js"));var _registerStoreEventCallback=_interopRequireDefault(require("./registerStoreEventCallback.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":50,"./registerStoreEventCallback.js":53,"./remove.js":54,"./set.js":55}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var isExpired=function isExpired(){return(Number(_analyticsUtils.localStorage.get(_config.expiryKey))||0)<Date.now()};var _default=exports["default"]=isExpired},{"./config.js":48,"@apple/analytics-utils":190}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _config=require("./config.js");var storeEventListener=function storeEventListener(callback){return function(event){if(event.key!==_config.dataKey){return}callback()}};var registerStoreEventCallback=function registerStoreEventCallback(callback){if(typeof callback!=="function"){return}window.addEventListener("storage",storeEventListener(callback))};var _default=exports["default"]=registerStoreEventCallback},{"./config.js":48}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var remove=function remove(){_analyticsUtils.localStorage.remove(_config.expiryKey);_analyticsUtils.localStorage.remove(_config.dataKey)};var _default=exports["default"]=remove},{"./config.js":48,"@apple/analytics-utils":190}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var _expiryExtender=_interopRequireDefault(require("./expiryExtender.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var set=function set(data){if(data&&_typeof(data)==="object"&&Object.keys(data).length){(0,_expiryExtender["default"])();_analyticsUtils.localStorageJson.set(_config.dataKey,data)}else{(0,_remove["default"])()}};var _default=exports["default"]=set},{"./config.js":48,"./expiryExtender.js":49,"./remove.js":54,"@apple/analytics-utils":190}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"syncLocalStoreToState",{enumerable:true,get:function get(){return _syncLocalStoreToState["default"]}});Object.defineProperty(exports,"syncStateToLocalStore",{enumerable:true,get:function get(){return _syncStateToLocalStore["default"]}});var _syncLocalStoreToState=_interopRequireDefault(require("./syncLocalStoreToState.js"));var _syncStateToLocalStore=_interopRequireDefault(require("./syncStateToLocalStore.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./syncLocalStoreToState.js":57,"./syncStateToLocalStore.js":58}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../localStore/index.js");var _state=require("../state.js");var _index2=require("../config/index.js");var syncLocalStoreToState=function syncLocalStoreToState(){_index2.config.persisted&&(0,_state.set)([_index2.config.persisted.key],(0,_index.get)())};var _default=exports["default"]=syncLocalStoreToState},{"../config/index.js":39,"../localStore/index.js":51,"../state.js":69}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../localStore/index.js");var _state=require("../state.js");var _index2=require("../config/index.js");var syncStateToLocalStore=function syncStateToLocalStore(){_index2.config.persisted&&(0,_index.set)((0,_state.get)([_index2.config.persisted.key]))};var _default=exports["default"]=syncStateToLocalStore},{"../config/index.js":39,"../localStore/index.js":51,"../state.js":69}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _state=require("./state.js");var _index=require("./localStoreSync/index.js");var _index2=require("./sessionStoreSync/index.js");var _index3=require("./config/index.js");var remove=function remove(path){var formattedPath=_analyticsUtils.objectPath.formatPath(path);(0,_state.remove)(formattedPath);_index3.config.persisted&&formattedPath[0]===_index3.config.persisted.key&&(0,_index.syncStateToLocalStore)();_index3.config.sessionStore&&formattedPath[0]===_index3.config.sessionStore.key&&(0,_index2.syncStateToSessionStore)()};var _default=exports["default"]=remove},{"./config/index.js":39,"./localStoreSync/index.js":56,"./sessionStoreSync/index.js":65,"./state.js":69,"@apple/analytics-utils":190}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.dataKey=void 0;var dataKey=exports.dataKey="mk_epub"},{}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=function get(){var data=_analyticsUtils.sessionStorageJson.get(_config.dataKey);if(!data){(0,_remove["default"])();return{}}return data};var _default=exports["default"]=get},{"./config.js":60,"./remove.js":63,"@apple/analytics-utils":190}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":61,"./remove.js":63,"./set.js":64}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var remove=function remove(){_analyticsUtils.sessionStorage.remove(_config.dataKey)};var _default=exports["default"]=remove},{"./config.js":60,"@apple/analytics-utils":190}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _config=require("./config.js");var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var set=function set(data){if(data&&_typeof(data)==="object"&&Object.keys(data).length){_analyticsUtils.sessionStorageJson.set(_config.dataKey,data)}else{(0,_remove["default"])()}};var _default=exports["default"]=set},{"./config.js":60,"./remove.js":63,"@apple/analytics-utils":190}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"syncSessionStoreToState",{enumerable:true,get:function get(){return _syncSessionStoreToState["default"]}});Object.defineProperty(exports,"syncStateToSessionStore",{enumerable:true,get:function get(){return _syncStateToSessionStore["default"]}});var _syncSessionStoreToState=_interopRequireDefault(require("./syncSessionStoreToState.js"));var _syncStateToSessionStore=_interopRequireDefault(require("./syncStateToSessionStore.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./syncSessionStoreToState.js":66,"./syncStateToSessionStore.js":67}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../sessionStore/index.js");var _state=require("../state.js");var _index2=require("../config/index.js");var syncSessionStoreToState=function syncSessionStoreToState(){_index2.config.sessionStore&&(0,_state.set)([_index2.config.sessionStore.key],(0,_index.get)())};var _default=exports["default"]=syncSessionStoreToState},{"../config/index.js":39,"../sessionStore/index.js":62,"../state.js":69}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../sessionStore/index.js");var _state=require("../state.js");var _index2=require("../config/index.js");var syncStateToSessionStore=function syncStateToSessionStore(){_index2.config.sessionStore&&(0,_index.set)((0,_state.get)([_index2.config.sessionStore.key]))};var _default=exports["default"]=syncStateToSessionStore},{"../config/index.js":39,"../sessionStore/index.js":62,"../state.js":69}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _state=require("./state.js");var _index=require("./localStoreSync/index.js");var _index2=require("./sessionStoreSync/index.js");var _index3=require("./config/index.js");var set=function set(path,value){var formattedPath=_analyticsUtils.objectPath.formatPath(path);(0,_state.set)(formattedPath,value);_index3.config.persisted&&formattedPath[0]===_index3.config.persisted.key&&(0,_index.syncStateToLocalStore)();_index3.config.sessionStore&&formattedPath[0]===_index3.config.sessionStore.key&&(0,_index2.syncStateToSessionStore)()};var _default=exports["default"]=set},{"./config/index.js":39,"./localStoreSync/index.js":56,"./sessionStoreSync/index.js":65,"./state.js":69,"@apple/analytics-utils":190}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.reset=exports.remove=exports.get=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=require("./utils/index.js");var state={};var get=exports.get=function get(path){return _analyticsUtils.objectPath.get(state,path)};var set=exports.set=function set(path,value){state=_analyticsUtils.objectPath.set(state,path,value)};var remove=exports.remove=function remove(path){state=_analyticsUtils.objectPath.remove(state,path)};var reset=exports.reset=function reset(newState){if((0,_index.isObject)(newState)){state=newState}else{state={}}}},{"./utils/index.js":70,"@apple/analytics-utils":190}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"isObject",{enumerable:true,get:function get(){return _isObject["default"]}});Object.defineProperty(exports,"isValidObject",{enumerable:true,get:function get(){return _isValidObject["default"]}});var _isObject=_interopRequireDefault(require("./isObject.js"));var _isValidObject=_interopRequireDefault(require("./isValidObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./isObject.js":71,"./isValidObject.js":72}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var isObject=function isObject(obj){return obj&&_typeof(obj)==="object"&&!Array.isArray(obj)?true:false};var _default=exports["default"]=isObject},{}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isObject=_interopRequireDefault(require("./isObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isValidObject=function isValidObject(obj,mandatoryProps){return(0,_isObject["default"])(obj)&&Array.isArray(mandatoryProps)&&mandatoryProps.every(function(prop){return obj[prop]})};var _default=exports["default"]=isValidObject},{"./isObject.js":71}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setup=exports.save=exports.load=exports.clearAll=void 0;var _utils=require("./utils.js");var _index=require("./schema/index.js");var _index2=require("./transformers/index.js");var _index3=require("./storage/index.js");var _syncTabs=require("./storage/syncTabs.js");var _setDefaults=require("./setDefaults.js");var setup=exports.setup=function setup(_ref){var window=_ref.window;(0,_syncTabs.handleNewPage)({window:window});var onStorage=(0,_syncTabs.handleStorageEvent)({schema:(0,_index.loadSchema)((0,_setDefaults.setDefaults)()).schema,window:window});var handleOnStorage=function handleOnStorage(event){onStorage(event)};window.addEventListener("storage",handleOnStorage);return function(){window.removeEventListener("storage",handleOnStorage)}};var save=exports.save=(0,_utils.pipe)(_setDefaults.setDefaults,_index.loadSchema,_index2.pack,_index3.store);var load=exports.load=_index3.retrieve;var clearAll=exports.clearAll=_index3.clear},{"./schema/index.js":75,"./setDefaults.js":77,"./storage/index.js":79,"./storage/syncTabs.js":82,"./transformers/index.js":84,"./utils.js":87}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setup=exports.save=exports.load=exports.clearAll=void 0;var _asUtilities=require("@aos/as-utilities");var api=_interopRequireWildcard(require("./api.js"));var _excluded=["window","cookie"];function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var setup=exports.setup=function setup(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$window=_ref.window,window=_ref$window===void 0?globalThis.window:_ref$window;return api.setup({window:window})};var save=exports.save=function save(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref2$window=_ref2.window,window=_ref2$window===void 0?globalThis.window:_ref2$window,_ref2$cookie=_ref2.cookie,cookie=_ref2$cookie===void 0?_asUtilities.cookie:_ref2$cookie,data=_ref2.data,options=_ref2.options;return api.save({window:window,cookie:cookie,data:_objectSpread({},data),options:_objectSpread({},options)})};var load=exports.load=function load(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref3$window=_ref3.window,window=_ref3$window===void 0?globalThis.window:_ref3$window,_ref3$cookie=_ref3.cookie,cookie=_ref3$cookie===void 0?_asUtilities.cookie:_ref3$cookie;return api.load({window:window,cookie:cookie})};var clearAll=exports.clearAll=function clearAll(){var _ref4=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref4$window=_ref4.window,window=_ref4$window===void 0?globalThis.window:_ref4$window,_ref4$cookie=_ref4.cookie,cookie=_ref4$cookie===void 0?_asUtilities.cookie:_ref4$cookie,options=_objectWithoutProperties(_ref4,_excluded);return api.clearAll({window:window,cookie:cookie,options:options})}},{"./api.js":73,"@aos/as-utilities":1}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadSchema=void 0;var _v=require("./v1.js");var versions={v1:_v.v1};var schema=function schema(version){if(!version){return versions}return versions.hasOwnProperty(version)?versions[version]:null};var loadSchema=exports.loadSchema=function loadSchema(state){if(state.options&&state.options.version){state.schema=schema(state.options.version)}else{state.allSchemas=schema()}return state}},{"./v1.js":76}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.v1=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MAX_PAGENAME_LENGTH=120;var MAX_LIST_LENGTH=600;var maxLength=function maxLength(max){return function(str){return str.slice(0,max)}};var id=function id(x){return x};var separators={primary:"~",secondary:"^",tertiary:"::"};var v1=exports.v1={prefix:"v1",data:[{key:"uuid",map:"x",mergeDefault:"override",validStorage:["session","cookie"],syncTabs:false,clean:function clean(x){return x}},{key:"minor",map:"m",mergeDefault:"override",validStorage:["session","cookie"],syncTabs:true,clean:id},{key:"pageName",map:"n",mergeDefault:"override",validStorage:["session","cookie"],syncTabs:false,clean:maxLength(MAX_PAGENAME_LENGTH)},{key:"area",map:"r",mergeDefault:"override",validStorage:["session","cookie"],syncTabs:false,clean:id},{key:"api",map:"a",mergeDefault:"append",validStorage:["session"],syncTabs:true,prePack:function prePack(arr){return arr.map(function(_ref){var type=_ref.type,value=_ref.value;return type+separators.tertiary+value}).join(separators.secondary)},clean:maxLength(MAX_LIST_LENGTH),postPack:function postPack(data){return data.split(separators.secondary).map(function(item){var _item$split=item.split(separators.tertiary),_item$split2=_slicedToArray(_item$split,2),type=_item$split2[0],value=_item$split2[1];return{type:type,value:value}})}},{key:"beacon",map:"b",mergeDefault:"merge",validStorage:["session"],syncTabs:true,prePack:function prePack(obj){return Object.entries(obj).filter(function(_ref2){var _ref3=_slicedToArray(_ref2,1),key=_ref3[0];return/^[eVar|prop|events|products]/.test(key)}).map(function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],value=_ref5[1];return key+separators.tertiary+value}).join(separators.secondary)},clean:id,postPack:function postPack(str){return str.split(separators.secondary).reduce(function(beacon,current){var _current$split=current.split(separators.tertiary),_current$split2=_slicedToArray(_current$split,2),key=_current$split2[0],value=_current$split2[1];beacon[key]=value;return beacon},{})}}],settings:{sessionName:"pt-dm",cookieName:"pt-dm",separator:separators.primary,transformers:["mergeExisting","mapToSchema","compress"]}}},{}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setDefaults=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var setDefaults=exports.setDefaults=function setDefaults(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var defaults={origin:"same",version:"v1",minor:"2"};state.options=_objectSpread(_objectSpread({},defaults),state.options);return state}},{}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.clearSession=exports.clearLocal=exports.clearCookie=void 0;var clearCookie=exports.clearCookie=function clearCookie(_ref){var key=_ref.key,cookieDomain=_ref.cookieDomain,cookie=_ref.cookie;var options={secure:true,sameSite:"strict",path:"/",expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT")};if(cookieDomain){options.domain=cookieDomain}cookie.set(key,"",options)};var clearSession=exports.clearSession=function clearSession(_ref2){var key=_ref2.key,window=_ref2.window;window.sessionStorage.removeItem(key)};var clearLocal=exports.clearLocal=function clearLocal(_ref3){var key=_ref3.key,window=_ref3.window;window.localStorage.removeItem(key)}},{}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.store=exports.storage=exports.retrieve=exports.clear=void 0;var _index=require("../schema/index.js");var _index2=require("../transformers/index.js");var _utils=require("../utils.js");var _setDefaults=require("../setDefaults.js");var _save=require("./save.js");var _load=require("./load.js");var _clear=require("./clear.js");var _syncTabs=require("./syncTabs.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var store=exports.store=function store(state){if(!state||!state.transformed||state.transformed===""){return false}switch(state.destination){case"cookie":{var args={cookie:state.cookie,key:state.schema.settings.cookieName,value:state.transformed};if(state.options&&state.options.cookieDomain){args.cookieDomain=state.options.cookieDomain}(0,_save.saveCookie)(args);break}case"session":default:(0,_save.saveSession)({window:state.window,key:state.schema.settings.sessionName,value:state.transformed});if(state.transformedSync&&state.transformedSync!==""){(0,_syncTabs.syncSave)({window:state.window,value:state.transformedSync})}break}return true};var mergeData=function mergeData(_ref){var schema=_ref.schema,sessionData=_ref.sessionData,cookieData=_ref.cookieData;var result=null;var has=function has(data){return data!==null};var sessionDataUnpacked=has(sessionData)?(0,_index2.unpack)({schema:schema,data:sessionData}):null;var cookieDataUnpacked=has(cookieData)?(0,_index2.unpack)({schema:schema,data:cookieData}):null;var sessionId=has(sessionDataUnpacked)?(0,_utils.readUuid)(sessionDataUnpacked.uuid):null;var cookieId=has(cookieDataUnpacked)?(0,_utils.readUuid)(cookieDataUnpacked.uuid):null;var bothHaveData=has(sessionData)&&has(cookieData);var bothHaveIds=has(sessionId)&&has(cookieId);var globalsMatch=bothHaveIds&&sessionId.global===cookieId.global;var idsMatch=globalsMatch&&sessionId.session===cookieId.session;switch(true){case!has(sessionData)&&has(cookieData):result=cookieDataUnpacked;break;case has(sessionData)&&!has(cookieData):result=sessionDataUnpacked;break;case bothHaveData&&idsMatch:result=_objectSpread(_objectSpread({},sessionDataUnpacked),cookieDataUnpacked);break;case bothHaveData&&!idsMatch&&globalsMatch:{var syncableCookieData=_objectSpread({},cookieDataUnpacked);schema.data.filter(function(_ref2){var syncTabs=_ref2.syncTabs;return!syncTabs}).forEach(function(_ref3){var key=_ref3.key;delete syncableCookieData[key]});result=_objectSpread(_objectSpread({},sessionDataUnpacked),syncableCookieData)}break;case bothHaveData&&!globalsMatch:result=sessionDataUnpacked;break;case!has(sessionData)&&!has(cookieData):default:break}return result};var retrieve=exports.retrieve=function retrieve(_ref4){var window=_ref4.window,cookie=_ref4.cookie;var state=(0,_index.loadSchema)({options:{}});if(!state.allSchemas){return}var keys=Object.keys(state.allSchemas).sort(function(a,b){return a<b?1:-1});var data={};for(var s=0;s<keys.length;s++){var currentSchemaKey=keys[s];var schema=state.allSchemas[currentSchemaKey];var _schema$settings=schema.settings,cookieName=_schema$settings.cookieName,sessionName=_schema$settings.sessionName;var cookieData=(0,_load.loadCookie)({cookie:cookie,key:cookieName});var sessionData=(0,_load.loadSession)({window:window,key:sessionName});var merged=mergeData({schema:schema,cookieData:cookieData,sessionData:sessionData});if(merged!==null){data=merged}if(Object.keys(data).length!==0){break}}return Object.keys(data).length===0?null:data};var clear=exports.clear=function clear(){var _ref5=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},window=_ref5.window,cookie=_ref5.cookie,_ref5$options=_ref5.options,options=_ref5$options===void 0?{}:_ref5$options;var state={window:window,cookie:cookie,options:options};state=(0,_index.loadSchema)(state);if(!state.allSchemas){return null}var previous=retrieve({window:window,cookie:cookie});Object.values(state.allSchemas).forEach(function(_ref6){var settings=_ref6.settings;var cookieName=settings.cookieName,sessionName=settings.sessionName;var cookieArgs={cookie:cookie,key:cookieName};if(state.options&&state.options.cookieDomain){cookieArgs.cookieDomain=state.options.cookieDomain}(0,_clear.clearCookie)(cookieArgs);(0,_clear.clearSession)({window:window,key:sessionName});(0,_syncTabs.syncClearAll)({window:window})});if(previous&&previous.uuid){(0,_utils.pipe)(_setDefaults.setDefaults,_index.loadSchema,_index2.pack,store)({window:window,cookie:cookie,data:{uuid:previous.uuid},options:options})}};var storage=exports.storage={store:store,retrieve:retrieve,clear:clear}},{"../schema/index.js":75,"../setDefaults.js":77,"../transformers/index.js":84,"../utils.js":87,"./clear.js":78,"./load.js":80,"./save.js":81,"./syncTabs.js":82}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadSession=exports.loadCookie=void 0;var loadCookie=exports.loadCookie=function loadCookie(_ref){var key=_ref.key,cookie=_ref.cookie;if(!cookie){return null}return cookie.get(key)};var loadSession=exports.loadSession=function loadSession(_ref2){var key=_ref2.key,window=_ref2.window;if(!window||!window.sessionStorage){return null}return window.sessionStorage.getItem(key)}},{}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.saveSession=exports.saveLocal=exports.saveCookie=void 0;var saveCookie=exports.saveCookie=function saveCookie(_ref){var key=_ref.key,value=_ref.value,cookieDomain=_ref.cookieDomain,cookie=_ref.cookie;var options={secure:true,sameSite:"strict",path:"/"};if(cookieDomain){options.domain=cookieDomain}cookie.set(key,value,options)};var saveSession=exports.saveSession=function saveSession(_ref2){var key=_ref2.key,value=_ref2.value,window=_ref2.window;window.sessionStorage.setItem(key,value)};var saveLocal=exports.saveLocal=function saveLocal(_ref3){var key=_ref3.key,value=_ref3.value,window=_ref3.window;window.localStorage.setItem(key,value)}},{}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncSave=exports.syncClearAll=exports.handleStorageEvent=exports.handleNewPage=exports.SYNC=exports.NEW_PAGE=exports.CLEAR_ALL=void 0;var _index=require("../transformers/index.js");var _utils=require("../utils.js");var _load=require("./load.js");var _save=require("./save.js");var _clear=require("./clear.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var SYNC=exports.SYNC="sync";var NEW_PAGE=exports.NEW_PAGE="onNewPage";var CLEAR_ALL=exports.CLEAR_ALL="clearAll";var handleStorageEvent=exports.handleStorageEvent=function handleStorageEvent(_ref){var schema=_ref.schema,window=_ref.window;return function(event){var key=schema.settings.sessionName;switch(event.key){case NEW_PAGE:{var localSessionValue=(0,_load.loadSession)({window:window,key:key});var unpacked=(0,_index.unpack)({schema:schema,data:localSessionValue});var repacked=(0,_index.pack)({schema:schema,data:unpacked,isSync:true});var value=repacked.transformedSync;if(value){(0,_save.saveLocal)({window:window,key:SYNC,value:value});(0,_clear.clearLocal)({window:window,key:SYNC})}break}case SYNC:if(event.newValue){var _localSessionValue=(0,_load.loadSession)({window:window,key:key});var _value=event.newValue;if(_localSessionValue){var unpackedLocal=(0,_index.unpack)({schema:schema,data:_localSessionValue});var unpackedOther=(0,_index.unpack)({schema:schema,data:event.newValue});var localUUID=(0,_utils.readUuid)(unpackedLocal.uuid);var otherUUID=(0,_utils.readUuid)(unpackedOther.uuid);var uuid=localUUID.global===otherUUID.global?unpackedLocal.uuid:unpackedOther.uuid;schema.data.forEach(function(item){if(item.syncTabs){delete unpackedLocal[item.key]}});var mixedData=_objectSpread(_objectSpread(_objectSpread({},unpackedLocal),unpackedOther),{},{uuid:uuid});var _repacked=(0,_index.pack)({schema:schema,data:mixedData,isSync:true});_value=_repacked.transformed}(0,_save.saveSession)({window:window,key:key,value:_value})}break;case CLEAR_ALL:(0,_clear.clearSession)({window:window,key:key});break;default:break}}};var handleNewPage=exports.handleNewPage=function handleNewPage(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},window=_ref2.window;(0,_save.saveLocal)({window:window,key:NEW_PAGE,value:"handle-new-page-save"});(0,_clear.clearLocal)({window:window,key:NEW_PAGE})};var syncSave=exports.syncSave=function syncSave(_ref3){var value=_ref3.value,window=_ref3.window;(0,_save.saveLocal)({window:window,key:SYNC,value:value});(0,_clear.clearLocal)({window:window,key:SYNC})};var syncClearAll=exports.syncClearAll=function syncClearAll(){var _ref4=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},window=_ref4.window;(0,_save.saveLocal)({window:window,key:CLEAR_ALL,value:"sync-clear-all"});(0,_clear.clearLocal)({window:window,key:CLEAR_ALL})}},{"../transformers/index.js":84,"../utils.js":87,"./clear.js":78,"./load.js":80,"./save.js":81}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.compress=void 0;var _utils=require("../utils.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var pack=function pack(state){var data=[];var dataSync=[];var separator=state.schema.settings.separator;state.transformed&&Object.entries(state.transformed).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];data.push(key+separator+value)});state.transformedSync&&Object.entries(state.transformedSync).forEach(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];dataSync.push(key+separator+value)});state.transformed=data.join(separator);state.transformedSync=dataSync.join(separator);if(state.transformed===""){return state}if(state.schema.prefix){var transformed=[state.schema.prefix,separator,state.transformed];state.transformed=transformed.join("");if(state.transformedSync!==""){var transformedSync=[state.schema.prefix,separator,state.transformedSync];state.transformedSync=transformedSync.join("")}}return state};var unpack=function unpack(state){var data=state.data,schema=state.schema;var separator=schema.settings.separator;var raw=data;if(raw===null){return state}var re=new RegExp("^".concat(schema.prefix).concat((0,_utils.reSafe)(separator)));raw=raw.replace(re,"");var parts=raw.split(schema.settings.separator);var unpackedData={};for(var i=0;i<parts.length;i+=2){var key=parts[i];var value=parts[i+1];unpackedData[key]=value}state.data=unpackedData;return state};var compress=exports.compress=function compress(isPacking){return isPacking?pack:unpack}},{"../utils.js":87}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.unpack=exports.pack=void 0;var _utils=require("../utils.js");var _mergeExisting=require("./mergeExisting.js");var _mapToSchema=require("./mapToSchema.js");var _compress=require("./compress.js");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var transformers={mergeExisting:_mergeExisting.mergeExisting,mapToSchema:_mapToSchema.mapToSchema,compress:_compress.compress};var mapTransform=function mapTransform(isPacking){return function(name){return transformers[name](isPacking)}};var transform=function transform(isPacking){return function(state){if(!state||!state.schema){return null}var transformFunctions=state.schema.settings.transformers.map(mapTransform(isPacking));var ordered=isPacking?transformFunctions:_toConsumableArray(transformFunctions).reverse();var fullTransform=_utils.pipe.apply(void 0,_toConsumableArray(ordered));return fullTransform(state)}};var pack=exports.pack=transform(true);var unpack=exports.unpack=transform(false)},{"../utils.js":87,"./compress.js":83,"./mapToSchema.js":85,"./mergeExisting.js":86}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mapToSchema=void 0;var _utils=require("../utils.js");var pack=function pack(state){var schema=state.schema;state.transformed={};state.transformedSync={};state.destination=state.options&&state.options.origin==="cross"?"cookie":"session";if(state.data===null){return state}if(!state.data.hasOwnProperty("minor")&&state.options&&state.options.hasOwnProperty("minor")){state.data.minor=state.options.minor}schema.data.forEach(function(_ref){var key=_ref.key,map=_ref.map,validStorage=_ref.validStorage,clean=_ref.clean,_ref$prePack=_ref.prePack,prePack=_ref$prePack===void 0?_utils.identity:_ref$prePack,_ref$syncTabs=_ref.syncTabs,syncTabs=_ref$syncTabs===void 0?false:_ref$syncTabs;if(!validStorage.includes(state.destination)){return}if(!state.data[key]){return}var raw=state.data[key];var process=(0,_utils.pipe)(prePack,clean);var value=process(raw);if(!value||value===""){return}state.transformed[map]=value;if(syncTabs){state.transformedSync[map]=value}else if(key==="uuid"){var _readUuid=(0,_utils.readUuid)(value),global=_readUuid.global;state.transformedSync[map]=(0,_utils.uuid)(global)}});return state};var unpack=function unpack(state){var data={};if(!state.data||state.data===null){return null}Object.keys(state.data).forEach(function(raw){var result=state.schema.data.find(function(item){return item.map===raw});if(!result){return}var key=result.key,postPack=result.postPack;var value=state.data[raw];data[key]=postPack?postPack(value):value});if(Object.keys(data).length===0){return null}return data};var mapToSchema=exports.mapToSchema=function mapToSchema(isPacking){return isPacking?pack:unpack}},{"../utils.js":87}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mergeExisting=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _utils=require("../utils.js");var _index=require("../storage/index.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var pack=function pack(state){var storedData=_index.storage.retrieve({window:state.window,cookie:state.cookie});if(storedData){mergeStateWithStoredData(state,storedData)}else if(state.data){if(!state.data.uuid){addNewUuid(state)}}return state};var mergeStateWithStoredData=function mergeStateWithStoredData(state,storedData){Object.keys(storedData).forEach(function(key){var storedValue=storedData[key];var newValue=state.data[key];var mergePolicy=getMergePolicy(state,key);state.data[key]=mergeValuesByPolicy({storedValue:storedValue,newValue:newValue,mergePolicy:mergePolicy})})};var addNewUuid=function addNewUuid(state){state.data.uuid=(0,_utils.uuid)()};var mergeValuesByPolicy=function mergeValuesByPolicy(_ref){var storedValue=_ref.storedValue,newValue=_ref.newValue,mergePolicy=_ref.mergePolicy;switch(mergePolicy){case"keep":return storedValue;case"override":return newValue?newValue:storedValue;case"append":return append(newValue,storedValue);case"merge":return merge(newValue,storedValue);default:return newValue}};var getMergePolicy=function getMergePolicy(state,key){if(state.isSync){return"override"}return getMergePolicyFromSchema(state.schema,key)};var getMergePolicyFromSchema=function getMergePolicyFromSchema(schema,key){var _schema$data$find=schema.data.find(function(item){return item.key===key}),mergeDefault=_schema$data$find.mergeDefault;return mergeDefault};var append=function append(newValue,storedValue){return newValue?storedValue.concat(newValue):storedValue};var merge=function merge(newValue,storedValue){return _objectSpread(_objectSpread(_objectSpread({},storedValue),newValue),mergedCollections(newValue,storedValue))};var mergedCollections=function mergedCollections(newValue,storedValue){var merged={};if(!newValue||!storedValue){return}var mergeCollection=function mergeCollection(key,parse){if(storedValue[key]&&newValue[key]){var parsedStored=parse(storedValue[key]);var parsedNew=parse(newValue[key]);merged[key]=parsedStored.merge(parsedNew).toString()}};mergeCollection(_analyticsOmnitureConstants.VARS.EVENTS,_analyticsOmnitureCollection.parseEventCollectionString);mergeCollection(_analyticsOmnitureConstants.VARS.PRODUCTS,_analyticsOmnitureCollection.parseProductCollectionString);return merged};var unpack=function unpack(x){return x};var mergeExisting=exports.mergeExisting=function mergeExisting(isPacking){return isPacking?pack:unpack}},{"../storage/index.js":79,"../utils.js":87,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.uuid=exports.readUuid=exports.reSafe=exports.pipe=exports.identity=void 0;var identity=exports.identity=function identity(x){return x};var pipe=exports.pipe=function pipe(){for(var _len=arguments.length,fns=new Array(_len),_key=0;_key<_len;_key++){fns[_key]=arguments[_key]}return function(value){return fns.reduce(function(result,currentFn){return currentFn(result)},value)}};var reSafe=exports.reSafe=function reSafe(str){return str.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")};var BITS=36;var UUID_LENGTH=4;var generateUUID=function generateUUID(){return Math.random().toString(BITS).slice(2,2+UUID_LENGTH)};var uuid=exports.uuid=function uuid(){var id=arguments.length>0&&arguments[0]!==undefined?arguments[0]:generateUUID();return id.slice(0,UUID_LENGTH)+generateUUID()};var readUuid=exports.readUuid=function readUuid(id){return{global:id.slice(0,UUID_LENGTH),session:id.slice(UUID_LENGTH)}}},{}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.state=void 0;var state=exports.state={engagementObserver:{},onPageEnd:function onPageEnd(){},element:null}},{}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.endOfPage=void 0;var _config=require("./config.js");var _init=require("./init.js");var initDone=false;var endOfPage=exports.endOfPage=function endOfPage(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},element=_ref.element,onPageEnd=_ref.onPageEnd;if(!(element instanceof HTMLElement))return;if(!initDone){_config.state.element=element;if(typeof onPageEnd==="function"){_config.state.onPageEnd=onPageEnd}(0,_init.init)({element:element});initDone=true}}},{"./config.js":88,"./init.js":91}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"endOfPage",{enumerable:true,get:function get(){return _endOfPage.endOfPage}});Object.defineProperty(exports,"update",{enumerable:true,get:function get(){return _update.update}});var _endOfPage=require("./endOfPage.js");var _update=require("./update.js")},{"./endOfPage.js":89,"./update.js":93}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.init=void 0;var _config=require("./config.js");var _onEngaged=require("./onEngaged.js");var init=exports.init=function init(_ref){var element=_ref.element;_config.state.engagementObserver=new IntersectionObserver(_onEngaged.onEngaged);_config.state.engagementObserver.observe(element)}},{"./config.js":88,"./onEngaged.js":92}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.onEngaged=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _config=require("./config.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var onEngaged=exports.onEngaged=function onEngaged(entries){if(entries[0].intersectionRatio<=0)return;var beacon=_defineProperty({},_analyticsOmnitureConstants.VARS.EVENTS,new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent([_analyticsOmnitureConstants.EVENTS.EVENT_406])));_config.state.onPageEnd({beacon:beacon});_config.state.engagementObserver.disconnect()}},{"./config.js":88,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.update=void 0;var _config=require("./config.js");var _init=require("./init.js");var update=exports.update=function update(){if(!(_config.state.element instanceof HTMLElement))return;_config.state.engagementObserver.disconnect();(0,_init.init)({element:_config.state.element})}},{"./config.js":88,"./init.js":91}],94:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"merge",{enumerable:true,get:function get(){return _merge.merge}});exports.mergers=void 0;var _merge=require("./merge.js");var mergers=_interopRequireWildcard(require("./mergers.js"));exports.mergers=mergers;function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}},{"./merge.js":95,"./mergers.js":96}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.merge=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var merge=exports.merge=function merge(_ref){var _ref$target=_ref.target,target=_ref$target===void 0?{}:_ref$target,_ref$source=_ref.source,source=_ref$source===void 0?{}:_ref$source,_ref$mergers=_ref.mergers,mergers=_ref$mergers===void 0?{}:_ref$mergers;Object.keys(source).forEach(function(key){if(mergers[key]){target[key]=mergers[key](target[key],source[key]);return}if(target[key]instanceof _analyticsOmnitureCollection.OmnitureCollection&&source[key]instanceof _analyticsOmnitureCollection.OmnitureCollection){target[key].merge(source[key]);return}target[key]=source[key]});return target}},{"@apple/analytics-omniture-collection":105}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.targetPlusSource=exports.targetOrSource=exports.targetMergeSource=exports.targetAndSource=exports.target=exports.sourcePlusTarget=exports.sourceOrTarget=exports.sourceMergeTarget=exports.sourceAndTarget=exports.source=void 0;var target=exports.target=function target(_target){return _target};var source=exports.source=function source(_,_source){return _source};var targetOrSource=exports.targetOrSource=function targetOrSource(target,source){return target||source};var sourceOrTarget=exports.sourceOrTarget=function sourceOrTarget(target,source){return source||target};var targetAndSource=exports.targetAndSource=function targetAndSource(target,source){return target&&source};var sourceAndTarget=exports.sourceAndTarget=function sourceAndTarget(target,source){return source&&target};var targetPlusSource=exports.targetPlusSource=function targetPlusSource(target,source){return target+source};var sourcePlusTarget=exports.sourcePlusTarget=function sourcePlusTarget(target,source){return source+target};var targetMergeSource=exports.targetMergeSource=function targetMergeSource(target,source){return target.merge(source)};var sourceMergeTarget=exports.sourceMergeTarget=function sourceMergeTarget(target,source){return source.merge(target)}},{}],97:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.flattenMergeInput=exports["default"]=void 0;var _index=_interopRequireDefault(require("../OmnitureItem/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct.bind()}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _isNativeFunction(fn){try{return Function.toString.call(fn).indexOf("[native code]")!==-1}catch(e){return typeof fn==="function"}}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var flattenMergeInput=exports.flattenMergeInput=function flattenMergeInput(){for(var _len=arguments.length,items=new Array(_len),_key=0;_key<_len;_key++){items[_key]=arguments[_key]}return items.reduce(function(acc,item){if(item instanceof OmnitureCollection){acc.push.apply(acc,_toConsumableArray(item.values()))}else{acc.push(item)}return acc},[]).filter(function(item){return item instanceof _index["default"]})};var OmnitureCollection=function(_Map){_inherits(OmnitureCollection,_Map);var _super=_createSuper(OmnitureCollection);function OmnitureCollection(){var _this2;var _this;_classCallCheck(this,OmnitureCollection);_this=_super.call(this);(_this2=_this).merge.apply(_this2,arguments);return _this}_createClass(OmnitureCollection,[{key:"add",value:function add(item){return item instanceof _index["default"]?this.set(item.key,item):this}},{key:"merge",value:function merge(){var _this3=this;var omnitureItems=flattenMergeInput.apply(void 0,arguments);omnitureItems.forEach(function(item){if(!(item instanceof _index["default"])){return}var existingItem=_this3.get(item.key);if(existingItem){existingItem.merge(item)}else{_this3.add(item)}});return this}},{key:"toString",value:function toString(){var separator=arguments.length>0&&arguments[0]!==undefined?arguments[0]:_config.SEPARATORS.DEFAULT;return _toConsumableArray(this.values()).map(function(item){return item.toString()}).filter(Boolean).join(separator)}},{key:"sort",value:function sort(){var items=_toConsumableArray(this.values());this.clear();items.sort(function(item1,item2){return item1.compareKeys(item2)});this.merge.apply(this,_toConsumableArray(items))}}]);return OmnitureCollection}(_wrapNativeSuper(Map));var _default=exports["default"]=OmnitureCollection},{"../OmnitureItem/index.js":100,"../config.js":104}],98:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=_interopRequireDefault(require("../OmnitureItem/index.js"));var _index2=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var OmnitureContentRecommendation=function(_OmnitureItem){_inherits(OmnitureContentRecommendation,_OmnitureItem);var _super=_createSuper(OmnitureContentRecommendation);function OmnitureContentRecommendation(){var _this;var _props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OmnitureContentRecommendation);var defaultVals={moduleId:"",events:new _index2["default"],variables:new _index2["default"]};var props=_objectSpread(_objectSpread({},defaultVals),_props);_this=_super.call(this,props.moduleId);_this.moduleId=props.moduleId;_this.category="content";_this.events=props.events;_this.variables=props.variables;return _this}_createClass(OmnitureContentRecommendation,[{key:"merge",value:function merge(contentRec){if(contentRec instanceof OmnitureContentRecommendation&&contentRec.key===this.key){this.events.merge(contentRec.events);this.variables.merge(contentRec.variables)}return this}},{key:"toString",value:function toString(){return[(0,_analyticsUtils.toStrTrim)(this.category),(0,_analyticsUtils.toStrTrim)(this.moduleId),"","",this.events?this.events.toString(_config.SEPARATORS.PRODUCT_EVENTS):"",this.variables?this.variables.toString(_config.SEPARATORS.PRODUCT_VARIABLES):""].join(_config.SEPARATORS.PRODUCT_PROPS).replace(",","")}}]);return OmnitureContentRecommendation}(_index["default"]);var _default=exports["default"]=OmnitureContentRecommendation},{"../OmnitureCollection/index.js":97,"../OmnitureItem/index.js":100,"../config.js":104,"@apple/analytics-utils":190}],99:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=_interopRequireDefault(require("../OmnitureItem/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var OmnitureEvent=function(_OmnitureItem){_inherits(OmnitureEvent,_OmnitureItem);var _super=_createSuper(OmnitureEvent);function OmnitureEvent(key,value){var _this;_classCallCheck(this,OmnitureEvent);_this=_super.call(this,key);_this.value=value;return _this}_createClass(OmnitureEvent,[{key:"merge",value:function merge(event){if(event instanceof OmnitureEvent&&event.key===this.key){this.value=event.value}return this}},{key:"toString",value:function toString(){if(!this.key){return""}var trimmedValue=(0,_analyticsUtils.toStrTrim)(this.value);return!trimmedValue||trimmedValue==="true"?this.key:"".concat(this.key,"=").concat(trimmedValue)}}]);return OmnitureEvent}(_index["default"]);var _default=exports["default"]=OmnitureEvent},{"../OmnitureItem/index.js":100,"@apple/analytics-utils":190}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _splitKey3=_interopRequireDefault(require("./splitKey.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var OmnitureItem=function(){function OmnitureItem(key){_classCallCheck(this,OmnitureItem);this.key=(0,_analyticsUtils.toStrTrim)(key)}_createClass(OmnitureItem,[{key:"merge",value:function merge(item){if(item instanceof OmnitureItem){this.key=item.key}return this}},{key:"toString",value:function toString(){return this.key}},{key:"compareKeys",value:function compareKeys(item){if(!(item instanceof OmnitureItem)){return 0}var _splitKey=(0,_splitKey3["default"])(this.key),key1=_splitKey.prefix,num1=_splitKey.number;var _splitKey2=(0,_splitKey3["default"])(item.key),key2=_splitKey2.prefix,num2=_splitKey2.number;if(num1===num2&&key1&&key2){return key1.localeCompare(key2)}return num1-num2}}]);return OmnitureItem}();var _default=exports["default"]=OmnitureItem},{"./splitKey.js":101,"@apple/analytics-utils":190}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var splitKey=function splitKey(key){if(!key){return{prefix:"",number:0}}var match=key.match(/\d+$/);if(!match){return{prefix:key,number:0}}var index=match.index;return{prefix:key.slice(0,index),number:parseInt(key.slice(index),10)}};var _default=exports["default"]=splitKey},{}],102:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=_interopRequireDefault(require("../OmnitureItem/index.js"));var _index2=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var OmnitureProduct=function(_OmnitureItem){_inherits(OmnitureProduct,_OmnitureItem);var _super=_createSuper(OmnitureProduct);function OmnitureProduct(){var _this;var _props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,OmnitureProduct);var defaultVals={sku:"",category:"",qty:0,price:0,events:new _index2["default"],variables:new _index2["default"]};var props=_objectSpread(_objectSpread({},defaultVals),_props);props.sku=_analyticsUtils.beaconHelpers.guessPartNumber(props.sku);_this=_super.call(this,props.sku);_this.sku=props.sku;_this.category=props.category;_this.qty=props.qty;_this.price=props.price;_this.events=props.events;_this.variables=props.variables;return _this}_createClass(OmnitureProduct,[{key:"merge",value:function merge(product){if(product instanceof OmnitureProduct&&product.key===this.key){this.category=product.category||this.category;this.qty=product.qty||this.qty;this.price=product.price||this.price;this.events.merge(product.events);this.variables.merge(product.variables)}return this}},{key:"toString",value:function toString(){return[(0,_analyticsUtils.toStrTrim)(this.category),(0,_analyticsUtils.toStrTrim)(this.sku),this.qty?(0,_analyticsUtils.toStrTrim)(this.qty):"",this.price?_analyticsUtils.beaconHelpers.formatPrice(this.price):"",this.events?this.events.toString(_config.SEPARATORS.PRODUCT_EVENTS):"",this.variables?this.variables.toString(_config.SEPARATORS.PRODUCT_VARIABLES):""].join(_config.SEPARATORS.PRODUCT_PROPS).replace(",","")}}]);return OmnitureProduct}(_index["default"]);var _default=exports["default"]=OmnitureProduct},{"../OmnitureCollection/index.js":97,"../OmnitureItem/index.js":100,"../config.js":104,"@apple/analytics-utils":190}],103:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsUtils=require("@apple/analytics-utils");var _index=_interopRequireDefault(require("../OmnitureItem/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var OmnitureVariable=function(_OmnitureItem){_inherits(OmnitureVariable,_OmnitureItem);var _super=_createSuper(OmnitureVariable);function OmnitureVariable(key,value){var _this;_classCallCheck(this,OmnitureVariable);_this=_super.call(this,key);_this.value=value;return _this}_createClass(OmnitureVariable,[{key:"merge",value:function merge(variable){if(variable instanceof OmnitureVariable&&variable.key===this.key){this.value=variable.value}return this}},{key:"toString",value:function toString(){var trimmedValue=(0,_analyticsUtils.toStrTrim)(this.value);if(!this.key||!trimmedValue){return""}return"".concat(this.key,"=").concat(trimmedValue)}}]);return OmnitureVariable}(_index["default"]);var _default=exports["default"]=OmnitureVariable},{"../OmnitureItem/index.js":100,"@apple/analytics-utils":190}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SEPARATORS=void 0;var SEPARATORS=exports.SEPARATORS={DEFAULT:",",PRODUCT_PROPS:";",PRODUCT_EVENTS:"|",PRODUCT_VARIABLES:"|"}},{}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"OmnitureCollection",{enumerable:true,get:function get(){return _index["default"]}});Object.defineProperty(exports,"OmnitureContentRecommendation",{enumerable:true,get:function get(){return _index6["default"]}});Object.defineProperty(exports,"OmnitureEvent",{enumerable:true,get:function get(){return _index3["default"]}});Object.defineProperty(exports,"OmnitureItem",{enumerable:true,get:function get(){return _index2["default"]}});Object.defineProperty(exports,"OmnitureProduct",{enumerable:true,get:function get(){return _index5["default"]}});Object.defineProperty(exports,"OmnitureVariable",{enumerable:true,get:function get(){return _index4["default"]}});Object.defineProperty(exports,"parseEventCollectionString",{enumerable:true,get:function get(){return _parseEventCollectionString["default"]}});Object.defineProperty(exports,"parseItemCollectionArray",{enumerable:true,get:function get(){return _parseItemCollectionArray["default"]}});Object.defineProperty(exports,"parseItemCollectionString",{enumerable:true,get:function get(){return _parseItemCollectionString["default"]}});Object.defineProperty(exports,"parseProductCollectionString",{enumerable:true,get:function get(){return _index7["default"]}});var _index=_interopRequireDefault(require("./OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("./OmnitureItem/index.js"));var _index3=_interopRequireDefault(require("./OmnitureEvent/index.js"));var _index4=_interopRequireDefault(require("./OmnitureVariable/index.js"));var _index5=_interopRequireDefault(require("./OmnitureProduct/index.js"));var _index6=_interopRequireDefault(require("./OmnitureContentRecommendation/index.js"));var _parseItemCollectionString=_interopRequireDefault(require("./parsers/parseItemCollectionString.js"));var _parseItemCollectionArray=_interopRequireDefault(require("./parsers/parseItemCollectionArray.js"));var _parseEventCollectionString=_interopRequireDefault(require("./parsers/parseEventCollectionString.js"));var _index7=_interopRequireDefault(require("./parsers/parseProductCollectionString/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./OmnitureCollection/index.js":97,"./OmnitureContentRecommendation/index.js":98,"./OmnitureEvent/index.js":99,"./OmnitureItem/index.js":100,"./OmnitureProduct/index.js":102,"./OmnitureVariable/index.js":103,"./parsers/parseEventCollectionString.js":106,"./parsers/parseItemCollectionArray.js":107,"./parsers/parseItemCollectionString.js":108,"./parsers/parseProductCollectionString/index.js":110}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("../OmnitureEvent/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var parseEventCollectionString=function parseEventCollectionString(eventCollectionString){var separator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:_config.SEPARATORS.DEFAULT;var collection=new _index["default"];if(!eventCollectionString||typeof eventCollectionString!=="string"){return collection}eventCollectionString.split(separator).forEach(function(eventString){var _eventString$split=eventString.split("="),_eventString$split2=_slicedToArray(_eventString$split,2),key=_eventString$split2[0],value=_eventString$split2[1];if(key){collection.add(new _index2["default"](key,value))}});return collection};var _default=exports["default"]=parseEventCollectionString},{"../OmnitureCollection/index.js":97,"../OmnitureEvent/index.js":99,"../config.js":104}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("../OmnitureItem/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var parseItemCollectionArray=function parseItemCollectionArray(itemCollectionArray){var collection=new _index["default"];if(!itemCollectionArray||!Array.isArray(itemCollectionArray)){return collection}itemCollectionArray.forEach(function(key){key&&collection.add(new _index2["default"](key))});return collection};var _default=exports["default"]=parseItemCollectionArray},{"../OmnitureCollection/index.js":97,"../OmnitureItem/index.js":100}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("../OmnitureItem/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var parseItemCollectionString=function parseItemCollectionString(itemCollectionString){var separator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:_config.SEPARATORS.DEFAULT;var collection=new _index["default"];if(!itemCollectionString||typeof itemCollectionString!=="string"){return collection}itemCollectionString.split(separator).forEach(function(key){key&&collection.add(new _index2["default"](key))});return collection};var _default=exports["default"]=parseItemCollectionString},{"../OmnitureCollection/index.js":97,"../OmnitureItem/index.js":100,"../config.js":104}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _index=_interopRequireDefault(require("../../OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("../../OmnitureEvent/index.js"));var _index3=_interopRequireDefault(require("../../OmnitureProduct/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EVENT_TOTAL_QTY=_analyticsOmnitureConstants.EVENTS.EVENT_101;var EVENT_TOTAL_PRICE=_analyticsOmnitureConstants.EVENTS.EVENT_102;var toNumber=_analyticsUtils.beaconHelpers.getRawNumberFromString;var formatPrice=_analyticsUtils.beaconHelpers.formatPrice;var addProductToCollection=function addProductToCollection(collection,product){if(!(collection instanceof _index["default"]&&product instanceof _index3["default"])){return collection}var existingProduct=collection.get(product.sku);if(!existingProduct){return collection.add(product)}var totalQty=toNumber(existingProduct.qty)+toNumber(product.qty);var totalPrice=formatPrice(toNumber(existingProduct.price)*totalQty);existingProduct.qty=totalQty;existingProduct.variables.merge(product.variables);existingProduct.events.merge(product.events,new _index2["default"](EVENT_TOTAL_QTY,totalQty),new _index2["default"](EVENT_TOTAL_PRICE,totalPrice));return collection};var _default=exports["default"]=addProductToCollection},{"../../OmnitureCollection/index.js":97,"../../OmnitureEvent/index.js":99,"../../OmnitureProduct/index.js":102,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../../OmnitureCollection/index.js"));var _productCollectionStringToProductStringArray=_interopRequireDefault(require("./productCollectionStringToProductStringArray.js"));var _parseProductString=_interopRequireDefault(require("./parseProductString.js"));var _addProductToCollection=_interopRequireDefault(require("./addProductToCollection.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var parseProductCollectionString=function parseProductCollectionString(productCollectionString){var collection=new _index["default"];if(!productCollectionString||typeof productCollectionString!=="string"){return collection}(0,_productCollectionStringToProductStringArray["default"])(productCollectionString).forEach(function(productString){(0,_addProductToCollection["default"])(collection,(0,_parseProductString["default"])(productString))});return collection};var _default=exports["default"]=parseProductCollectionString},{"../../OmnitureCollection/index.js":97,"./addProductToCollection.js":109,"./parseProductString.js":111,"./productCollectionStringToProductStringArray.js":112}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../../OmnitureProduct/index.js"));var _config=require("../../config.js");var _parseEventCollectionString=_interopRequireDefault(require("./../parseEventCollectionString.js"));var _parseVariableCollectionString=_interopRequireDefault(require("./../parseVariableCollectionString.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var parseProductString=function parseProductString(productString){if(!productString||typeof productString!=="string"){return null}var _productString$split=productString.split(_config.SEPARATORS.PRODUCT_PROPS),_productString$split2=_slicedToArray(_productString$split,6),category=_productString$split2[0],sku=_productString$split2[1],qty=_productString$split2[2],price=_productString$split2[3],events=_productString$split2[4],variables=_productString$split2[5];var product={category:category,sku:sku,qty:qty,price:price,events:(0,_parseEventCollectionString["default"])(events,_config.SEPARATORS.PRODUCT_EVENTS),variables:(0,_parseVariableCollectionString["default"])(variables)};return new _index["default"](product)};var _default=exports["default"]=parseProductString},{"../../OmnitureProduct/index.js":102,"../../config.js":104,"./../parseEventCollectionString.js":106,"./../parseVariableCollectionString.js":113}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _config=require("../../config.js");var productCollectionStringToProductStringArray=function productCollectionStringToProductStringArray(productCollectionString){if(!productCollectionString||typeof productCollectionString!=="string"){return[]}return productCollectionString.split(_config.SEPARATORS.DEFAULT).filter(Boolean).reduce(function(output,productStringCandidate){if(output.length&&!productStringCandidate.includes(_config.SEPARATORS.PRODUCT_PROPS)){output[output.length-1]+=_config.SEPARATORS.DEFAULT+productStringCandidate}else{output.push(productStringCandidate)}return output},[])};var _default=exports["default"]=productCollectionStringToProductStringArray},{"../../config.js":104}],113:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../OmnitureCollection/index.js"));var _index2=_interopRequireDefault(require("../OmnitureVariable/index.js"));var _config=require("../config.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var parseVariableCollectionString=function parseVariableCollectionString(variablesString){var collection=new _index["default"];if(!variablesString||typeof variablesString!=="string"){return collection}variablesString.split(_config.SEPARATORS.PRODUCT_VARIABLES).forEach(function(variableString){var _variableString$split=variableString.split("="),_variableString$split2=_slicedToArray(_variableString$split,2),key=_variableString$split2[0],value=_variableString$split2[1];if(key&&value){collection.add(new _index2["default"](key,value))}});return collection};var _default=exports["default"]=parseVariableCollectionString},{"../OmnitureCollection/index.js":97,"../OmnitureVariable/index.js":103,"../config.js":104}],114:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.generateProps=void 0;var generateProps=exports.generateProps=function generateProps(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$keyPrefix=_ref.keyPrefix,keyPrefix=_ref$keyPrefix===void 0?"":_ref$keyPrefix,_ref$valuePrefix=_ref.valuePrefix,valuePrefix=_ref$valuePrefix===void 0?"":_ref$valuePrefix,_ref$count=_ref.count,count=_ref$count===void 0?0:_ref$count;var result={};for(var i=1;i<=count;i++){result["".concat(keyPrefix).concat(i)]="".concat(valuePrefix).concat(i)}return result}},{}],115:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VARS=exports.TRACK_LINK_ARGS=exports.PROP_MAX=exports.EVENT_MAX=exports.EVENTS=exports.EVAR_MAX=void 0;var _generateProps=require("./generateProps.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var EVAR_MAX=exports.EVAR_MAX=155;var PROP_MAX=exports.PROP_MAX=75;var VARS=exports.VARS=_objectSpread(_objectSpread({CAMPAIGN:"campaign",CHANNEL:"channel",CHAR_SET:"charSet",CITY:"city",CURRENCY_CODE:"currencyCode",EVENTS:"events",HIER1:"hier1",LINK_INTERNAL_FILTERS:"linkInternalFilters",LINK_TRACK_EVENTS:"linkTrackEvents",LINK_TRACK_VARS:"linkTrackVars",LIST_1:"list1",LIST_2:"list2",LIST_3:"list3",PAGE_NAME:"pageName",PAGE_TYPE:"pageType",PAGE_URL:"pageURL",PRODUCTS:"products",PROVINCE:"province",PURCHASE_ID:"purchaseID",REFERRER:"referrer",SERVER:"server",STATE:"state",TRACKING_SERVER:"trackingServer",TRACKING_SERVER_SECURE:"trackingServerSecure",ZIP:"zip"},(0,_generateProps.generateProps)({keyPrefix:"PROP_",valuePrefix:"prop",count:PROP_MAX})),(0,_generateProps.generateProps)({keyPrefix:"EVAR_",valuePrefix:"eVar",count:EVAR_MAX}));var EVENT_MAX=exports.EVENT_MAX=520;var EVENTS=exports.EVENTS=(0,_generateProps.generateProps)({keyPrefix:"EVENT_",valuePrefix:"event",count:EVENT_MAX});EVENTS.SC_ADD="scAdd";EVENTS.PROD_VIEW="prodView";var TRACK_LINK_ARGS=exports.TRACK_LINK_ARGS={ELEMENT:{DISABLE_DELAY:true},LINK_TYPE:{DOWNLOAD:"d",EXTERNAL:"e",CUSTOM:"o"}}},{"./generateProps.js":114}],116:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loaders=void 0;var _analyticsMergeBeacons=require("@apple/analytics-merge-beacons");var _analyticsPassiveTracker=require("@apple/analytics-passive-tracker");var _index=require("./loaders/index.js");var loaders=exports.loaders=function loaders(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"next";var data=(0,_analyticsPassiveTracker.load)(type);if(data===null){return null}return _index.loadersProcesses.reduce(function(result,current){var beacon=current(data);if(beacon){(0,_analyticsMergeBeacons.merge)({target:result,source:beacon})}return result},{})}},{"./loaders/index.js":117,"@apple/analytics-merge-beacons":94,"@apple/analytics-passive-tracker":126}],117:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadersProcesses=void 0;var _loaderAPI=require("./loaderAPI.js");var _loaderBeacon=require("./loaderBeacon.js");var _loaderPageName=require("./loaderPageName.js");var _loaderArea=require("./loaderArea.js");var loadersProcesses=exports.loadersProcesses=[_loaderBeacon.loaderBeacon,_loaderAPI.loaderAPI,_loaderPageName.loaderPageName,_loaderArea.loaderArea]},{"./loaderAPI.js":118,"./loaderArea.js":119,"./loaderBeacon.js":120,"./loaderPageName.js":121}],118:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loaderAPI=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var BR="::";var SEPARATOR="^";var loaderAPI=exports.loaderAPI=function loaderAPI(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var data=Object.keys(input).reduce(function(out,key){var pageData=input[key];if(!pageData||!pageData.api){return out}var api=pageData.api;var pageName="".concat(key==="current"?"pageName":"c14",'+"');return out.concat(api.map(function(_ref){var type=_ref.type,value=_ref.value;return pageName+BR+type+BR+value}))},[]).join(SEPARATOR+'"+');if(data.length===0){return null}return _defineProperty({},_analyticsOmnitureConstants.VARS.LIST_2,"D="+data+'"')}},{"@apple/analytics-omniture-constants":115}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loaderArea=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var loaderArea=exports.loaderArea=function loaderArea(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var previous=input.previous;if(!previous||!previous.area){return null}var area=previous.area;return _defineProperty({},_analyticsOmnitureConstants.VARS.PROP_57,area)}},{"@apple/analytics-omniture-constants":115}],120:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loaderBeacon=void 0;var _analyticsMergeBeacons=require("@apple/analytics-merge-beacons");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var parseBeacon=function parseBeacon(){var beacon=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var result=_objectSpread({},beacon);if(beacon.hasOwnProperty(_analyticsOmnitureConstants.VARS.EVENTS)){result[_analyticsOmnitureConstants.VARS.EVENTS]=(0,_analyticsOmnitureCollection.parseEventCollectionString)(beacon[_analyticsOmnitureConstants.VARS.EVENTS])}if(beacon.hasOwnProperty(_analyticsOmnitureConstants.VARS.PRODUCTS)){result[_analyticsOmnitureConstants.VARS.PRODUCTS]=(0,_analyticsOmnitureCollection.parseProductCollectionString)(beacon[_analyticsOmnitureConstants.VARS.PRODUCTS])}return result};var loaderBeacon=exports.loaderBeacon=function loaderBeacon(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _input$current=input.current,current=_input$current===void 0?{}:_input$current,_input$previous=input.previous,previous=_input$previous===void 0?{}:_input$previous;var mergedBeacons=(0,_analyticsMergeBeacons.merge)({target:parseBeacon(previous.beacon),source:parseBeacon(current.beacon)});return mergedBeacons}},{"@apple/analytics-merge-beacons":94,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loaderPageName=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var loaderPageName=exports.loaderPageName=function loaderPageName(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var previous=input.previous;if(!previous||!previous.pageName){return null}var pageName=previous.pageName;return _defineProperty({},_analyticsOmnitureConstants.VARS.PROP_14,pageName)}},{"@apple/analytics-omniture-constants":115}],122:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"append",{enumerable:true,get:function get(){return _append.append}});Object.defineProperty(exports,"init",{enumerable:true,get:function get(){return _init.init}});Object.defineProperty(exports,"load",{enumerable:true,get:function get(){return _load.load}});Object.defineProperty(exports,"merge",{enumerable:true,get:function get(){return _merge.merge}});Object.defineProperty(exports,"readDataStore",{enumerable:true,get:function get(){return _dataStore.readDataStore}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set.set}});Object.defineProperty(exports,"triggerNewPage",{enumerable:true,get:function get(){return _triggerNewPage.triggerNewPage}});var _init=require("./init.js");var _set=require("./set.js");var _merge=require("./merge.js");var _append=require("./append.js");var _load=require("./load.js");var _triggerNewPage=require("./triggerNewPage.js");var _dataStore=require("./dataStore.js")},{"./append.js":123,"./dataStore.js":124,"./init.js":127,"./load.js":128,"./merge.js":129,"./set.js":130,"./triggerNewPage.js":132}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.append=void 0;var _error=require("./error.js");var _setDefaults=require("./setDefaults.js");var _set=require("./set.js");var _dataStore=require("./dataStore.js");var append=exports.append=function append(key,data){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!key||typeof key!=="string"){throw(0,_error.error)("append","invalid key")}if(!data){return}var settings=(0,_setDefaults.setDefaults)(options);var type=settings.type;var original=(0,_dataStore.retrieve)({type:type,key:key});if(original!==null&&typeof original.concat!=="function"||typeof data.concat!=="function"){throw(0,_error.error)("append","cannot call append on this type of data")}if(original===null){(0,_set.set)(key,data,settings);return}(0,_dataStore.store)({type:type,key:key,data:original.concat(data)})}},{"./dataStore.js":124,"./error.js":125,"./set.js":130,"./setDefaults.js":131}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.syncToCookie=exports.store=exports.retrieve=exports.readDataStore=exports.configure=exports.clear=void 0;var _analyticsDataMule=require("@apple/analytics-data-mule");var _setDefaults=require("./setDefaults.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var dataStore={};var MULE_VERSION="v1";var readDataStore=exports.readDataStore=function readDataStore(){var data=_objectSpread({},dataStore);var page=(0,_analyticsDataMule.load)();if(page&&page!==null){data.page=page}return data};var configure=exports.configure=function configure(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$mule=_ref.mule,mule=_ref$mule===void 0?null:_ref$mule;if(mule!==null&&mule.version){MULE_VERSION=mule.version}};var store=exports.store=function store(_ref2){var type=_ref2.type,key=_ref2.key,data=_ref2.data;if(type==="page"){var options={version:MULE_VERSION};var cookieOptions=_objectSpread(_objectSpread({},options),{},{origin:"cross"});var cookieDomain=(0,_setDefaults.getCookieDomain)();if(cookieDomain!==null){cookieOptions.cookieDomain=cookieDomain}(0,_analyticsDataMule.save)({data:_defineProperty({},key,data),options:options});return}if(!dataStore.hasOwnProperty(type)){dataStore[type]={}}dataStore[type][key]=data};var retrieve=exports.retrieve=function retrieve(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},type=_ref3.type,_ref3$key=_ref3.key,key=_ref3$key===void 0?null:_ref3$key;if(type==="page"){var data=(0,_analyticsDataMule.load)();if(data===null){return null}if(key===null){return data}return data[key]||null}if(!dataStore.hasOwnProperty(type)){return null}if(key===null){return dataStore[type]||null}return dataStore[type][key]||null};var clear=exports.clear=function clear(_ref4){var type=_ref4.type;if(type==="page"){var cookieDomain=(0,_setDefaults.getCookieDomain)();var options={};if(cookieDomain!==null){options.cookieDomain=cookieDomain}(0,_analyticsDataMule.clearAll)(options)}if(dataStore[type]){delete dataStore[type]}};var syncToCookie=exports.syncToCookie=function syncToCookie(){var options={version:MULE_VERSION};var cookieOptions=_objectSpread(_objectSpread({},options),{},{origin:"cross"});var cookieDomain=(0,_setDefaults.getCookieDomain)();if(cookieDomain!==null){cookieOptions.cookieDomain=cookieDomain}(0,_analyticsDataMule.save)({data:{},options:cookieOptions})}},{"./setDefaults.js":131,"@apple/analytics-data-mule":74}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.error=void 0;var error=exports.error=function error(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$type=_ref.type,type=_ref$type===void 0?null:_ref$type,_ref$message=_ref.message,message=_ref$message===void 0?"Unknown error":_ref$message;return new Error("[PASSIVE TRACKER".concat(type?":"+type.toUpperCase():"","] ").concat(message))}},{}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"append",{enumerable:true,get:function get(){return _api.append}});Object.defineProperty(exports,"init",{enumerable:true,get:function get(){return _api.init}});Object.defineProperty(exports,"load",{enumerable:true,get:function get(){return _api.load}});Object.defineProperty(exports,"merge",{enumerable:true,get:function get(){return _api.merge}});Object.defineProperty(exports,"readDataStore",{enumerable:true,get:function get(){return _api.readDataStore}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _api.set}});Object.defineProperty(exports,"triggerNewPage",{enumerable:true,get:function get(){return _api.triggerNewPage}});var _api=require("./api.js")},{"./api.js":122}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.init=void 0;var _analyticsDataMule=require("@apple/analytics-data-mule");var _dataStore=require("./dataStore.js");var _setDefaults=require("./setDefaults.js");var _triggerNewPage=require("./triggerNewPage.js");var init=exports.init=function init(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$muleVersion=_ref.muleVersion,muleVersion=_ref$muleVersion===void 0?null:_ref$muleVersion,_ref$cookieDomain=_ref.cookieDomain,cookieDomain=_ref$cookieDomain===void 0?null:_ref$cookieDomain;(0,_dataStore.configure)({mule:{version:muleVersion||"v1"}});if(cookieDomain!==null){(0,_setDefaults.registerCookieDomain)(cookieDomain)}var packDown=(0,_analyticsDataMule.setup)();window.addEventListener("pagehide",_triggerNewPage.triggerNewPage);window.addEventListener("beforeunload",_triggerNewPage.triggerNewPage);return function(){packDown();window.removeEventListener("pagehide",_triggerNewPage.triggerNewPage);window.removeEventListener("beforeunload",_triggerNewPage.triggerNewPage)}}},{"./dataStore.js":124,"./setDefaults.js":131,"./triggerNewPage.js":132,"@apple/analytics-data-mule":74}],128:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.load=void 0;var _dataStore=require("./dataStore.js");var load=exports.load=function load(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"next";var data={current:(0,_dataStore.retrieve)({type:"next"})};(0,_dataStore.clear)({type:"next"});if(type==="page"){data.previous=(0,_dataStore.retrieve)({type:"page"});(0,_dataStore.clear)({type:"page"})}if(data.current===null){delete data.current}if(data.previous===null){delete data.previous}if(Object.entries(data).length===0){return null}return data}},{"./dataStore.js":124}],129:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.merge=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _error=require("./error.js");var _setDefaults=require("./setDefaults.js");var _set=require("./set.js");var _dataStore=require("./dataStore.js");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var mergeObjects=function mergeObjects(a,b){var isBeacon=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var data=_objectSpread(_objectSpread({},a),b);if(isBeacon&&a.hasOwnProperty("events")&&b.hasOwnProperty("events")){data.events=(0,_analyticsOmnitureCollection.parseEventCollectionString)(a.events).merge((0,_analyticsOmnitureCollection.parseEventCollectionString)(b.events)).toString()}if(isBeacon&&a.hasOwnProperty("products")&&b.hasOwnProperty("products")){data.products=(0,_analyticsOmnitureCollection.parseProductCollectionString)(a.products).merge((0,_analyticsOmnitureCollection.parseProductCollectionString)(b.products)).toString()}return data};var isObject=function isObject(item){return _typeof(item)==="object"};var merge=exports.merge=function merge(key,data){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!key||typeof key!=="string"){throw(0,_error.error)("merge","invalid key")}if(!data){return}var settings=(0,_setDefaults.setDefaults)(options);var type=settings.type;var original=(0,_dataStore.retrieve)({type:type,key:key});var isNotValidOriginal=original!==null&&!isObject(original);var isNotValidData=!isObject(data);if(isNotValidOriginal||isNotValidData){throw(0,_error.error)("merge","invalid data type")}if(original===null){(0,_set.set)(key,data,settings);return}if(Array.isArray(original)){(0,_dataStore.store)({type:type,key:key,data:Array.from(new Set([].concat(_toConsumableArray(original),_toConsumableArray(data))))});return}(0,_dataStore.store)({type:type,key:key,data:mergeObjects(original,data,key==="beacon")})}},{"./dataStore.js":124,"./error.js":125,"./set.js":130,"./setDefaults.js":131,"@apple/analytics-omniture-collection":105}],130:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=void 0;var _error=require("./error.js");var _setDefaults2=require("./setDefaults.js");var _dataStore=require("./dataStore.js");var set=exports.set=function set(key,data){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!key||typeof key!=="string"){throw(0,_error.error)("set","invalid key")}if(!data){return}var _setDefaults=(0,_setDefaults2.setDefaults)(options),type=_setDefaults.type;(0,_dataStore.store)({type:type,key:key,data:data})}},{"./dataStore.js":124,"./error.js":125,"./setDefaults.js":131}],131:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setDefaults=exports.registerCookieDomain=exports.getCookieDomain=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var cookieDomain=null;var registerCookieDomain=exports.registerCookieDomain=function registerCookieDomain(value){cookieDomain=value};var getCookieDomain=exports.getCookieDomain=function getCookieDomain(){return cookieDomain};var setDefaults=exports.setDefaults=function setDefaults(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var defaults={type:"next"};return _objectSpread(_objectSpread({},defaults),options)}},{}],132:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.triggerNewPage=void 0;var _dataStore=require("./dataStore.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var triggerNewPage=exports.triggerNewPage=function triggerNewPage(){["next","exit"].forEach(function(type){var data=(0,_dataStore.retrieve)({type:type});if(data===null){return}Object.keys(data).forEach(function(key){var value=data[key];if(key==="beacon"&&_typeof(value)==="object"){Object.keys(value).forEach(function(k){var v=value[k];if(typeof v==="string"){value[k]=v.replace(/pageName/g,"c14")}})}(0,_dataStore.store)({type:"page",key:key,data:value})});(0,_dataStore.clear)({type:type})});(0,_dataStore.syncToCookie)()}},{"./dataStore.js":124}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.encode=exports.decode=void 0;var _validation=require("./validation.js");function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var encodePair=function encodePair(key,data){return"".concat(key,":").concat(encodeURIComponent(data[key]))};var encodeJoin=function encodeJoin(a,b){return"".concat(a,"|").concat(b)};var encode=exports.encode=function encode(data){var safeData=(0,_validation.sanitizeCookie)(data);return Object.keys(safeData).reduce(function(out,key){return out===""?encodePair(key,safeData):encodeJoin(out,encodePair(key,safeData))},"")};var decode=exports.decode=function decode(data){return typeof data!=="string"?{}:data.split("|").reduce(function(decoded,current){var _current$split=current.split(":"),_current$split2=_slicedToArray(_current$split,2),key=_current$split2[0],value=_current$split2[1];var decodedValue=decodeURIComponent(value);var keyNotValid=!(0,_validation.validKey)(key);var valueNotValid=!((0,_validation.validContent)(decodedValue)||(0,_validation.isException)(decodedValue));if(keyNotValid||valueNotValid){return decoded}decoded[key]=decodedValue;return decoded},{})}},{"./validation.js":138}],134:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSearchParams=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var parseSearchParams=function parseSearchParams(queryString){var state=queryString.split("&").reduce(function(result,current){if(current===""){return result}var _current$split=current.split("="),_current$split2=_slicedToArray(_current$split,2),key=_current$split2[0],value=_current$split2[1];result[key]=value;return result},{});return{set:function set(key,value){state[key]=value},get:function get(key){return state[key]},toString:function toString(){return Object.keys(state).reduce(function(result,key){return result===""?"".concat(key,"=").concat(state[key]):"".concat(result,"&").concat(key,"=").concat(state[key])},"")}}};var getSearchParams=exports.getSearchParams=function getSearchParams(queryString){return URLSearchParams?new URLSearchParams(queryString):parseSearchParams(queryString)}},{}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"getBeacon",{enumerable:true,get:function get(){return _relayRead.getBeacon}});Object.defineProperty(exports,"getOne",{enumerable:true,get:function get(){return _relayRead.getOne}});Object.defineProperty(exports,"relayRead",{enumerable:true,get:function get(){return _relayRead.relayRead}});Object.defineProperty(exports,"relayWrite",{enumerable:true,get:function get(){return _relayWrite.relayWrite}});var _relayWrite=require("./relayWrite.js");var _relayRead=require("./relayRead.js")},{"./relayRead.js":136,"./relayWrite.js":137}],136:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.relayRead=exports.getOne=exports.getBeacon=void 0;var _validation=require("./validation.js");var _encoder=require("./encoder.js");var _getSearchParams=require("./getSearchParams.js");var appendEvent=function appendEvent(current,key){return current?"".concat(current,",event").concat(key):"event".concat(key)};var appendEVar17=function appendEVar17(current,next){return current?"".concat(current,"|").concat(next):next};var relayRead=exports.relayRead=function relayRead(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$queryString=_ref.queryString,queryString=_ref$queryString===void 0?"":_ref$queryString,relay=_ref.relay,cookieData=_ref.cookieData;if(!cookieData||!relay){return{queryString:queryString}}var cookie=(0,_encoder.decode)(cookieData);var params=(0,_getSearchParams.getSearchParams)(queryString);var beacon={};Object.keys(relay).forEach(function(key){if(cookie[key]&&(0,_validation.validKey)(key)){params.set(relay[key],cookie[key]);beacon.events=appendEvent(beacon.events,key);beacon.eVar17=appendEVar17(beacon.eVar17,cookie[key])}});return{queryString:params.toString(),beacon:beacon}};var getOne=exports.getOne=function getOne(_ref2){var key=_ref2.key,cookieData=_ref2.cookieData;return(0,_encoder.decode)(cookieData)[key]||null};var getBeacon=exports.getBeacon=function getBeacon(_ref3){var keys=_ref3.keys,cookieData=_ref3.cookieData,defaultCampaigns=_ref3.defaultCampaigns;var cookie=(0,_encoder.decode)(cookieData);var beacon={};Array.isArray(keys)&&keys.forEach(function(key){if((0,_validation.validKey)(key)){if(cookie[key]){beacon.events=appendEvent(beacon.events,key);beacon.eVar17=appendEVar17(beacon.eVar17,cookie[key])}else if(defaultCampaigns&&defaultCampaigns[key]){beacon.events=appendEvent(beacon.events,key);beacon.eVar17=appendEVar17(beacon.eVar17,defaultCampaigns[key])}}});return beacon}},{"./encoder.js":133,"./getSearchParams.js":134,"./validation.js":138}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.relayWrite=void 0;var _validation=require("./validation.js");var _encoder=require("./encoder.js");var _getSearchParams=require("./getSearchParams.js");var relayWrite=exports.relayWrite=function relayWrite(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$queryString=_ref.queryString,queryString=_ref$queryString===void 0?"":_ref$queryString,_ref$cookieData=_ref.cookieData,cookieData=_ref$cookieData===void 0?"":_ref$cookieData;var data=(0,_encoder.decode)(cookieData);var params=(0,_getSearchParams.getSearchParams)(queryString);var rid=params.get("rid");if(rid){data[rid.slice(0,_validation.PREFIX_SIZE)]=encodeURIComponent(rid.slice(_validation.PREFIX_SIZE+1))}return(0,_encoder.encode)(data)}},{"./encoder.js":133,"./getSearchParams.js":134,"./validation.js":138}],138:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validKey=exports.validContent=exports.sanitizeCookie=exports.isException=exports.PREFIX_SIZE=void 0;var PREFIX_SIZE=exports.PREFIX_SIZE=3;var MAX_CONTENT_LENGTH=50;var MAX_KEY_LENGTH=5;var EXCEPTION_MAX_CONTENT_LENGTH=100;var validKey=exports.validKey=function validKey(key){return/^\d{3}$/.test(key)};var validContent=exports.validContent=function validContent(value){return/^[0-9A-Za-z-_]+$/.test(value)};var isException=exports.isException=function isException(value){return/^cid%3D[0-9A-Za-z-_]+$/.test(value)};var isNotValidContentOrException=function isNotValidContentOrException(value){return!validContent(value)&&!isException(value)};var isExceptionAndExceedsLength=function isExceptionAndExceedsLength(value){return isException(value)&&value.length>EXCEPTION_MAX_CONTENT_LENGTH};var isInvalid=function isInvalid(key,data,index){return!validKey(key)||typeof data[key]!=="string"||isNotValidContentOrException(data[key])||index>=MAX_KEY_LENGTH};var isTooLong=function isTooLong(value){return value.length>MAX_CONTENT_LENGTH};var sanitizeCookie=exports.sanitizeCookie=function sanitizeCookie(data){Object.keys(data).forEach(function(key,index){if(isInvalid(key,data,index)){delete data[key]}else if(isExceptionAndExceedsLength(data[key])){data[key]=data[key].slice(0,EXCEPTION_MAX_CONTENT_LENGTH)}else if(isTooLong(data[key])){data[key]=data[key].slice(0,MAX_CONTENT_LENGTH)}});return data}},{}],139:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.accessoriesFilter=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var accessoriesFilter=exports.accessoriesFilter=function accessoriesFilter(){var _ref2;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},keyword=_ref.keyword,action=_ref.action,text=_ref.text,analyticsPrefix=_ref.analyticsPrefix;return _ref2={},_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVAR_2,(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase()),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVAR_4,"".concat((0,_analyticsUtils.toStrTrim)(analyticsPrefix),":search:accessories")),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_3,"filter - ".concat((0,_analyticsUtils.toStrTrim)(action)," - ").concat((0,_analyticsUtils.toStrTrim)(text))),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_7,(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase()),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVENTS,new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.ACCESSORIES_FILTER))),_ref2}},{"./constants.js":141,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],140:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.begin=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var ACTION_DEFAULT="engage";var begin=exports.begin=function begin(){var _ref2;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$action=_ref.action,action=_ref$action===void 0?"":_ref$action;return _ref2={},_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_3,"".concat((0,_analyticsUtils.toStrTrim)(action)||ACTION_DEFAULT," - search field")),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVENTS,new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.BEGIN))),_ref2}},{"./constants.js":141,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],141:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EVENTS=exports.APPLE_SERVICES=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var EVENTS=exports.EVENTS={COMPLETE:_analyticsOmnitureConstants.EVENTS.EVENT_7,SEARCH:_analyticsOmnitureConstants.EVENTS.EVENT_8,EXIT:_analyticsOmnitureConstants.EVENTS.EVENT_364,BEGIN:_analyticsOmnitureConstants.EVENTS.EVENT_366,QUICK_LINK:_analyticsOmnitureConstants.EVENTS.EVENT_38,SUGGESTED:_analyticsOmnitureConstants.EVENTS.EVENT_39,NO_RESULTS:_analyticsOmnitureConstants.EVENTS.EVENT_49,NO_RESULTS_CLICK:_analyticsOmnitureConstants.EVENTS.EVENT_67,DEFAULT_LINK:_analyticsOmnitureConstants.EVENTS.EVENT_50,ACCESSORIES_LINK:_analyticsOmnitureConstants.EVENTS.EVENT_52,STORE_LINK:_analyticsOmnitureConstants.EVENTS.EVENT_288,ACCESSORIES_FILTER:_analyticsOmnitureConstants.EVENTS.EVENT_369,CURATED:_analyticsOmnitureConstants.EVENTS.EVENT_370,PAGINATION:_analyticsOmnitureConstants.EVENTS.EVENT_371,SERP_DIRECT:_analyticsOmnitureConstants.EVENTS.EVENT_372};var APPLE_SERVICES=exports.APPLE_SERVICES=[{protocol:"applenewss:",token:"nws-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_285},{protocol:"itms-apps:",token:"arc-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_288},{origin:"https://news.apple.com",token:"nws-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_285},{origin:"https://music.apple.com",token:"mus-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_286},{origin:"https://wallet.apple.com",token:"ccd-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_287},{origin:"https://apps.apple.com",token:"app_store-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_288},{origin:"https://tv.apple.com",token:"atv-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_289},{origin:"https://books.apple.com",token:"books-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_294},{origin:"https://fitness.apple.com",token:"fitness-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_299},{origin:"https://podcasts.apple.com",token:"podcasts-0-int_srch-apl",event:_analyticsOmnitureConstants.EVENTS.EVENT_300}]},{"@apple/analytics-omniture-constants":115}],142:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.exit=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var exit=exports.exit=function exit(){var _ref2;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},keyword=_ref.keyword;return _ref2={},_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_7,(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase()),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_29,null),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVAR_2,"D=c7"),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVENTS,new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.EXIT))),_ref2}},{"./constants.js":141,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],143:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getRelayForLink=void 0;var _constants=require("./constants.js");var getRelayForLink=exports.getRelayForLink=function getRelayForLink(URLObject){return _constants.APPLE_SERVICES.find(function(urlDetails){return urlDetails.origin?urlDetails.origin===URLObject.origin:urlDetails.protocol===URLObject.protocol})}},{"./constants.js":141}],144:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"accessoriesFilter",{enumerable:true,get:function get(){return _accessoriesFilter.accessoriesFilter}});Object.defineProperty(exports,"begin",{enumerable:true,get:function get(){return _begin.begin}});Object.defineProperty(exports,"exit",{enumerable:true,get:function get(){return _exit.exit}});Object.defineProperty(exports,"pagination",{enumerable:true,get:function get(){return _pagination.pagination}});Object.defineProperty(exports,"perform",{enumerable:true,get:function get(){return _perform.perform}});Object.defineProperty(exports,"resultClick",{enumerable:true,get:function get(){return _resultClick.resultClick}});Object.defineProperty(exports,"serpPageLoad",{enumerable:true,get:function get(){return _serpPageLoad.serpPageLoad}});var _begin=require("./begin.js");var _perform=require("./perform.js");var _serpPageLoad=require("./serpPageLoad.js");var _pagination=require("./pagination.js");var _resultClick=require("./resultClick.js");var _exit=require("./exit.js");var _accessoriesFilter=require("./accessoriesFilter.js")},{"./accessoriesFilter.js":139,"./begin.js":140,"./exit.js":142,"./pagination.js":145,"./perform.js":146,"./resultClick.js":147,"./serpPageLoad.js":148}],145:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pagination=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var DEFAULT_ACTION="click";var pagination=exports.pagination=function pagination(){var _ref2;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},currentPage=_ref.currentPage,nextPage=_ref.nextPage,_ref$action=_ref.action,action=_ref$action===void 0?DEFAULT_ACTION:_ref$action;return _ref2={},_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_2,"".concat((0,_analyticsUtils.toStrTrim)(action)," - page ").concat((0,_analyticsUtils.toStrTrim)(currentPage))),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.PROP_3,"".concat((0,_analyticsUtils.toStrTrim)(action)," - page ").concat((0,_analyticsUtils.toStrTrim)(nextPage))),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVAR_15,"search (search)"),_defineProperty(_ref2,_analyticsOmnitureConstants.VARS.EVENTS,new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.SEARCH),new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.PAGINATION))),_ref2}},{"./constants.js":141,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],146:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.perform=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _typeToEvents=require("./typeToEvents.js");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var BLANK="___blank___";var TYPED="typed";var NO_KEYWORD="no keyword";var SEGGESTIONS="suggestions";var SEARCH_TYPES=["quicklinks",SEGGESTIONS,"defaultlinks"];var perform=exports.perform=function perform(){var _objectSpread2;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},keyword=_ref.keyword,method=_ref.method,position=_ref.position,results=_ref.results,source=_ref.source,suggestedValue=_ref.suggestedValue,type=_ref.type;var keywordLowerCase=(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase();var keywordForEvar23=keywordLowerCase===NO_KEYWORD?"":keywordLowerCase;var suggestedValueLowerCase=(0,_analyticsUtils.toStrTrim)(suggestedValue).toLowerCase();var events=(0,_typeToEvents.typeToEvents)(type);var searchMethod=type===SEGGESTIONS?"suggested":method;var evar23=typeof position!=="undefined"?_defineProperty({},_analyticsOmnitureConstants.VARS.EVAR_23,[keywordForEvar23,suggestedValueLowerCase,searchMethod,results,position].map(_analyticsUtils.toStrTrim).join("|")):{};return _objectSpread(_objectSpread({},evar23),{},(_objectSpread2={},_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.PROP_7,SEARCH_TYPES.includes(type)?suggestedValueLowerCase:keywordLowerCase||BLANK),_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVAR_2,"D=c7"),_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVAR_15,"".concat((0,_analyticsUtils.toStrTrim)(source)," (").concat(type===SEGGESTIONS?TYPED:(0,_analyticsUtils.toStrTrim)(method),")")),_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVENTS,events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.SEARCH))),_objectSpread2))}},{"./constants.js":141,"./typeToEvents.js":149,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],147:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.resultClick=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsRelay=require("@apple/analytics-relay");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");var _getRelayForLink=require("./getRelayForLink.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var RELAY_ID_DEFAULT="aos_search_result";var makeEvents=function makeEvents(_ref){var accessoriesLink=_ref.accessoriesLink,storeLink=_ref.storeLink,relay=_ref.relay,results=_ref.results,isComplete=_ref.isComplete;var events=new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(isComplete?_constants.EVENTS.COMPLETE:_constants.EVENTS.SEARCH));if(results===0){events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.NO_RESULTS_CLICK))}if(accessoriesLink){events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.ACCESSORIES_LINK))}if(storeLink){events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.STORE_LINK))}if(relay){events.merge(relay.events)}return events};var relayEvent=function relayEvent(_ref2){var URLObject=_ref2.URLObject,serviceLink=_ref2.serviceLink,relayId=_ref2.relayId;var eVar17;var events=new _analyticsOmnitureCollection.OmnitureCollection;if(URLObject){var relayDetails=(0,_getRelayForLink.getRelayForLink)(URLObject);if(relayDetails){eVar17=(0,_analyticsRelay.getOne)(relayDetails.token)||RELAY_ID_DEFAULT;events.add(new _analyticsOmnitureCollection.OmnitureEvent(relayDetails.event))}}if(!eVar17){eVar17=serviceLink?relayId||RELAY_ID_DEFAULT:""}return{eVar17:eVar17,events:events}};var join=function join(arr){return arr.map(_analyticsUtils.toStrTrim).join("|")};var resultClick=exports.resultClick=function resultClick(){var _beacon;var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},accessoriesLink=_ref3.accessoriesLink,storeLink=_ref3.storeLink,serviceLink=_ref3.serviceLink,bannerLink=_ref3.bannerLink,keyword=_ref3.keyword,intent=_ref3.intent,position=_ref3.position,relayId=_ref3.relayId,region=_ref3.region,URLObject=_ref3.URLObject,results=_ref3.results,currentPage=_ref3.currentPage;var keywordLowerCase=(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase();var isNullSearch=results===0;var isComplete=serviceLink||!isNullSearch;var relay=relayEvent({URLObject:URLObject,serviceLink:serviceLink,relayId:relayId});var events=makeEvents({accessoriesLink:accessoriesLink,storeLink:storeLink,relay:relay,results:results,isComplete:isComplete});var beacon=(_beacon={},_defineProperty(_beacon,_analyticsOmnitureConstants.VARS.PROP_7,keywordLowerCase),_defineProperty(_beacon,_analyticsOmnitureConstants.VARS.EVAR_2,"D=c7"),_defineProperty(_beacon,_analyticsOmnitureConstants.VARS.EVENTS,events),_beacon);if(relay.eVar17){beacon[_analyticsOmnitureConstants.VARS.EVAR_17]=relay.eVar17}if(!bannerLink&&isComplete){beacon[_analyticsOmnitureConstants.VARS.PROP_29]=join([keywordLowerCase,intent,results,currentPage,position])}if(isNullSearch){beacon[_analyticsOmnitureConstants.VARS.PROP_30]=join([keywordLowerCase,intent,results,region,position])}if(isNullSearch&&!serviceLink){beacon[_analyticsOmnitureConstants.VARS.EVAR_15]="null (clicked)"}return beacon}},{"./constants.js":141,"./getRelayForLink.js":143,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-relay":135,"@apple/analytics-utils":190}],148:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.serpPageLoad=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var _analyticsUtils=require("@apple/analytics-utils");var _constants=require("./constants.js");function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var RESULTS_DEFAULT="0";var serpPageLoad=exports.serpPageLoad=function serpPageLoad(){var _commonVars,_objectSpread2,_objectSpread3;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},directLanding=_ref.directLanding,keyword=_ref.keyword,intent=_ref.intent,results=_ref.results,channelPrefix=_ref.channelPrefix,curatedKit=_ref.curatedKit;var events=new _analyticsOmnitureCollection.OmnitureCollection(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.SEARCH));if(!results){events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.NO_RESULTS))}if(curatedKit){events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.CURATED))}var channel="".concat((0,_analyticsUtils.toStrTrim)(channelPrefix),":search");var commonVars=(_commonVars={},_defineProperty(_commonVars,_analyticsOmnitureConstants.VARS.PAGE_NAME,"".concat(channel,":").concat((0,_analyticsUtils.toStrTrim)(intent))),_defineProperty(_commonVars,_analyticsOmnitureConstants.VARS.PROP_7,(0,_analyticsUtils.toStrTrim)(keyword).toLowerCase()),_defineProperty(_commonVars,_analyticsOmnitureConstants.VARS.PROP_21,(0,_analyticsUtils.toStrTrim)(results)||RESULTS_DEFAULT),_commonVars);return directLanding?_objectSpread(_objectSpread({},commonVars),{},(_objectSpread2={},_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVAR_2,"D=c7"),_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVAR_15,"external (direct)|".concat((0,_analyticsUtils.toStrTrim)(intent))),_defineProperty(_objectSpread2,_analyticsOmnitureConstants.VARS.EVENTS,events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.SERP_DIRECT))),_objectSpread2)):_objectSpread(_objectSpread({},commonVars),{},(_objectSpread3={},_defineProperty(_objectSpread3,_analyticsOmnitureConstants.VARS.EVAR_15,"|".concat((0,_analyticsUtils.toStrTrim)(intent))),_defineProperty(_objectSpread3,_analyticsOmnitureConstants.VARS.EVENTS,events),_objectSpread3))}},{"./constants.js":141,"@apple/analytics-omniture-collection":105,"@apple/analytics-omniture-constants":115,"@apple/analytics-utils":190}],149:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.typeToEvents=void 0;var _analyticsOmnitureCollection=require("@apple/analytics-omniture-collection");var _constants=require("./constants.js");var typeToEvents=exports.typeToEvents=function typeToEvents(type){var events=new _analyticsOmnitureCollection.OmnitureCollection;switch(type){case"quicklinks":events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.COMPLETE));events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.QUICK_LINK));break;case"suggestions":events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.SUGGESTED));break;case"defaultlinks":events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.COMPLETE));events.add(new _analyticsOmnitureCollection.OmnitureEvent(_constants.EVENTS.DEFAULT_LINK));break;default:}return events}},{"./constants.js":141,"@apple/analytics-omniture-collection":105}],150:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatLink=void 0;var _sanitizeRegion=require("./sanitizeRegion.js");var _sanitizeLink=require("./sanitizeLink.js");var _sanitizeText=require("./sanitizeText.js");var MAX_LENGTH=128;var SEPERATOR=" | ";var formatLink=exports.formatLink=function formatLink(_ref){var text=_ref.text,href=_ref.href,region=_ref.region;var sanitizedText=(0,_sanitizeText.sanitizeText)(text);var sanitizedRegion=(0,_sanitizeRegion.sanitizeRegion)(region);var limitHref=MAX_LENGTH-(sanitizedText.length+sanitizedRegion.length+2*SEPERATOR.length);var sanitizedHref=(0,_sanitizeLink.sanitizeLink)(href,limitHref);return"".concat(sanitizedText).concat(SEPERATOR).concat(sanitizedHref).concat(SEPERATOR).concat(sanitizedRegion)}},{"./sanitizeLink.js":153,"./sanitizeRegion.js":154,"./sanitizeText.js":155}],151:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"formatLink",{enumerable:true,get:function get(){return _formatLink.formatLink}});Object.defineProperty(exports,"sanitizeLink",{enumerable:true,get:function get(){return _sanitizeLink.sanitizeLink}});Object.defineProperty(exports,"sanitizeRegion",{enumerable:true,get:function get(){return _sanitizeRegion.sanitizeRegion}});var _formatLink=require("./formatLink.js");var _sanitizeRegion=require("./sanitizeRegion.js");var _sanitizeLink=require("./sanitizeLink.js")},{"./formatLink.js":150,"./sanitizeLink.js":153,"./sanitizeRegion.js":154}],152:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.removePIIData=void 0;var _index=require("../stringHelpers/index.js");var PII_REGEX=[{expression:/\/order\/detail\/.*/i,value:"/order/detail"},{expression:/\/order\/cancel\/.*/i,value:"/order/cancel"},{expression:/\/order\/guest\/.*/i,value:"/order/guest/******"},{expression:/\/order\/applynow\/ep_payments\/.*/i,value:"/order/applynow/ep_payments/******"},{expression:/\/onMyWay\/.*/i,value:"/onMyWay/******"},{expression:/\/startPickup\/.*/i,value:"/startPickup/******"},{expression:/\/[^/]+@.*/i,value:"/******"},{expression:/W[0-9-]+/,value:"WXXXXXXXX"}];var removePIIData=exports.removePIIData=function removePIIData(str){var validStr=(0,_index.toStr)(str);var regex=PII_REGEX.find(function(_ref){var expression=_ref.expression;return expression.test(validStr)});return regex?validStr.replace(regex.expression,regex.value):validStr}},{"../stringHelpers/index.js":222}],153:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sanitizeLink=void 0;var _index=require("../stringHelpers/index.js");var _index2=_interopRequireDefault(require("../pipe/index.js"));var _removePIIData=require("./removePIIData.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var sanitizeLink=exports.sanitizeLink=function sanitizeLink(str,maxlength){return(0,_index2["default"])(_index.trimAllNonPrintable,_removePIIData.removePIIData,_index.trimExtraWhiteSpaces,(0,_index.sliceTrimFactory)(maxlength))(str).toLowerCase()}},{"../pipe/index.js":213,"../stringHelpers/index.js":222,"./removePIIData.js":152}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sanitizeRegion=void 0;var _sanitizeLink=require("./sanitizeLink.js");var MAX_LENGTH=40;var sanitizeRegion=exports.sanitizeRegion=function sanitizeRegion(str){return(0,_sanitizeLink.sanitizeLink)(str,MAX_LENGTH)}},{"./sanitizeLink.js":153}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sanitizeText=void 0;var _sanitizeLink=require("./sanitizeLink.js");var MAX_LENGTH=50;var sanitizeText=exports.sanitizeText=function sanitizeText(str){return(0,_sanitizeLink.sanitizeLink)(str,MAX_LENGTH)}},{"./sanitizeLink.js":153}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../pipe/index.js"));var _index2=require("../cookie/index.js");var _getEnvCookieName=_interopRequireDefault(require("./getEnvCookieName.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=(0,_index["default"])(_getEnvCookieName["default"],_index2.get);var _default=exports["default"]=get},{"../cookie/index.js":175,"../pipe/index.js":213,"./getEnvCookieName.js":157}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var getEnvCookieName=function getEnvCookieName(){var cookieName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";if(!cookieName){return""}var _window=window,cookieMap=_window.cookieMap;if(cookieMap&&_typeof(cookieMap)==="object"){return cookieMap[cookieName]||cookieName}return cookieName};var _default=exports["default"]=getEnvCookieName},{}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":156,"./set.js":159}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../cookie/index.js");var _getEnvCookieName=_interopRequireDefault(require("./getEnvCookieName.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var set=function set(key,value){var opts=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return(0,_index.set)((0,_getEnvCookieName["default"])(key),value,opts)};var _default=exports["default"]=set},{"../cookie/index.js":175,"./getEnvCookieName.js":157}],160:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../pipe/index.js"));var _index2=require("../asCookie/index.js");var _index3=require("../jsonEncoder/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=(0,_index["default"])(_index2.get,_index3.decode);var _default=exports["default"]=get},{"../asCookie/index.js":158,"../jsonEncoder/index.js":193,"../pipe/index.js":213}],161:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":160,"./set.js":162}],162:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../asCookie/index.js");var _index2=require("../jsonEncoder/index.js");var set=function set(key,value,opts){return(0,_index.set)(key,(0,_index2.encode)(value),opts)};var _default=exports["default"]=set},{"../asCookie/index.js":158,"../jsonEncoder/index.js":193}],163:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _getRawNumberFromString=_interopRequireDefault(require("./getRawNumberFromString.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var formatPrice=function formatPrice(price){var defaultPrice=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"0.00";var priceAsNumber=(0,_getRawNumberFromString["default"])(price);if(priceAsNumber===null){return defaultPrice}return priceAsNumber.toFixed(2)};var _default=exports["default"]=formatPrice},{"./getRawNumberFromString.js":165}],164:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _guessPartNumber=_interopRequireDefault(require("./guessPartNumber.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DEFAULT_PART_NUMBER=null;var getBasePartNumberInfo=function getBasePartNumberInfo(_ref){var element=_ref.element,parent=_ref.parent;if(element){var _ref2=element.dataset||{},basePartNumber=_ref2.basePartNumber;if(basePartNumber)return basePartNumber}if(parent){var _ref3=parent.dataset||{},_basePartNumber=_ref3.basePartNumber;if(_basePartNumber)return _basePartNumber}return DEFAULT_PART_NUMBER};var getPartNumberInfo=function getPartNumberInfo(_ref4){var element=_ref4.element,parent=_ref4.parent;if(element){var _ref5=element.dataset||{},partNumber=_ref5.partNumber;if(partNumber)return(0,_guessPartNumber["default"])(partNumber)}if(parent){var _ref6=parent.dataset||{},_partNumber=_ref6.partNumber;if(_partNumber)return(0,_guessPartNumber["default"])(_partNumber)}return DEFAULT_PART_NUMBER};var getPartNumber=function getPartNumber(){var _ref7=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref7$element=_ref7.element,element=_ref7$element===void 0?null:_ref7$element,_ref7$parent=_ref7.parent,parent=_ref7$parent===void 0?null:_ref7$parent;var basePartNumber=getBasePartNumberInfo({element:element,parent:parent});if(basePartNumber)return basePartNumber;var partNumber=getPartNumberInfo({element:element,parent:parent});if(partNumber)return partNumber;return DEFAULT_PART_NUMBER};var _default=exports["default"]=getPartNumber},{"./guessPartNumber.js":166}],165:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var getRawNumberFromString=function getRawNumberFromString(string){if(typeof string==="number"){return string}if(!string){return null}if(typeof string!=="string"){return null}var parts=string.replace(/[^\d.,]/g,"").split(/[.,](\d{1,2})$/);var _parts=_slicedToArray(parts,2),_parts$=_parts[0],integer=_parts$===void 0?"0":_parts$,_parts$2=_parts[1],decimal=_parts$2===void 0?"00":_parts$2;var price=parseFloat(integer.replace(/[^\d/]/g,"")+"."+decimal);if(isNaN(price)){return null}return price};var _default=exports["default"]=getRawNumberFromString},{}],166:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var DEFAULT_PART_NUMBER="";var MAX_LENGTH=5;var exceptions=[/^APPLE/,/^HOMEPOD/,/^IMAC/,/^IPAD/,/^IPHONE/,/^IPOD/,/^MAC/,/^PRO/,/^W\d\d_/,/^Z/,/\+/,/GIFT_CARDS/,/^AOS/];var guessPartNumber=function guessPartNumber(sku){if(!sku||typeof sku!=="string"){return DEFAULT_PART_NUMBER}var skuUpperCase=sku.toUpperCase();if(exceptions.some(function(regexp){return regexp.test(skuUpperCase)})){return sku}return sku.substring(0,MAX_LENGTH)};var _default=exports["default"]=guessPartNumber},{}],167:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"formatPrice",{enumerable:true,get:function get(){return _formatPrice["default"]}});Object.defineProperty(exports,"getPartNumber",{enumerable:true,get:function get(){return _getPartNumber["default"]}});Object.defineProperty(exports,"getRawNumberFromString",{enumerable:true,get:function get(){return _getRawNumberFromString["default"]}});Object.defineProperty(exports,"guessPartNumber",{enumerable:true,get:function get(){return _guessPartNumber["default"]}});Object.defineProperty(exports,"isBeacon",{enumerable:true,get:function get(){return _isBeacon["default"]}});Object.defineProperty(exports,"isNotEmpty",{enumerable:true,get:function get(){return _isNotEmpty["default"]}});Object.defineProperty(exports,"isValidBeaconKey",{enumerable:true,get:function get(){return _isValidBeaconKey["default"]}});Object.defineProperty(exports,"setValue",{enumerable:true,get:function get(){return _setValue["default"]}});Object.defineProperty(exports,"toBeaconSafeVal",{enumerable:true,get:function get(){return _toBeaconSafeVal["default"]}});var _formatPrice=_interopRequireDefault(require("./formatPrice.js"));var _getRawNumberFromString=_interopRequireDefault(require("./getRawNumberFromString.js"));var _guessPartNumber=_interopRequireDefault(require("./guessPartNumber.js"));var _isBeacon=_interopRequireDefault(require("./isBeacon.js"));var _isNotEmpty=_interopRequireDefault(require("./isNotEmpty.js"));var _setValue=_interopRequireDefault(require("./setValue.js"));var _toBeaconSafeVal=_interopRequireDefault(require("./toBeaconSafeVal.js"));var _isValidBeaconKey=_interopRequireDefault(require("./isValidBeaconKey.js"));var _getPartNumber=_interopRequireDefault(require("./getPartNumber.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./formatPrice.js":163,"./getPartNumber.js":164,"./getRawNumberFromString.js":165,"./guessPartNumber.js":166,"./isBeacon.js":168,"./isNotEmpty.js":169,"./isValidBeaconKey.js":170,"./setValue.js":171,"./toBeaconSafeVal.js":172}],168:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isObject=_interopRequireDefault(require("../objectHelpers/isObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isBeacon=_isObject["default"];var _default=exports["default"]=isBeacon},{"../objectHelpers/isObject.js":203}],169:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isNotEmpty=_interopRequireDefault(require("../objectHelpers/isNotEmpty.js"));var _isBeacon=_interopRequireDefault(require("./isBeacon.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isNotEmpty=function isNotEmpty(beacon){return(0,_isBeacon["default"])(beacon)&&(0,_isNotEmpty["default"])(beacon)};var _default=exports["default"]=isNotEmpty},{"../objectHelpers/isNotEmpty.js":202,"./isBeacon.js":168}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _analyticsOmnitureConstants=require("@apple/analytics-omniture-constants");var validKeys=Object.values(_analyticsOmnitureConstants.VARS);var isValidBeaconKey=function isValidBeaconKey(key){return validKeys.includes(key)};var _default=exports["default"]=isValidBeaconKey},{"@apple/analytics-omniture-constants":115}],171:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isBeacon=_interopRequireDefault(require("./isBeacon.js"));var _toBeaconSafeVal=_interopRequireDefault(require("./toBeaconSafeVal.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var setValue=function setValue(beacon,name,value){if(!(0,_isBeacon["default"])(beacon)||!name){return beacon}var safeValue=(0,_toBeaconSafeVal["default"])(value);if(safeValue){beacon[name]=safeValue}else{delete beacon[name]}return beacon};var _default=exports["default"]=setValue},{"./isBeacon.js":168,"./toBeaconSafeVal.js":172}],172:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var toBeaconSafeVal=function toBeaconSafeVal(input){return input&&_typeof(input)!=="object"?String(input):null};var _default=exports["default"]=toBeaconSafeVal},{}],173:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var expiresToDate=function expiresToDate(expires){if(typeof expires==="number"){var date=new Date;var offset=(expires||0)*24*60*60*1e3;date.setTime(date.getTime()+offset);return date}return expires};var _default=exports["default"]=expiresToDate},{}],174:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var get=function get(key){if(key===undefined||key===null){return null}var cookies=(document.cookie||"").split(";");for(var i=0;i<cookies.length;i++){var cookie=(cookies[i]||"").trim();if(cookie.slice(0,key.length+1)==="".concat(key,"=")){return decodeURIComponent(cookie.slice(key.length+1))}}return null};var _default=exports["default"]=get},{}],175:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":174,"./set.js":176}],176:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _expiresToDate=_interopRequireDefault(require("./expiresToDate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var set=function set(key,value){var opts=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var expiresOn=(0,_expiresToDate["default"])(value===undefined||value===null?-1:opts.expires);var expires=expiresOn?"; expires="+expiresOn.toUTCString():"";var path=opts.path?"; path="+opts.path:"";var domain=opts.domain?"; domain="+opts.domain:"";var secure=opts.secure?"; secure":"";document.cookie=key+"="+encodeURIComponent(value||"")+expires+path+domain+secure};var _default=exports["default"]=set},{"./expiresToDate.js":173}],177:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../pipe/index.js"));var _index2=require("../cookie/index.js");var _index3=require("../jsonEncoder/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=(0,_index["default"])(_index2.get,_index3.decode);var _default=exports["default"]=get},{"../cookie/index.js":175,"../jsonEncoder/index.js":193,"../pipe/index.js":213}],178:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":177,"./set.js":179}],179:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../cookie/index.js");var _index2=require("../jsonEncoder/index.js");var set=function set(key,value,opts){return(0,_index.set)(key,(0,_index2.encode)(value),opts)};var _default=exports["default"]=set},{"../cookie/index.js":175,"../jsonEncoder/index.js":193}],180:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var deepClone=function deepClone(obj){if(!obj||_typeof(obj)!=="object"){return obj}if(Array.isArray(obj)){var _result=Array(obj.length);for(var i=0;i<obj.length;i++){_result[i]=deepClone(obj[i])}return _result}var result={};for(var _i=0,_Object$keys=Object.keys(obj);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];result[key]=deepClone(obj[key])}return result};var _default=exports["default"]=deepClone},{}],181:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function get(){return _deepClone["default"]}});var _deepClone=_interopRequireDefault(require("./deepClone.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./deepClone.js":180}],182:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var dispatchEventAsync=function dispatchEventAsync(target,event){if(!(target instanceof Element)||!(event instanceof Event)){return false}setTimeout(function(){target.dispatchEvent(event)},0);return true};var _default=exports["default"]=dispatchEventAsync},{}],183:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var debounce=function debounce(fn){var wait=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var timeout=null;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}clearTimeout(timeout);timeout=setTimeout(function(){timeout=null;fn.apply(void 0,args)},wait)}};var _default=exports["default"]=debounce},{}],184:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"debounce",{enumerable:true,get:function get(){return _debounce["default"]}});Object.defineProperty(exports,"isNavigationEvent",{enumerable:true,get:function get(){return _isNavigationEvent.isNavigationEvent}});var _debounce=_interopRequireDefault(require("./debounce.js"));var _isNavigationEvent=require("./isNavigationEvent.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./debounce.js":183,"./isNavigationEvent.js":185}],185:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isNavigationEvent=void 0;var isFormEvent=function isFormEvent(event){return["analytics-form-submit","submit"].includes(event.type)};var isClickEvent=function isClickEvent(event){return event.type==="click"&&event.target&&event.target.closest("a")!==null};var isNavigationEvent=exports.isNavigationEvent=function isNavigationEvent(){var event=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!event||!event.type){return false}return isFormEvent(event)||isClickEvent(event)}},{}],186:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var getOmniture=function getOmniture(){return window.s};var _default=exports["default"]=getOmniture},{}],187:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function get(){return _getOmniture["default"]}});var _getOmniture=_interopRequireDefault(require("./getOmniture.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./getOmniture.js":186}],188:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var getRandomInt=function getRandomInt(){var max=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3;return Math.floor(Math.random()*Math.floor(max))};var _default=exports["default"]=getRandomInt},{}],189:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function get(){return _getRandomInt["default"]}});var _getRandomInt=_interopRequireDefault(require("./getRandomInt.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./getRandomInt.js":188}],190:[function(require,module,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.cookieJson=exports.cookie=exports.beaconHelpers=exports.asCookieJson=exports.asCookie=exports.activityMap=void 0;Object.defineProperty(exports,"deepClone",{enumerable:true,get:function get(){return _index7["default"]}});Object.defineProperty(exports,"dispatchEventAsync",{enumerable:true,get:function get(){return _index8["default"]}});exports.eventHelpers=void 0;Object.defineProperty(exports,"getOmniture",{enumerable:true,get:function get(){return _index10["default"]}});Object.defineProperty(exports,"getRandomInt",{enumerable:true,get:function get(){return _index11["default"]}});exports.objectPath=exports.objectHelpers=exports.localStorageJson=exports.localStorage=exports.jsonEncoder=void 0;Object.defineProperty(exports,"pipe",{enumerable:true,get:function get(){return _index17["default"]}});exports.stringHelpers=exports.sessionStorageJson=exports.sessionStorage=void 0;Object.defineProperty(exports,"toStr",{enumerable:true,get:function get(){return _index20.toStr}});Object.defineProperty(exports,"toStrTrim",{enumerable:true,get:function get(){return _index20.toStrTrim}});exports.urlHelpers=void 0;var activityMap=_interopRequireWildcard(require("./activityMap/index.js"));exports.activityMap=activityMap;var asCookie=_interopRequireWildcard(require("./asCookie/index.js"));exports.asCookie=asCookie;var asCookieJson=_interopRequireWildcard(require("./asCookieJson/index.js"));exports.asCookieJson=asCookieJson;var beaconHelpers=_interopRequireWildcard(require("./beaconHelpers/index.js"));exports.beaconHelpers=beaconHelpers;var cookie=_interopRequireWildcard(require("./cookie/index.js"));exports.cookie=cookie;var cookieJson=_interopRequireWildcard(require("./cookieJson/index.js"));exports.cookieJson=cookieJson;var _index7=_interopRequireDefault(require("./deepClone/index.js"));var _index8=_interopRequireDefault(require("./dispatchEventAsync/index.js"));var eventHelpers=_interopRequireWildcard(require("./eventHelpers/index.js"));exports.eventHelpers=eventHelpers;var _index10=_interopRequireDefault(require("./getOmniture/index.js"));var _index11=_interopRequireDefault(require("./getRandomInt/index.js"));var jsonEncoder=_interopRequireWildcard(require("./jsonEncoder/index.js"));exports.jsonEncoder=jsonEncoder;var localStorage=_interopRequireWildcard(require("./localStorage/index.js"));exports.localStorage=localStorage;var localStorageJson=_interopRequireWildcard(require("./localStorageJson/index.js"));exports.localStorageJson=localStorageJson;var objectPath=_interopRequireWildcard(require("./objectPath/index.js"));exports.objectPath=objectPath;var objectHelpers=_interopRequireWildcard(require("./objectHelpers/index.js"));exports.objectHelpers=objectHelpers;var _index17=_interopRequireDefault(require("./pipe/index.js"));var sessionStorage=_interopRequireWildcard(require("./sessionStorage/index.js"));exports.sessionStorage=sessionStorage;var sessionStorageJson=_interopRequireWildcard(require("./sessionStorageJson/index.js"));exports.sessionStorageJson=sessionStorageJson;var _index20=_interopRequireWildcard(require("./stringHelpers/index.js"));var stringHelpers=_index20;exports.stringHelpers=_index20;var urlHelpers=_interopRequireWildcard(require("./urlHelpers/index.js"));exports.urlHelpers=urlHelpers;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n["default"]=e,t&&t.set(e,n),n}},{"./activityMap/index.js":151,"./asCookie/index.js":158,"./asCookieJson/index.js":161,"./beaconHelpers/index.js":167,"./cookie/index.js":175,"./cookieJson/index.js":178,"./deepClone/index.js":181,"./dispatchEventAsync/index.js":182,"./eventHelpers/index.js":184,"./getOmniture/index.js":187,"./getRandomInt/index.js":189,"./jsonEncoder/index.js":193,"./localStorage/index.js":195,"./localStorageJson/index.js":199,"./objectHelpers/index.js":201,"./objectPath/index.js":209,"./pipe/index.js":213,"./sessionStorage/index.js":216,"./sessionStorageJson/index.js":220,"./stringHelpers/index.js":222,"./urlHelpers/index.js":233}],191:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var decode=function decode(data){if(!data){return null}try{return JSON.parse(data)}catch(e){return null}};var _default=exports["default"]=decode},{}],192:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var encode=function encode(data){if(!data){return null}try{return JSON.stringify(data)}catch(e){return null}};var _default=exports["default"]=encode},{}],193:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"decode",{enumerable:true,get:function get(){return _decode["default"]}});Object.defineProperty(exports,"encode",{enumerable:true,get:function get(){return _encode["default"]}});var _decode=_interopRequireDefault(require("./decode.js"));var _encode=_interopRequireDefault(require("./encode.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./decode.js":191,"./encode.js":192}],194:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var get=function get(key){try{return window.localStorage.getItem(key)}catch(e){return""}};var _default=exports["default"]=get},{}],195:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":194,"./remove.js":196,"./set.js":197}],196:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var remove=function remove(key){try{window.localStorage.removeItem(key);return true}catch(e){return false}};var _default=exports["default"]=remove},{}],197:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var set=function set(key,value){try{window.localStorage.setItem(key,value||"");return true}catch(e){return false}};var _default=exports["default"]=set},{}],198:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../pipe/index.js"));var _index2=require("../localStorage/index.js");var _index3=require("../jsonEncoder/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=(0,_index["default"])(_index2.get,_index3.decode);var _default=exports["default"]=get},{"../jsonEncoder/index.js":193,"../localStorage/index.js":195,"../pipe/index.js":213}],199:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _index.remove}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _index=require("../localStorage/index.js");var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"../localStorage/index.js":195,"./get.js":198,"./set.js":200}],200:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../localStorage/index.js");var _index2=require("../jsonEncoder/index.js");var set=function set(key,value){return(0,_index.set)(key,(0,_index2.encode)(value))};var _default=exports["default"]=set},{"../jsonEncoder/index.js":193,"../localStorage/index.js":195}],201:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"isNotEmpty",{enumerable:true,get:function get(){return _isNotEmpty["default"]}});Object.defineProperty(exports,"isObject",{enumerable:true,get:function get(){return _isObject["default"]}});Object.defineProperty(exports,"isValidObject",{enumerable:true,get:function get(){return _isValidObject["default"]}});var _isObject=_interopRequireDefault(require("./isObject.js"));var _isNotEmpty=_interopRequireDefault(require("./isNotEmpty.js"));var _isValidObject=_interopRequireDefault(require("./isValidObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./isNotEmpty.js":202,"./isObject.js":203,"./isValidObject.js":204}],202:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isObject=_interopRequireDefault(require("./isObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isNotEmpty=function isNotEmpty(obj){return(0,_isObject["default"])(obj)&&Object.keys(obj).length?true:false};var _default=exports["default"]=isNotEmpty},{"./isObject.js":203}],203:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var isObject=function isObject(obj){return obj&&_typeof(obj)==="object"&&!Array.isArray(obj)?true:false};var _default=exports["default"]=isObject},{}],204:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isObject=_interopRequireDefault(require("./isObject.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isValidObject=function isValidObject(obj,mandatoryProps){return(0,_isObject["default"])(obj)&&Array.isArray(mandatoryProps)&&mandatoryProps.every(function(prop){return obj[prop]})};var _default=exports["default"]=isValidObject},{"./isObject.js":203}],205:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var config={separator:"."};var _default=exports["default"]=config},{}],206:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../stringHelpers/index.js");var _config=_interopRequireDefault(require("./config.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var formatPath=function formatPath(){for(var _len=arguments.length,paths=new Array(_len),_key=0;_key<_len;_key++){paths[_key]=arguments[_key]}return paths.map(function(path){return Array.isArray(path)?formatPath.apply(void 0,_toConsumableArray(path)):(0,_index.toStr)(path).split(_config["default"].separator)}).reduce(function(acc,pathArray){return acc.concat(pathArray)},[])};var _default=exports["default"]=formatPath},{"../stringHelpers/index.js":222,"./config.js":205}],207:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var get=function get(obj,path){return path&&path.length?path.reduce(function(acc,key){return acc&&_typeof(acc)==="object"?acc[key]:null},obj):obj};var _default=exports["default"]=get},{}],208:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _get=_interopRequireDefault(require("./get.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getFactory=function getFactory(path){return function(obj){return(0,_get["default"])(obj,path)}};var _default=exports["default"]=getFactory},{"./get.js":207}],209:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"formatPath",{enumerable:true,get:function get(){return _formatPath["default"]}});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"getFactory",{enumerable:true,get:function get(){return _getFactory["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});Object.defineProperty(exports,"setFactory",{enumerable:true,get:function get(){return _setFactory["default"]}});var _formatPath=_interopRequireDefault(require("./formatPath.js"));var _get=_interopRequireDefault(require("./get.js"));var _getFactory=_interopRequireDefault(require("./getFactory.js"));var _set=_interopRequireDefault(require("./set.js"));var _setFactory=_interopRequireDefault(require("./setFactory.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./formatPath.js":206,"./get.js":207,"./getFactory.js":208,"./remove.js":210,"./set.js":211,"./setFactory.js":212}],210:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var remove=function remove(obj,path){return path&&path.length&&_typeof(obj)==="object"?removeReversedPath(obj,_toConsumableArray(path).reverse()):obj};var removeReversedPath=function removeReversedPath(obj,path){var key=path.pop();var result=Array.isArray(obj)?_toConsumableArray(obj):_objectSpread({},obj);if(!path.length){if(Array.isArray(result)){result.splice(Number(key)||result.length,1)}else{delete result[key]}return result}if(_typeof(result[key])==="object"){result[key]=removeReversedPath(result[key],path)}return result};var _default=exports["default"]=remove},{}],211:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var set=function set(obj,path,value){return path&&path.length?setReversedPath(obj,_toConsumableArray(path).reverse(),value):obj};var setReversedPath=function setReversedPath(obj,path,value){if(!path.length){return value}if(_typeof(obj)==="object"){var key=path.pop();var result=Array.isArray(obj)?_toConsumableArray(obj):_objectSpread({},obj);result[key]=setReversedPath(result[key],path,value);return result}return setReversedPath({},path,value)};var _default=exports["default"]=set},{}],212:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var setFactory=function setFactory(path){return function(obj,value){return(0,_set["default"])(obj,path,value)}};var _default=exports["default"]=setFactory},{"./set.js":211}],213:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function get(){return _pipe["default"]}});var _pipe=_interopRequireDefault(require("./pipe.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./pipe.js":214}],214:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var pipe=function pipe(){for(var _len=arguments.length,fns=new Array(_len),_key=0;_key<_len;_key++){fns[_key]=arguments[_key]}return function(x){return fns.reduce(function(v,f){return f(v)},x)}};var _default=exports["default"]=pipe},{}],215:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var get=function get(key){try{return window.sessionStorage.getItem(key)}catch(e){return""}};var _default=exports["default"]=get},{}],216:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _remove["default"]}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));var _remove=_interopRequireDefault(require("./remove.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./get.js":215,"./remove.js":217,"./set.js":218}],217:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var remove=function remove(key){try{window.sessionStorage.removeItem(key);return true}catch(e){return false}};var _default=exports["default"]=remove},{}],218:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var set=function set(key,value){try{window.sessionStorage.setItem(key,value||"");return true}catch(e){return false}};var _default=exports["default"]=set},{}],219:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../pipe/index.js"));var _index2=require("../sessionStorage/index.js");var _index3=require("../jsonEncoder/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var get=(0,_index["default"])(_index2.get,_index3.decode);var _default=exports["default"]=get},{"../jsonEncoder/index.js":193,"../pipe/index.js":213,"../sessionStorage/index.js":216}],220:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"get",{enumerable:true,get:function get(){return _get["default"]}});Object.defineProperty(exports,"remove",{enumerable:true,get:function get(){return _index.remove}});Object.defineProperty(exports,"set",{enumerable:true,get:function get(){return _set["default"]}});var _index=require("../sessionStorage/index.js");var _get=_interopRequireDefault(require("./get.js"));var _set=_interopRequireDefault(require("./set.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"../sessionStorage/index.js":216,"./get.js":219,"./set.js":221}],221:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=require("../sessionStorage/index.js");var _index2=require("../jsonEncoder/index.js");var set=function set(key,value){return(0,_index.set)(key,(0,_index2.encode)(value))};var _default=exports["default"]=set},{"../jsonEncoder/index.js":193,"../sessionStorage/index.js":216}],222:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"sliceTrim",{enumerable:true,get:function get(){return _sliceTrim.sliceTrim}});Object.defineProperty(exports,"sliceTrimFactory",{enumerable:true,get:function get(){return _sliceTrimFactory.sliceTrimFactory}});Object.defineProperty(exports,"toStr",{enumerable:true,get:function get(){return _toStr.toStr}});Object.defineProperty(exports,"toStrTrim",{enumerable:true,get:function get(){return _toStrTrim.toStrTrim}});Object.defineProperty(exports,"trimAllNonPrintable",{enumerable:true,get:function get(){return _trimAllNonPrintable.trimAllNonPrintable}});Object.defineProperty(exports,"trimExtraWhiteSpaces",{enumerable:true,get:function get(){return _trimExtraWhiteSpaces.trimExtraWhiteSpaces}});var _toStrTrim=require("./toStrTrim.js");var _toStr=require("./toStr.js");var _trimExtraWhiteSpaces=require("./trimExtraWhiteSpaces.js");var _trimAllNonPrintable=require("./trimAllNonPrintable.js");var _sliceTrim=require("./sliceTrim.js");var _sliceTrimFactory=require("./sliceTrimFactory.js")},{"./sliceTrim.js":223,"./sliceTrimFactory.js":224,"./toStr.js":225,"./toStrTrim.js":226,"./trimAllNonPrintable.js":227,"./trimExtraWhiteSpaces.js":228}],223:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sliceTrim=void 0;var _toStr=require("./toStr.js");var sliceTrim=exports.sliceTrim=function sliceTrim(str,maxLength){return(0,_toStr.toStr)(str).slice(0,maxLength).trim()}},{"./toStr.js":225}],224:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sliceTrimFactory=void 0;var _sliceTrim=require("./sliceTrim.js");var sliceTrimFactory=exports.sliceTrimFactory=function sliceTrimFactory(maxlength){return function(str){return(0,_sliceTrim.sliceTrim)(str,maxlength)}}},{"./sliceTrim.js":223}],225:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toStr=void 0;var toStr=exports.toStr=function toStr(){var val=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return val||val===false||val===0?String(val):""}},{}],226:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toStrTrim=void 0;var _toStr=require("./toStr.js");var toStrTrim=exports.toStrTrim=function toStrTrim(input){return(0,_toStr.toStr)(input).trim()}},{"./toStr.js":225}],227:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.trimAllNonPrintable=void 0;var _toStr=require("./toStr.js");var trimAllNonPrintable=exports.trimAllNonPrintable=function trimAllNonPrintable(str){return(0,_toStr.toStr)(str).replace(/[^ -~]+/g,"")}},{"./toStr.js":225}],228:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.trimExtraWhiteSpaces=void 0;var _toStr=require("./toStr.js");var trimExtraWhiteSpaces=exports.trimExtraWhiteSpaces=function trimExtraWhiteSpaces(str){return(0,_toStr.toStr)(str).replace(/\s+/g," ")}},{"./toStr.js":225}],229:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var classListContains=function classListContains(element){for(var _len=arguments.length,classNames=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){classNames[_key-1]=arguments[_key]}return element instanceof HTMLElement?classNames.some(function(className){return element.classList.contains(className)}):false};var _default=exports["default"]=classListContains},{}],230:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var getOrigin=function getOrigin(element){if(!element){return""}return"origin"in element?element.origin:"".concat(element.protocol,"//").concat(element.hostname)};var _default=exports["default"]=getOrigin},{}],231:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getQueryParam=void 0;var getQueryParam=exports.getQueryParam=function getQueryParam(param){return window.URL?new URL(window.location).searchParams.get(param):null}},{}],232:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.hasPropertyValue=void 0;var hasPropertyValue=exports.hasPropertyValue=function hasPropertyValue(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},element=_ref.element,property=_ref.property,_ref$values=_ref.values,values=_ref$values===void 0?[]:_ref$values;if(!element){return false}return values.includes(element[property])}},{}],233:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"classListContains",{enumerable:true,get:function get(){return _classListContains["default"]}});Object.defineProperty(exports,"getOrigin",{enumerable:true,get:function get(){return _getOrigin["default"]}});Object.defineProperty(exports,"getQueryParam",{enumerable:true,get:function get(){return _getQueryParam.getQueryParam}});Object.defineProperty(exports,"isAccessoriesSERPLink",{enumerable:true,get:function get(){return _isAccessoriesSERPLink.isAccessoriesSERPLink}});Object.defineProperty(exports,"isCrossOriginLink",{enumerable:true,get:function get(){return _isCrossOriginLink["default"]}});Object.defineProperty(exports,"isExitLink",{enumerable:true,get:function get(){return _isExitLink["default"]}});Object.defineProperty(exports,"isExternalLink",{enumerable:true,get:function get(){return _isExternalLink["default"]}});Object.defineProperty(exports,"isGlobalNavLink",{enumerable:true,get:function get(){return _isGlobalNavLink["default"]}});Object.defineProperty(exports,"isImmediateLink",{enumerable:true,get:function get(){return _isImmediateLink["default"]}});Object.defineProperty(exports,"isMarcomUrl",{enumerable:true,get:function get(){return _isMarcomUrl["default"]}});Object.defineProperty(exports,"isSearchLink",{enumerable:true,get:function get(){return _isSearchLink["default"]}});Object.defineProperty(exports,"isServiceSERPLink",{enumerable:true,get:function get(){return _isServiceSERPLink.isServiceSERPLink}});Object.defineProperty(exports,"isSignInLink",{enumerable:true,get:function get(){return _isSignInLink["default"]}});Object.defineProperty(exports,"isSignOutLink",{enumerable:true,get:function get(){return _isSignOutLink["default"]}});Object.defineProperty(exports,"isStoreSERPLink",{enumerable:true,get:function get(){return _isStoreSERPLink.isStoreSERPLink}});Object.defineProperty(exports,"isTargetingOtherWindow",{enumerable:true,get:function get(){return _isTargetingOtherWindow["default"]}});Object.defineProperty(exports,"isValidLink",{enumerable:true,get:function get(){return _isValidLink["default"]}});Object.defineProperty(exports,"redirectsToSignInLink",{enumerable:true,get:function get(){return _redirectsToSignInLink["default"]}});Object.defineProperty(exports,"resolvesToSearchPage",{enumerable:true,get:function get(){return _resolvesToSearchPage["default"]}});Object.defineProperty(exports,"sanitizeUrl",{enumerable:true,get:function get(){return _sanitizeUrl.sanitizeUrl}});var _classListContains=_interopRequireDefault(require("./classListContains.js"));var _getOrigin=_interopRequireDefault(require("./getOrigin.js"));var _getQueryParam=require("./getQueryParam.js");var _isCrossOriginLink=_interopRequireDefault(require("./isCrossOriginLink.js"));var _isExitLink=_interopRequireDefault(require("./isExitLink.js"));var _isExternalLink=_interopRequireDefault(require("./isExternalLink.js"));var _isGlobalNavLink=_interopRequireDefault(require("./isGlobalNavLink.js"));var _isImmediateLink=_interopRequireDefault(require("./isImmediateLink.js"));var _isMarcomUrl=_interopRequireDefault(require("./isMarcomUrl.js"));var _isSearchLink=_interopRequireDefault(require("./isSearchLink.js"));var _isSignInLink=_interopRequireDefault(require("./isSignInLink.js"));var _isSignOutLink=_interopRequireDefault(require("./isSignOutLink.js"));var _isTargetingOtherWindow=_interopRequireDefault(require("./isTargetingOtherWindow.js"));var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));var _redirectsToSignInLink=_interopRequireDefault(require("./redirectsToSignInLink.js"));var _resolvesToSearchPage=_interopRequireDefault(require("./resolvesToSearchPage.js"));var _isAccessoriesSERPLink=require("./isAccessoriesSERPLink.js");var _isStoreSERPLink=require("./isStoreSERPLink.js");var _isServiceSERPLink=require("./isServiceSERPLink.js");var _sanitizeUrl=require("./sanitizeUrl.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./classListContains.js":229,"./getOrigin.js":230,"./getQueryParam.js":231,"./isAccessoriesSERPLink.js":234,"./isCrossOriginLink.js":235,"./isExitLink.js":236,"./isExternalLink.js":237,"./isGlobalNavLink.js":238,"./isImmediateLink.js":239,"./isMarcomUrl.js":240,"./isSearchLink.js":241,"./isServiceSERPLink.js":242,"./isSignInLink.js":243,"./isSignOutLink.js":244,"./isStoreSERPLink.js":245,"./isTargetingOtherWindow.js":246,"./isValidLink.js":247,"./redirectsToSignInLink.js":248,"./resolvesToSearchPage.js":249,"./sanitizeUrl.js":250}],234:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isAccessoriesSERPLink=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isAccessoriesSERPLink=exports.isAccessoriesSERPLink=function isAccessoriesSERPLink(element){return(0,_classListContains["default"])(element,"as-producttile-tilelink","pd-onebox-block")}},{"./classListContains.js":229}],235:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _getOrigin=_interopRequireDefault(require("./getOrigin.js"));var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isCrossOriginLink=function isCrossOriginLink(element){return(0,_isValidLink["default"])(element)&&(0,_getOrigin["default"])(element)!==(0,_getOrigin["default"])(window.document.location)};var _default=exports["default"]=isCrossOriginLink},{"./getOrigin.js":230,"./isValidLink.js":247}],236:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isExitLink=function isExitLink(element){return(0,_isValidLink["default"])(element)&&element.dataset.analyticsExitLink!==undefined};var _default=exports["default"]=isExitLink},{"./isValidLink.js":247}],237:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _index=_interopRequireDefault(require("../getOmniture/index.js"));var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isExternalLink=function isExternalLink(element){return(0,_isValidLink["default"])(element)&&element.hostname?(((0,_index["default"])()||{}).linkInternalFilters||"").split(",").every(function(domain){return element.hostname.indexOf(domain.trim())<0}):false};var _default=exports["default"]=isExternalLink},{"../getOmniture/index.js":187,"./isValidLink.js":247}],238:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isGlobalNavLink=function isGlobalNavLink(element){return(0,_classListContains["default"])(element,"ac-gn-link")};var _default=exports["default"]=isGlobalNavLink},{"./classListContains.js":229}],239:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isImmediateLink=function isImmediateLink(element){return(0,_classListContains["default"])(element,"as-analytics-sendimmediately")};var _default=exports["default"]=isImmediateLink},{"./classListContains.js":229}],240:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var isMarcomUrl=function isMarcomUrl(url){return url?url.indexOf("shop")<0&&url.indexOf("search")<0:false};var _default=exports["default"]=isMarcomUrl},{}],241:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isSearchLink=function isSearchLink(element){return(0,_classListContains["default"])(element,"ac-gn-searchresults-link")};var _default=exports["default"]=isSearchLink},{"./classListContains.js":229}],242:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isServiceSERPLink=void 0;var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));var _hasPropertyValue=require("./hasPropertyValue.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PROTOCOLS=["applenews:","itms-apps:"];var HOSTNAMES=["apps.apple.com","news.apple.com","music.apple.com","wallet.apple.com","tv.apple.com","books.apple.com"];var isServiceSERPLink=exports.isServiceSERPLink=function isServiceSERPLink(element){return(0,_isValidLink["default"])(element)&&((0,_hasPropertyValue.hasPropertyValue)({element:element,property:"protocol",values:PROTOCOLS})||(0,_hasPropertyValue.hasPropertyValue)({element:element,property:"hostname",values:HOSTNAMES}))}},{"./hasPropertyValue.js":232,"./isValidLink.js":247}],243:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isSignInLink=function isSignInLink(element){return(0,_classListContains["default"])(element,"ac-gn-bagview-nav-link-signIn")};var _default=exports["default"]=isSignInLink},{"./classListContains.js":229}],244:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isSignOutLink=function isSignOutLink(element){return(0,_classListContains["default"])(element,"ac-gn-bagview-nav-link-signOut")};var _default=exports["default"]=isSignOutLink},{"./classListContains.js":229}],245:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isStoreSERPLink=void 0;var _isValidLink=_interopRequireDefault(require("./isValidLink.js"));var _hasPropertyValue=require("./hasPropertyValue.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isStoreSERPLink=exports.isStoreSERPLink=function isStoreSERPLink(element){return(0,_isValidLink["default"])(element)&&(0,_hasPropertyValue.hasPropertyValue)({element:element,property:"hostname",values:["apps.apple.com"]})}},{"./hasPropertyValue.js":232,"./isValidLink.js":247}],246:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var isTargetingOtherWindow=function isTargetingOtherWindow(element,event){if(!element||!event){return false}var elementTarget=(element.target||"").toLowerCase();return event.metaKey||event.ctrlKey||event.shiftKey||["","_self","_parent","_top"].every(function(target){return target!==elementTarget})||window.name.length>0&&elementTarget.length>0&&elementTarget!==window.name};var _default=exports["default"]=isTargetingOtherWindow},{}],247:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var isValidLink=function isValidLink(element){if(!element){return false}if(element.tagName!=="A"){return false}var href=(element.getAttribute("href")||"").trim();return href.length>0&&href.indexOf("#")!==0&&href.indexOf("about:")!==0&&href.indexOf("javascript:")!==0&&href.indexOf("mailto:")!==0&&href.indexOf("tel:")!==0&&!element.dataset.analyticsIntrapageLink};var _default=exports["default"]=isValidLink},{}],248:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classListContains=_interopRequireDefault(require("./classListContains.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var redirectsToSignInLink=function redirectsToSignInLink(element){return(0,_classListContains["default"])(element,"ac-gn-bagview-nav-link-favorites","ac-gn-bagview-nav-link-orders","ac-gn-bagview-nav-link-account","ac-gn-bagview-nav-link-signIn")};var _default=exports["default"]=redirectsToSignInLink},{"./classListContains.js":229}],249:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var resolvesToSearchPage=function resolvesToSearchPage(element){return element?/\/search\//.test(element.getAttribute("href")):false};var _default=exports["default"]=resolvesToSearchPage},{}],250:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sanitizeUrl=void 0;var _index=require("../stringHelpers/index.js");var PAGE_TYPE_ERROR="errorpage";var QUERY_PARAM_FNODE="fnode";var sanitizeUrl=exports.sanitizeUrl=function sanitizeUrl(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},url=_ref.url,pageType=_ref.pageType,isReferrerUrl=_ref.isReferrerUrl;var result=(0,_index.toStrTrim)(url);if(!result){return""}if(isReferrerUrl||typeof pageType==="string"&&pageType.toLowerCase()===PAGE_TYPE_ERROR){result=result.replace(/\/vieworder\/.*/,"/vieworder/******")}result=result.replace(/\/order\/guest\/.*/,"/order/guest/******");result=result.replace(/\/order\/applynow\/ep_payments\/.*/,"/order/applynow/ep_payments/******");result=result.replace(/\/onMyWay\/.*/,"/onMyWay/******");result=result.replace(/\/startPickup\/.*/,"/startPickup/******");result=result.replace(/\/[^/]+@.*/i,"/******");var resultUrl=new URL(result);if(/(\/shop(\/[^/\n\r]*)?\/(sign|log)_?in)/i.test(resultUrl.pathname)){resultUrl.search=""}var params=new URLSearchParams(resultUrl.search);params["delete"](QUERY_PARAM_FNODE);resultUrl.search=params.toString();return resultUrl.toString()}},{"../stringHelpers/index.js":222}],251:[function(require,module,exports){"use strict";var DEBUG_MESSAGING_KEY="f7c9180f-5c45-47b4-8de4-428015f096c0";var enabled=false;var _window={};if(typeof window!=="undefined"){_window=window||self}try{enabled=!!_window.localStorage.getItem(DEBUG_MESSAGING_KEY)}catch(err){}module.exports=enabled},{}],252:[function(require,module,exports){"use strict";var enabled=require("../enabled");module.exports=function expose(funcName){return function(){if(enabled&&typeof window.console==="object"&&typeof console[funcName]==="function"){return console[funcName].apply(console,Array.prototype.slice.call(arguments,0))}}}},{"../enabled":251}],253:[function(require,module,exports){"use strict";module.exports=require("./internal/expose")("log")},{"./internal/expose":252}],254:[function(require,module,exports){"use strict";module.exports=require("./internal/expose")("trace")},{"./internal/expose":252}],255:[function(require,module,exports){"use strict";module.exports=function getDimensions(el,rendered){var rect;if(rendered){rect=el.getBoundingClientRect();return{width:rect.width,height:rect.height}}return{width:el.offsetWidth,height:el.offsetHeight}}},{}],256:[function(require,module,exports){"use strict";var getDimensions=require("./getDimensions");var getScrollX=require("./getScrollX");var getScrollY=require("./getScrollY");module.exports=function getPagePosition(el,rendered){var rect;var scrollX;var scrollY;var dimensions;if(rendered){rect=el.getBoundingClientRect();scrollX=getScrollX();scrollY=getScrollY();return{top:rect.top+scrollY,right:rect.right+scrollX,bottom:rect.bottom+scrollY,left:rect.left+scrollX}}dimensions=getDimensions(el,rendered);rect={top:el.offsetTop,left:el.offsetLeft,width:dimensions.width,height:dimensions.height};while(el=el.offsetParent){rect.top+=el.offsetTop;rect.left+=el.offsetLeft}return{top:rect.top,right:rect.left+rect.width,bottom:rect.top+rect.height,left:rect.left}}},{"./getDimensions":255,"./getScrollX":257,"./getScrollY":258}],257:[function(require,module,exports){"use strict";module.exports=function getScrollX(el){el=el||window;if(el===window){return window.scrollX||window.pageXOffset}return el.scrollLeft}},{}],258:[function(require,module,exports){"use strict";module.exports=function getScrollY(el){el=el||window;if(el===window){return window.scrollY||window.pageYOffset}return el.scrollTop}},{}],259:[function(require,module,exports){"use strict";module.exports=Object.freeze({ELEMENT:1,TEXT:3,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11})},{}],260:[function(require,module,exports){"use strict";module.exports={createDocumentFragment:require("./createDocumentFragment"),filterByNodeType:require("./filterByNodeType"),insertAfter:require("./insertAfter"),insertBefore:require("./insertBefore"),insertFirstChild:require("./insertFirstChild"),isNode:require("./isNode"),isNodeList:require("./isNodeList"),isNodeType:require("./isNodeType"),replace:require("./replace"),NODE_TYPES:require("./NODE_TYPES")}},{"./NODE_TYPES":259,"./createDocumentFragment":261,"./filterByNodeType":262,"./insertAfter":263,"./insertBefore":264,"./insertFirstChild":265,"./isNode":267,"./isNodeList":268,"./isNodeType":269,"./replace":270}],261:[function(require,module,exports){"use strict";module.exports=function createDocumentFragment(html){var fragment=document.createDocumentFragment();var div;if(html){div=document.createElement("div");div.innerHTML=html;while(div.firstChild){fragment.appendChild(div.firstChild)}}return fragment}},{}],262:[function(require,module,exports){"use strict";var isNodeType=require("./isNodeType");var ELEMENT_NODE=require("./NODE_TYPES").ELEMENT;module.exports=function filterByNodeType(nodes,nodeType){nodeType=nodeType||ELEMENT_NODE;nodes=Array.prototype.slice.call(nodes);return nodes.filter(function(node){return isNodeType(node,nodeType)})}},{"./NODE_TYPES":259,"./isNodeType":269}],263:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertAfter(node,target){validate.insertNode(node,"insertAfter");validate.childNode(target,"insertAfter");validate.hasParentNode(target,"insertAfter");if(!target.nextSibling){return target.parentNode.appendChild(node)}return target.parentNode.insertBefore(node,target.nextSibling)}},{"./internal/validate":266}],264:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertBefore(node,target){validate.insertNode(node,"insertBefore");validate.childNode(target,"insertBefore");validate.hasParentNode(target,"insertBefore");return target.parentNode.insertBefore(node,target)}},{"./internal/validate":266}],265:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function insertFirstChild(node,target){validate.insertNode(node,"insertFirstChild");validate.parentNode(target,"insertFirstChild");if(!target.firstChild){return target.appendChild(node)}return target.insertBefore(node,target.firstChild)}},{"./internal/validate":266}],266:[function(require,module,exports){"use strict";var isNodeType=require("../isNodeType");var NODE_TYPES=require("../NODE_TYPES");var COMMENT_NODE=NODE_TYPES.COMMENT;var DOCUMENT_FRAGMENT_NODE=NODE_TYPES.DOCUMENT_FRAGMENT;var ELEMENT_NODE=NODE_TYPES.ELEMENT;var TEXT_NODE=NODE_TYPES.TEXT;var VALID_INSERT_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_INSERT_NODE=" must be an Element, TextNode, Comment, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, or Document Fragment";var ERR_NO_PARENT_NODE=" must have a parentNode";module.exports={parentNode:function(node,funcName,paramName){paramName=paramName||"target";if(node&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,funcName,paramName){paramName=paramName||"target";if(node&&!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_CHILD_NODE)}},insertNode:function(node,funcName,paramName){paramName=paramName||"node";if(node&&!isNodeType(node,VALID_INSERT_NODE)){throw new TypeError(funcName+": "+paramName+ERR_INVALID_INSERT_NODE)}},hasParentNode:function(node,funcName,paramName){paramName=paramName||"target";if(!node.parentNode){throw new TypeError(funcName+": "+paramName+ERR_NO_PARENT_NODE)}}}},{"../NODE_TYPES":259,"../isNodeType":269}],267:[function(require,module,exports){"use strict";module.exports=function isNode(obj){return!!(obj&&obj.nodeType)}},{}],268:[function(require,module,exports){"use strict";var nodeListToStringPattern=/^\[object (HTMLCollection|NodeList|Object)\]$/;module.exports=function isNodeList(obj){if(!obj){return false}if(typeof obj.length!=="number"){return false}if(typeof obj[0]==="object"&&(!obj[0]||!obj[0].nodeType)){return false}return nodeListToStringPattern.test(Object.prototype.toString.call(obj))}},{}],269:[function(require,module,exports){"use strict";var isNode=require("./isNode");module.exports=function isNodeType(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}else if(Array.isArray(nodeType)){return nodeType.indexOf(node.nodeType)!==-1}return false}},{"./isNode":267}],270:[function(require,module,exports){"use strict";var validate=require("./internal/validate");module.exports=function replace(newNode,oldNode){validate.insertNode(newNode,"insertFirstChild","newNode");validate.childNode(oldNode,"insertFirstChild","oldNode");validate.hasParentNode(oldNode,"insertFirstChild","oldNode");return oldNode.parentNode.replaceChild(newNode,oldNode)}},{"./internal/validate":266}],271:[function(require,module,exports){var ElementEngagement=require("./ac-element-engagement/ElementEngagement");module.exports=new ElementEngagement;module.exports.ElementEngagement=ElementEngagement},{"./ac-element-engagement/ElementEngagement":272}],272:[function(require,module,exports){"use strict";var proto;var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var ac_Object={defaults:require("@marcom/ac-object/defaults"),extend:require("@marcom/ac-object/extend")};var Super=require("@marcom/ac-element-tracker").ElementTracker;var trackedElementDefaults={timeToEngage:500,inViewThreshold:.75,stopOnEngaged:true};var extendedTrackedElementProps={thresholdEnterTime:0,thresholdExitTime:0,inThreshold:false,engaged:false,tracking:true};var ElementEngagement=function(options){Super.call(this,null,options);EventEmitterMicro.call(this);this._thresholdEnter=this._thresholdEnter.bind(this);this._thresholdExit=this._thresholdExit.bind(this);this._enterView=this._enterView.bind(this);this._exitView=this._exitView.bind(this)};proto=ElementEngagement.prototype=Object.create(Super.prototype);proto=ac_Object.extend(proto,EventEmitterMicro.prototype);proto._decorateTrackedElement=function(trackedElement,options){var extendedDefaults;extendedDefaults=ac_Object.defaults(trackedElementDefaults,options||{});ac_Object.extend(trackedElement,extendedDefaults);ac_Object.extend(trackedElement,extendedTrackedElementProps)};proto._attachElementListeners=function(trackedElement){trackedElement.on("thresholdenter",this._thresholdEnter,this);trackedElement.on("thresholdexit",this._thresholdExit,this);trackedElement.on("enterview",this._enterView,this);trackedElement.on("exitview",this._exitView,this)};proto._removeElementListeners=function(trackedElement){trackedElement.off("thresholdenter",this._thresholdEnter);trackedElement.off("thresholdexit",this._thresholdExit);trackedElement.off("enterview",this._enterView);trackedElement.off("exitview",this._exitView)};proto._attachAllElementListeners=function(){this.elements.forEach(function(trackedElement){if(!trackedElement.stopOnEngaged){this._attachElementListeners(trackedElement)}else if(!trackedElement.engaged){this._attachElementListeners(trackedElement)}},this)};proto._removeAllElementListeners=function(){this.elements.forEach(function(trackedElement){this._removeElementListeners(trackedElement)},this)};proto._elementInViewPastThreshold=function(trackedElement){var isIt=false;if(trackedElement.pixelsInView===this._windowHeight){isIt=true}else{isIt=trackedElement.percentInView>trackedElement.inViewThreshold}return isIt};proto._ifInView=function(trackedElement,alreadyInView){var alreadyInThreshold=trackedElement.inThreshold;Super.prototype._ifInView.apply(this,arguments);if(!alreadyInThreshold&&this._elementInViewPastThreshold(trackedElement)){trackedElement.inThreshold=true;trackedElement.trigger("thresholdenter",trackedElement);if(typeof trackedElement.timeToEngage==="number"&&trackedElement.timeToEngage>=0){trackedElement.engagedTimeout=window.setTimeout(this._engaged.bind(this,trackedElement),trackedElement.timeToEngage)}}};proto._ifAlreadyInView=function(trackedElement){var alreadyInThreshold=trackedElement.inThreshold;Super.prototype._ifAlreadyInView.apply(this,arguments);if(alreadyInThreshold&&!this._elementInViewPastThreshold(trackedElement)){trackedElement.inThreshold=false;trackedElement.trigger("thresholdexit",trackedElement);if(trackedElement.engagedTimeout){window.clearTimeout(trackedElement.engagedTimeout);trackedElement.engagedTimeout=null}}};proto._engaged=function(trackedElement){trackedElement.engagedTimeout=null;this._elementEngaged(trackedElement);trackedElement.trigger("engaged",trackedElement);this.trigger("engaged",trackedElement)};proto._thresholdEnter=function(trackedElement){trackedElement.thresholdEnterTime=Date.now();trackedElement.thresholdExitTime=0;this.trigger("thresholdenter",trackedElement)};proto._thresholdExit=function(trackedElement){trackedElement.thresholdExitTime=Date.now();this.trigger("thresholdexit",trackedElement)};proto._enterView=function(trackedElement){this.trigger("enterview",trackedElement)};proto._exitView=function(trackedElement){this.trigger("exitview",trackedElement)};proto._elementEngaged=function(trackedElement){trackedElement.engaged=true;if(trackedElement.stopOnEngaged){this.stop(trackedElement)}};proto.stop=function(trackedElement){if(this.tracking&&!trackedElement){this._removeAllElementListeners();Super.prototype.stop.call(this)}if(trackedElement&&trackedElement.tracking){trackedElement.tracking=false;this._removeElementListeners(trackedElement);this.removeElement(trackedElement)}};proto.start=function(trackedElement){if(!trackedElement){this._attachAllElementListeners()}if(trackedElement&&!trackedElement.tracking){if(!trackedElement.stopOnEngaged){trackedElement.tracking=true;this._attachElementListeners(trackedElement)}else if(!trackedElement.engaged){trackedElement.tracking=true;this._attachElementListeners(trackedElement)}}if(!this.tracking){Super.prototype.start.call(this)}else{this.refreshAllElementMetrics();this.refreshAllElementStates()}};proto.addElement=function(element,options){options=options||{};var trackedElement=Super.prototype.addElement.call(this,element,options.useRenderedPosition);this._decorateTrackedElement(trackedElement,options);return trackedElement};proto.addElements=function(collection,options){[].forEach.call(collection,function(element){this.addElement(element,options)},this)};module.exports=ElementEngagement},{"@marcom/ac-element-tracker":278,"@marcom/ac-event-emitter-micro":281,"@marcom/ac-object/defaults":284,"@marcom/ac-object/extend":285}],273:[function(require,module,exports){"use strict";module.exports=1},{}],274:[function(require,module,exports){"use strict";var isNode=require("../isNode");module.exports=function isNodeType(node,nodeType){if(!isNode(node)){return false}if(typeof nodeType==="number"){return node.nodeType===nodeType}return nodeType.indexOf(node.nodeType)!==-1}},{"../isNode":276}],275:[function(require,module,exports){"use strict";var isNodeType=require("./internal/isNodeType");var ELEMENT_NODE=require("./ELEMENT_NODE");module.exports=function isElement(obj){return isNodeType(obj,ELEMENT_NODE)}},{"./ELEMENT_NODE":273,"./internal/isNodeType":274}],276:[function(require,module,exports){"use strict";module.exports=function isNode(obj){return!!(obj&&obj.nodeType)}},{}],277:[function(require,module,exports){"use strict";var nodeListToStringPattern=/^\[object (HTMLCollection|NodeList|Object)\]$/;module.exports=function isNodeList(obj){if(!obj){return false}if(typeof obj.length!=="number"){return false}if(typeof obj[0]==="object"&&(!obj[0]||!obj[0].nodeType)){return false}return nodeListToStringPattern.test(Object.prototype.toString.call(obj))}},{}],278:[function(require,module,exports){var ElementTracker=require("./ac-element-tracker/ElementTracker");var TrackedElement=require("./ac-element-tracker/TrackedElement");module.exports=new ElementTracker;module.exports.ElementTracker=ElementTracker;module.exports.TrackedElement=TrackedElement},{"./ac-element-tracker/ElementTracker":279,"./ac-element-tracker/TrackedElement":280}],279:[function(require,module,exports){"use strict";var ac_dom_nodes={isNodeList:require("@marcom/ac-dom-nodes/isNodeList"),isElement:require("@marcom/ac-dom-nodes/isElement")};var ac_dom_metrics={getDimensions:require("@marcom/ac-dom-metrics/getDimensions"),getPagePosition:require("@marcom/ac-dom-metrics/getPagePosition"),getScrollY:require("@marcom/ac-dom-metrics/getScrollY")};var ac_Object={clone:require("@marcom/ac-object/clone"),extend:require("@marcom/ac-object/extend")};var TrackedElement=require("./TrackedElement");var defaultOptions={autoStart:false,useRenderedPosition:false};function ElementTracker(elements,options){this.options=ac_Object.clone(defaultOptions);this.options=typeof options==="object"?ac_Object.extend(this.options,options):this.options;this._scrollY=this._getScrollY();this._windowHeight=this._getWindowHeight();this.tracking=false;this.elements=[];if(elements&&(Array.isArray(elements)||ac_dom_nodes.isNodeList(elements)||ac_dom_nodes.isElement(elements))){this.addElements(elements)}this.refreshAllElementStates=this.refreshAllElementStates.bind(this);this.refreshAllElementMetrics=this.refreshAllElementMetrics.bind(this);if(this.options.autoStart){this.start()}}var proto=ElementTracker.prototype;proto.destroy=function(){var i,len;this.stop();for(i=0,len=this.elements.length;i<len;i++){this.elements[i].destroy()}this.elements=null;this.options=null};proto._registerTrackedElements=function(trackedElements){var objects=[].concat(trackedElements);objects.forEach(function(object){if(this._elementInDOM(object.element)){object.offsetTop=object.element.offsetTop;this.elements.push(object)}},this)};proto._elementInDOM=function(element){var assertion=false;var body=document.getElementsByTagName("body")[0];if(ac_dom_nodes.isElement(element)&&body.contains(element)){assertion=true}return assertion};proto._elementPercentInView=function(trackedElement){return trackedElement.pixelsInView/trackedElement.height};proto._elementPixelsInView=function(trackedElement){var elementTop=trackedElement.top-this._scrollY;var elementBottom=trackedElement.bottom-this._scrollY;if(elementTop>this._windowHeight||elementBottom<0){return 0}return Math.min(elementBottom,this._windowHeight)-Math.max(elementTop,0)};proto._ifInView=function(trackedElement,alreadyInView){if(!alreadyInView){trackedElement.trigger("enterview",trackedElement)}};proto._ifAlreadyInView=function(trackedElement){if(!trackedElement.inView){trackedElement.trigger("exitview",trackedElement)}};proto.addElements=function(collection,useRenderedPosition){if(typeof useRenderedPosition==="undefined"){useRenderedPosition=this.options.useRenderedPosition}collection=ac_dom_nodes.isNodeList(collection)?Array.prototype.slice.call(collection):[].concat(collection);for(var i=0,len=collection.length;i<len;i++){this.addElement(collection[i],useRenderedPosition)}};proto.addElement=function(element,useRenderedPosition){var trackedElement=null;if(typeof useRenderedPosition==="undefined"){useRenderedPosition=this.options.useRenderedPosition}if(ac_dom_nodes.isElement(element)){trackedElement=new TrackedElement(element,useRenderedPosition);this._registerTrackedElements(trackedElement);this.refreshElementMetrics(trackedElement);this.refreshElementState(trackedElement)}else{throw new TypeError("ElementTracker: "+element+" is not a valid DOM element")}return trackedElement};proto.removeElement=function(element){var indexes=[];var filtered;this.elements.forEach(function(trackedElement,i){if(trackedElement===element||trackedElement.element===element){indexes.push(i)}});filtered=this.elements.filter(function(element,i){return indexes.indexOf(i)<0});this.elements=filtered};proto.start=function(){if(this.tracking===false){this.tracking=true;window.addEventListener("resize",this.refreshAllElementMetrics);window.addEventListener("orientationchange",this.refreshAllElementMetrics);window.addEventListener("scroll",this.refreshAllElementStates);this.refreshAllElementMetrics()}};proto.stop=function(){if(this.tracking===true){this.tracking=false;window.removeEventListener("resize",this.refreshAllElementMetrics);window.removeEventListener("orientationchange",this.refreshAllElementMetrics);window.removeEventListener("scroll",this.refreshAllElementStates)}};proto.refreshAllElementMetrics=function(currentScrollY,windowHeight){if(typeof currentScrollY!=="number"){currentScrollY=this._getScrollY()}if(typeof windowHeight!=="number"){windowHeight=this._getWindowHeight()}this._scrollY=currentScrollY;this._windowHeight=windowHeight;this.elements.forEach(this.refreshElementMetrics,this)};proto.refreshElementMetrics=function(trackedElement){if(!trackedElement.isActive){return trackedElement}var dimensions=ac_dom_metrics.getDimensions(trackedElement.element,trackedElement.useRenderedPosition);var position=ac_dom_metrics.getPagePosition(trackedElement.element,trackedElement.useRenderedPosition);trackedElement=ac_Object.extend(trackedElement,dimensions,position);return this.refreshElementState(trackedElement)};proto.refreshAllElementStates=function(currentScrollY){if(typeof currentScrollY!=="number"){currentScrollY=this._getScrollY()}this._scrollY=currentScrollY;this.elements.forEach(this.refreshElementState,this)};proto.refreshElementState=function(trackedElement){if(!trackedElement.isActive){return trackedElement}var alreadyInView=trackedElement.inView;trackedElement.pixelsInView=this._elementPixelsInView(trackedElement);trackedElement.percentInView=this._elementPercentInView(trackedElement);trackedElement.inView=trackedElement.pixelsInView>0;if(trackedElement.inView){this._ifInView(trackedElement,alreadyInView)}if(alreadyInView){this._ifAlreadyInView(trackedElement)}return trackedElement};proto.pauseElementTracking=function(trackedElement){if(trackedElement){trackedElement.isActive=false}};proto.resumeElementTracking=function(trackedElement){if(trackedElement){trackedElement.isActive=true}};proto._getWindowHeight=function(){return window.innerHeight};proto._getScrollY=function(){return ac_dom_metrics.getScrollY()};module.exports=ElementTracker},{"./TrackedElement":280,"@marcom/ac-dom-metrics/getDimensions":255,"@marcom/ac-dom-metrics/getPagePosition":256,"@marcom/ac-dom-metrics/getScrollY":258,"@marcom/ac-dom-nodes/isElement":275,"@marcom/ac-dom-nodes/isNodeList":277,"@marcom/ac-object/clone":283,"@marcom/ac-object/extend":285}],280:[function(require,module,exports){"use strict";var ac_dom_nodes={isElement:require("@marcom/ac-dom-nodes/isElement")};var EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;var superclass=EventEmitterMicro.prototype;function TrackedElement(element,useRenderedPosition){if(!ac_dom_nodes.isElement(element)){throw new TypeError("TrackedElement: "+element+" is not a valid DOM element")}EventEmitterMicro.call(this);this.element=element;this.inView=false;this.isActive=true;this.percentInView=0;this.pixelsInView=0;this.offsetTop=0;this.top=0;this.right=0;this.bottom=0;this.left=0;this.width=0;this.height=0;this.useRenderedPosition=useRenderedPosition||false}var proto=TrackedElement.prototype=Object.create(superclass);proto.destroy=function(){this.element=null;superclass.destroy.call(this)};module.exports=TrackedElement},{"@marcom/ac-dom-nodes/isElement":275,"@marcom/ac-event-emitter-micro":281}],281:[function(require,module,exports){"use strict";module.exports={EventEmitterMicro:require("./ac-event-emitter-micro/EventEmitterMicro")}},{"./ac-event-emitter-micro/EventEmitterMicro":282}],282:[function(require,module,exports){"use strict";function EventEmitterMicro(){this._events={}}let proto=EventEmitterMicro.prototype;proto.on=function(eventName,callback){this._events[eventName]=this._events[eventName]||[];this._events[eventName].unshift(callback);return callback};proto.once=function(eventName,callback){let that=this;function fn(data){that.off(eventName,fn);if(data!==undefined)callback(data);else callback()}return this.on(eventName,fn)};proto.off=function(eventName,callback){if(!this.has(eventName))return;if(arguments.length===1){this._events[eventName]=null;delete this._events[eventName];return}let index=this._events[eventName].indexOf(callback);if(index===-1)return;this._events[eventName].splice(index,1)};proto.trigger=function(eventName,data){if(!this.has(eventName))return;for(let i=this._events[eventName].length-1;i>=0;i--){if(data!==undefined)this._events[eventName][i](data);else this._events[eventName][i]()}};proto.has=function(eventName){if(eventName in this._events===false||this._events[eventName].length===0){return false}return true};proto.destroy=function(){for(let eventName in this._events){this._events[eventName]=null}this._events=null};module.exports=EventEmitterMicro},{}],283:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/isArray");var extend=require("./extend");var hasOwnProp=Object.prototype.hasOwnProperty;var deepClone=function(dest,source){var prop;for(prop in source){if(hasOwnProp.call(source,prop)){if(source[prop]===null){dest[prop]=null}else if(typeof source[prop]==="object"){dest[prop]=Array.isArray(source[prop])?[]:{};deepClone(dest[prop],source[prop])}else{dest[prop]=source[prop]}}}return dest};module.exports=function clone(object,deep){if(deep){return deepClone({},object)}return extend({},object)}},{"./extend":285,"@marcom/ac-polyfills/Array/isArray":286}],284:[function(require,module,exports){"use strict";var extend=require("./extend");module.exports=function defaults(defaultsObj,options){if(typeof defaultsObj!=="object"){throw new TypeError("defaults: must provide a defaults object")}options=options||{};if(typeof options!=="object"){throw new TypeError("defaults: options must be a typeof object")}return extend({},defaultsObj,options)}},{"./extend":285}],285:[function(require,module,exports){"use strict";require("@marcom/ac-polyfills/Array/prototype.forEach");var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function extend(){var args;var dest;if(arguments.length<2){args=[{},arguments[0]]}else{args=[].slice.call(arguments)}dest=args.shift();args.forEach(function(source){if(source!=null){for(var property in source){if(hasOwnProp.call(source,property)){dest[property]=source[property]}}}});return dest}},{"@marcom/ac-polyfills/Array/prototype.forEach":287}],286:[function(require,module,exports){if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==="[object Array]"}}},{}],287:[function(require,module,exports){if(!Array.prototype.forEach){Array.prototype.forEach=function forEach(callback,thisObj){var arrayObject=Object(this);var i;var currentValue;if(typeof callback!=="function"){throw new TypeError("No function object passed to forEach.")}var length=this.length;for(i=0;i<length;i+=1){currentValue=arrayObject[i];callback.call(thisObj,currentValue,i,arrayObject)}}}},{}],288:[function(require,module,exports){"use strict";var appMeasurementSetup=require("./appmeasurement-setup/AppMeasurementSetup");module.exports={init:appMeasurementSetup.init,getInstance:appMeasurementSetup.getInstance}},{"./appmeasurement-setup/AppMeasurementSetup":292}],289:[function(require,module,exports){(function(){window.AppMeasurement_Module_ActivityMap=function(k){function p(){var a=f.pageYOffset+(f.innerHeight||0);a&&a>+g&&(g=a)}function q(){if(e.scrollReachSelector){var a=k.d.querySelector&&k.d.querySelector(e.scrollReachSelector);a?(g=a.scrollTop||0,a.addEventListener("scroll",function(){var d;(d=a&&a.scrollTop+a.clientHeight||0)>g&&(g=d)})):0<v--&&setTimeout(q,1e3)}}function l(a,d){var b,c,n;if(a&&d&&(b=e.c[d]||(e.c[d]=d.split(","))))for(n=0;n<b.length&&(c=b[n++]);)if(-1<a.indexOf(c))return null;return a}function r(a,d,b,c,e){var f,h;if(a.dataset&&(h=a.dataset[d]))f=h;else if(a.getAttribute)if(h=a.getAttribute("data-"+b))f=h;else if(h=a.getAttribute(b))f=h;if(!f&&k.useForcedLinkTracking&&e){var g;a=a.onclick?""+a.onclick:"";d="";if(c&&a&&(b=a.indexOf(c),0<=b)){for(b+=c.length;b<a.length;)if(h=a.charAt(b++),0<="'\"".indexOf(h)){g=h;break}for(var l=!1;b<a.length&&g;){h=a.charAt(b);if(!l&&h===g)break;"\\"===h?l=!0:(d+=h,l=!1);b++}}(g=d)&&(k.w[c]=g)}return f||e&&k.w[c]}function s(a,d,b){var c;return(c=e[d](a,b))&&l(m(c),e[d+"Exclusions"])}function t(a,d,b){var c;if(a&&!(1===(c=a.nodeType)&&(c=a.nodeName)&&(c=c.toUpperCase())&&w[c])&&(1===a.nodeType&&(c=a.nodeValue)&&(d[d.length]=c),b.a||b.t||b.s||!a.getAttribute||((c=a.getAttribute("alt"))?b.a=c:(c=a.getAttribute("title"))?b.t=c:"IMG"==(""+a.nodeName).toUpperCase()&&(c=a.getAttribute("src")||a.src)&&(b.s=c)),(c=a.childNodes)&&c.length))for(a=0;a<c.length;a++)t(c[a],d,b)}function m(a){if(null==a||void 0==a)return a;try{return a.replace(RegExp("^[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029\ufeff]+","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029\ufeff]+$","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029\ufeff]{1,}","mg")," ").substring(0,254)}catch(d){}}var e=this;e.s=k;var f=window;f.s_c_in||(f.s_c_il=[],f.s_c_in=0);e._il=f.s_c_il;e._in=f.s_c_in;e._il[e._in]=e;f.s_c_in++;e._c="s_m";var g=0,u,v=60;e.c={};var w={SCRIPT:1,STYLE:1,LINK:1,CANVAS:1};e._g=function(){var a,d,b,c=k.contextData,e=k.linkObject;(a=k.pageName||k.pageURL)&&(d=s(e,"link",k.linkName))&&(b=s(e,"region"))&&(c["a.activitymap.page"]=a.substring(0,255),c["a.activitymap.link"]=128<d.length?d.substring(0,128):d,c["a.activitymap.region"]=127<b.length?b.substring(0,127):b,0<g&&(c["a.activitymap.xy"]=10*Math.floor(g/10)),c["a.activitymap.pageIDType"]=k.pageName?1:0)};e._d=function(){e.trackScrollReach&&!u&&(e.scrollReachSelector?q():(p(),f.addEventListener&&f.addEventListener("scroll",p,!1)),u=!0)};e.link=function(a,d){var b;if(d)b=l(m(d),e.linkExclusions);else if((b=a)&&!(b=r(a,"sObjectId","s-object-id","s_objectID",1))){var c,f;(f=l(m(a.innerText||a.textContent),e.linkExclusions))||(t(a,c=[],b={a:void 0,t:void 0,s:void 0}),(f=l(m(c.join(""))))||(f=l(m(b.a?b.a:b.t?b.t:b.s?b.s:void 0)))||!(c=(c=a.tagName)&&c.toUpperCase?c.toUpperCase():"")||("INPUT"==c||"SUBMIT"==c&&a.value?f=l(m(a.value)):"IMAGE"==c&&a.src&&(f=l(m(a.src)))));b=f}return b};e.region=function(a){for(var d,b=e.regionIDAttribute||"id";a&&(a=a.parentNode);){if(d=r(a,b,b,b))return d;if("BODY"==a.nodeName)return"BODY"}}};window.AppMeasurement=function(r){var a=this;a.version="2.23.0";var h=window;h.s_c_in||(h.s_c_il=[],h.s_c_in=0);a._il=h.s_c_il;a._in=h.s_c_in;a._il[a._in]=a;h.s_c_in++;a._c="s_c";var q=h.AppMeasurement.mc;q||(q=null);var p=h,m,s;try{for(m=p.parent,s=p.location;m&&m.location&&s&&""+m.location!==""+s&&p.location&&""+m.location!==""+p.location&&m.location.host===s.host;)p=m,m=p.parent}catch(u){}a.log=function(a){try{console.log(a)}catch(c){}};a.Sa=function(a){return""+parseInt(a)==""+a};a.replace=function(a,c,d){return!a||0>a.indexOf(c)?a:a.split(c).join(d)};a.escape=function(b){var c,d;if(!b)return b;b=encodeURIComponent(b);for(c=0;7>c;c++)d="+~!*()'".substring(c,c+1),0<=b.indexOf(d)&&(b=a.replace(b,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return b};a.unescape=function(b){if(!b)return b;b=0<=b.indexOf("+")?a.replace(b,"+"," "):b;try{return decodeURIComponent(b)}catch(c){}return unescape(b)};a.Rb=function(){var b=h.location.hostname,c=a.fpCookieDomainPeriods,d;c||(c=a.cookieDomainPeriods);if(b&&!a.La&&!/^[0-9.]+$/.test(b)&&(c=c?parseInt(c):2,c=2<c?c:2,d=b.lastIndexOf("."),0<=d)){for(;0<=d&&1<c;)d=b.lastIndexOf(".",d-1),c--;a.La=0<d?b.substring(d):b}return a.La};a.c_r=a.cookieRead=function(b){b=a.escape(b);var c=" "+a.d.cookie,d=c.indexOf(" "+b+"="),f=0>d?d:c.indexOf(";",d);b=0>d?"":a.unescape(c.substring(d+2+b.length,0>f?c.length:f));return"[[B]]"!=b?b:""};a.c_w=a.cookieWrite=function(b,c,d){var f=a.Rb(),e=a.cookieLifetime,g;c=""+c;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=e&&"NONE"!=e&&((g=""!=c?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1e3*g)):1===d&&(d=new Date,g=d.getYear(),d.setYear(g+2+(1900>g?1900:0))));return b&&"NONE"!=e?(a.d.cookie=a.escape(b)+"="+a.escape(""!=c?c:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toUTCString()+";":"")+(f?" domain="+f+";":"")+(a.writeSecureCookies?" secure;":""),a.cookieRead(b)==c):0};a.Ob=function(){var b=a.Util.getIeVersion();"number"===typeof b&&10>b&&(a.unsupportedBrowser=!0,a.Bb(a,function(){}))};a.za=function(){var a=navigator.userAgent;return"Microsoft Internet Explorer"===navigator.appName||0<=a.indexOf("MSIE ")||0<=a.indexOf("Trident/")&&0<=a.indexOf("Windows NT 6")?!0:!1};a.Bb=function(a,c){for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&"function"===typeof a[d]&&(a[d]=c)};a.K=[];a.fa=function(b,c,d){if(a.Ma)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,k=["webkitvisibilitychange","visibilitychange"];g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.ga)for(a.ga=1,d=0;d<k.length;d++)a.d.addEventListener(k[d],function(){var b=a.d.visibilityState;b||(b=a.d.webkitVisibilityState);"visible"==b&&(a.ga=0,a.delayReady())});f=1;e=0}else d||a.u("_d")&&(f=1);f&&(a.K.push({m:b,a:c,t:e}),a.ga||setTimeout(a.delayReady,a.maxDelay));return f};a.delayReady=function(){var b=(new Date).getTime(),c=0,d;for(a.u("_d")?c=1:a.Ba();0<a.K.length;){d=a.K.shift();if(c&&!d.t&&d.t>b){a.K.unshift(d);setTimeout(a.delayReady,parseInt(a.maxDelay/2));break}a.Ma=1;a[d.m].apply(a,d.a);a.Ma=0}};a.setAccount=a.sa=function(b){var c,d;if(!a.fa("setAccount",arguments))if(a.account=b,a.allAccounts)for(c=a.allAccounts.concat(b.split(",")),a.allAccounts=[],c.sort(),d=0;d<c.length;d++)0!=d&&c[d-1]==c[d]||a.allAccounts.push(c[d]);else a.allAccounts=b.split(",")};a.foreachVar=function(b,c){var d,f,e,g,k="";e=f="";if(a.lightProfileID)d=a.O,(k=a.lightTrackVars)&&(k=","+k+","+a.la.join(",")+",");else{d=a.g;if(a.pe||a.linkType)k=a.linkTrackVars,f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(k=a[e].ic,f=a[e].hc));k&&(k=","+k+","+a.D.join(",")+",");f&&k&&(k+=",events,")}c&&(c=","+c+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!k||0<=k.indexOf(","+e+","))&&(!c||0<=c.indexOf(","+e+","))&&b(e,g)};a.l=function(b,c,d,f,e){var g="",k,l,h,n,m=0;"contextData"==b&&(b="c");"clientHints"==b&&(b="h");if(c){for(k in c)if(!(Object.prototype[k]||e&&k.substring(0,e.length)!=e)&&c[k]&&(!d||0<=d.indexOf(","+(f?f+".":"")+k+","))){h=!1;if(m)for(l=0;l<m.length;l++)if(k.substring(0,m[l].length)==m[l]){h=!0;break}if(!h&&(""==g&&(g+="&"+b+"."),l=c[k],e&&(k=k.substring(e.length)),0<k.length))if(h=k.indexOf("."),0<h)l=k.substring(0,h),h=(e?e:"")+l+".",m||(m=[]),m.push(h),g+=a.l(l,c,d,f,h);else if("boolean"==typeof l&&(l=l?"true":"false"),l){if("retrieveLightData"==f&&0>e.indexOf(".contextData."))switch(h=k.substring(0,4),n=k.substring(4),k){case"transactionID":k="xact";break;case"channel":k="ch";break;case"campaign":k="v0";break;default:a.Sa(n)&&("prop"==h?k="c"+n:"eVar"==h?k="v"+n:"list"==h?k="l"+n:"hier"==h&&(k="h"+n,l=l.substring(0,255)))}g+="&"+a.escape(k)+"="+a.escape(l)}}""!=g&&(g+="&."+b)}return g};a.usePostbacks=0;a.Ub=function(){var b="",c,d,f,e,g,k,l,h,n="",m="",p=e="",r=a.T();if(a.lightProfileID)c=a.O,(n=a.lightTrackVars)&&(n=","+n+","+a.la.join(",")+",");else{c=a.g;if(a.pe||a.linkType)n=a.linkTrackVars,m=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(n=a[e].ic,m=a[e].hc));n&&(n=","+n+","+a.D.join(",")+",");m&&(m=","+m+",",n&&(n+=",events,"));a.events2&&(p+=(""!=p?",":"")+a.events2)}if(r&&r.getCustomerIDs){e=q;if(g=r.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],"object"==typeof f&&(e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState)));e&&(b+=a.l("cid",e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(b+=a.l("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<c.length;d++){e=c[d];g=a[e];f=e.substring(0,4);k=e.substring(4);g||("events"==e&&p?(g=p,p=""):"marketingCloudOrgID"==e&&r&&a.V("ECID")&&(g=r.marketingCloudOrgID));if(g&&(!n||0<=n.indexOf(","+e+","))){switch(e){case"customerPerspective":e="cp";break;case"marketingCloudOrgID":e="mcorgid";break;case"supplementalDataID":e="sdid";break;case"timestamp":e="ts";break;case"dynamicVariablePrefix":e="D";break;case"visitorID":e="vid";break;case"marketingCloudVisitorID":e="mid";break;case"analyticsVisitorID":e="aid";break;case"audienceManagerLocationHint":e="aamlh";break;case"audienceManagerBlob":e="aamb";break;case"authState":e="as";break;case"pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,255));break;case"pageURLRest":e="-g";break;case"referrer":e="r";break;case"vmk":case"visitorMigrationKey":e="vmt";break;case"visitorMigrationServer":e="vmf";a.ssl&&a.visitorMigrationServerSecure&&(g="");break;case"visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case"charSet":e="ce";break;case"visitorNamespace":e="ns";break;case"cookieDomainPeriods":e="cdp";break;case"cookieLifetime":e="cl";break;case"variableProvider":e="vvp";break;case"currencyCode":e="cc";break;case"channel":e="ch";break;case"transactionID":e="xact";break;case"campaign":e="v0";break;case"latitude":e="lat";break;case"longitude":e="lon";break;case"resolution":e="s";break;case"colorDepth":e="c";break;case"javascriptVersion":e="j";break;case"javaEnabled":e="v";break;case"cookiesEnabled":e="k";break;case"browserWidth":e="bw";break;case"browserHeight":e="bh";break;case"connectionType":e="ct";break;case"homepage":e="hp";break;case"events":p&&(g+=(""!=g?",":"")+p);if(m&&typeof g==="string")for(k=g.split(","),g="",f=0;f<k.length;f++)l=k[f],h=l.indexOf("="),0<=h&&(l=l.substring(0,h)),h=l.indexOf(":"),0<=h&&(l=l.substring(0,h)),0<=m.indexOf(","+l+",")&&(g+=(g?",":"")+k[f]);break;case"events2":g="";break;case"contextData":b+=a.l("c",a[e],n,e);g="";break;case"clientHints":b+=a.l("h",a[e],n,e);g="";break;case"lightProfileID":e="mtp";break;case"lightStoreForSeconds":e="mtss";a.lightProfileID||(g="");break;case"lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case"retrieveLightProfiles":e="mtsr";break;case"deleteLightProfiles":e="mtsd";break;case"retrieveLightData":a.retrieveLightProfiles&&(b+=a.l("mts",a[e],n,e));g="";break;default:a.Sa(k)&&("prop"==f?e="c"+k:"eVar"==f?e="v"+k:"list"==f?e="l"+k:"hier"==f&&(e="h"+k,g=g.substring(0,255)))}g&&(b+="&"+e+"="+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(b+=a.e)}a.ka&&(b+="&lrt="+a.ka,a.ka=null);return b};a.B=function(a){var c=a.tagName;if("undefined"!=""+a.pc||"undefined"!=""+a.cc&&"HTML"!=(""+a.cc).toUpperCase())return"";c=c&&c.toUpperCase?c.toUpperCase():"";"SHAPE"==c&&(c="");c&&(("INPUT"==c||"BUTTON"==c)&&a.type&&a.type.toUpperCase?c=a.type.toUpperCase():!c&&a.href&&(c="A"));return c};a.Oa=function(a){var c=h.location,d=a.href?a.href:"",f,e,g;"string"!==typeof d&&(d="");f=d.indexOf(":");e=d.indexOf("?");g=d.indexOf("/");d&&(0>f||0<=e&&f>e||0<=g&&f>g)&&(e=a.protocol&&1<a.protocol.length?a.protocol:c.protocol?c.protocol:"",f=c.pathname.lastIndexOf("/"),d=(e?e+"//":"")+(a.host?a.host:c.host?c.host:"")+("/"!=d.substring(0,1)?c.pathname.substring(0,0>f?0:f)+"/":"")+d);return d};a.L=function(b){var c=a.B(b),d,f,e="",g=0;return c&&(d=b.protocol,f=b.onclick,!b.href||"A"!=c&&"AREA"!=c||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==c||"SUBMIT"==c?(b.value?e=b.value:b.innerText?e=b.innerText:b.textContent&&(e=b.textContent),g=3):"IMAGE"==c&&b.src&&(e=b.src):e=a.Oa(b),e)?{id:e.substring(0,100),type:g}:0};a.nc=function(b){for(var c=a.B(b),d=a.L(b);b&&!d&&"BODY"!=c;)if(b=b.parentElement?b.parentElement:b.parentNode)c=a.B(b),d=a.L(b);d&&"BODY"!=c||(b=0);b&&(c=b.onclick?""+b.onclick:"",0<=c.indexOf(".tl(")||0<=c.indexOf(".trackLink("))&&(b=0);return b};a.bc=function(){var b,c,d=a.linkObject,f=a.linkType,e=a.linkURL,g,k;a.ma=1;d||(a.ma=0,d=a.clickObject);if(d){b=a.B(d);for(c=a.L(d);d&&!c&&"BODY"!=b;)if(d=d.parentElement?d.parentElement:d.parentNode)b=a.B(d),c=a.L(d);c&&"BODY"!=b||(d=0);if(d&&!a.linkObject){var l=d.onclick?""+d.onclick:"";if(0<=l.indexOf(".tl(")||0<=l.indexOf(".trackLink("))d=0}}else a.ma=1;!e&&d&&(e=a.Oa(d));e&&!a.linkLeaveQueryString&&(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var m=0,n=0,p;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(l=e.toLowerCase(),g=l.indexOf("?"),k=l.indexOf("#"),0<=g?0<=k&&k<g&&(g=k):g=k,0<=g&&(l=l.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),k=0;k<g.length;k++)(p=g[k])&&(l.substring(l.length-(p.length+1))=="."+p||l.substring(l.length-(p.length+1))=="/"+p)&&(f="d");if(a.trackExternalLinks&&!f&&(l=e.toLowerCase(),a.Ra(l)&&(a.linkInternalFilters||(a.linkInternalFilters=h.location.hostname),g=0,a.linkExternalFilters?(g=a.linkExternalFilters.toLowerCase().split(","),m=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(k=0;k<g.length;k++)p=g[k],0<=l.indexOf(p)&&(n=1);n?m&&(f="e"):m||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,f||(f=a.pageURL,e=0),h.s_objectID&&(c.id=h.s_objectID,d=c.type=1),f&&c&&c.id&&b&&(a.e="&pid="+a.escape(f.substring(0,255))+(e?"&pidt="+e:"")+"&oid="+a.escape(c.id.substring(0,100))+(c.type?"&oidt="+c.type:"")+"&ot="+b+(d?"&oi="+d:"")))};a.Vb=function(){var b=a.ma,c=a.linkType,d=a.linkURL,f=a.linkName;c&&(d||f)&&(c=c.toLowerCase(),"d"!=c&&"e"!=c&&(c="o"),a.pe="lnk_"+c,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",b=1);a.abort&&(b=0);if(a.trackClickMap||a.trackInlineStats||a.Yb()){var c={},d=0,e=a.vb(),g=e?e.split("&"):0,k,l,h,e=0;if(g)for(k=0;k<g.length;k++)l=g[k].split("="),f=a.unescape(l[0]).split(","),l=a.unescape(l[1]),c[l]=f;f=a.account.split(",");k={};for(h in a.contextData)h&&!Object.prototype[h]&&"a.activitymap."==h.substring(0,14)&&(k[h]=a.contextData[h],a.contextData[h]="");a.e=a.l("c",k)+(a.e?a.e:"");if(b||a.e){b&&!a.e&&(e=1);for(l in c)if(!Object.prototype[l])for(h=0;h<f.length;h++)for(e&&(g=c[l].join(","),g==a.account&&(a.e+=("&"!=l.charAt(0)?"&":"")+l,c[l]=[],d=1)),k=0;k<c[l].length;k++)g=c[l][k],g==f[h]&&(e&&(a.e+="&u="+a.escape(g)+("&"!=l.charAt(0)?"&":"")+l+"&u=0"),c[l].splice(k,1),d=1);b||(d=1);if(d){e="";k=2;!b&&a.e&&(e=a.escape(f.join(","))+"="+a.escape(a.e),k=1);for(l in c)!Object.prototype[l]&&0<k&&0<c[l].length&&(e+=(e?"&":"")+a.escape(c[l].join(","))+"="+a.escape(l),k--);a.Db(e)}}}return b};a.vb=function(){if(a.useLinkTrackSessionStorage){if(a.Fa())return h.sessionStorage.getItem(a.P)}else return a.cookieRead(a.P)};a.Fa=function(){return h.sessionStorage?!0:!1};a.Db=function(b){a.useLinkTrackSessionStorage?a.Fa()&&h.sessionStorage.setItem(a.P,b):a.cookieWrite(a.P,b)};a.Wb=function(){if(!a.gc){var b=new Date,c=p.location,d,f,e=f=d="",g="",k="",l="1.2",h=a.cookieWrite("s_cc","true",0)?"Y":"N",m="",q="";if(b.setUTCDate&&(l="1.3",0..toPrecision&&(l="1.5",b=[],b.forEach))){l="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(l="1.7",b.reduce&&(l="1.8",l.trim&&(l="1.8.1",Date.parse&&(l="1.8.2",Object.create&&(l="1.8.5")))))}catch(r){}}d=screen.width+"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?a.w.innerWidth:a.d.documentElement.offsetWidth;k=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),m=a.b.oc(c)?"Y":"N"}catch(s){}try{a.b.addBehavior("#default#clientCaps"),q=a.b.connectionType}catch(t){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=l;a.javaEnabled=e;a.cookiesEnabled=h;a.browserWidth=g;a.browserHeight=k;a.connectionType=q;a.homepage=m;a.gc=1}};a.ib=function(){if(a.collectHighEntropyUserAgentHints&&!a.H&&a.cb()){a.H=!0;try{navigator.userAgentData.getHighEntropyValues(a.ta).then(function(b){a.clientHints={};a.ta.forEach(function(d){Object.prototype.hasOwnProperty.call(b,d)&&(a.clientHints[d]=b[d])})})["catch"](function(b){a.H=!1;a.clientHints={};a.debugTracking&&a.log(b.message)})}catch(b){a.H=!1,a.clientHints={},a.debugTracking&&a.log(b.message)}}else a.clientHints={}};a.cb=function(){return"undefined"!==typeof navigator.userAgentData};a.Q={};a.loadModule=function(b,c){var d=a.Q[b];if(!d){d=h["AppMeasurement_Module_"+b]?new h["AppMeasurement_Module_"+b](a):{};a.Q[b]=a[b]=d;d.ob=function(){return d.yb};d.Eb=function(c){if(d.yb=c)a[b+"_onLoad"]=c,a.fa(b+"_onLoad",[a,d],1)||c(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.ob,set:d.Eb}):d._olc=1}catch(f){d._olc=1}}c&&(a[b+"_onLoad"]=c,a.fa(b+"_onLoad",[a,d],1)||c(a,d))};a.u=function(b){var c,d;for(c in a.Q)if(!Object.prototype[c]&&(d=a.Q[c])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[b]&&d[b]()))return 1;return 0};a.Yb=function(){return a.ActivityMap&&a.ActivityMap._c?!0:!1};a.Zb=function(){var b=Math.floor(1e13*Math.random()),c=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=a.cookieRead(d);if(c){c*=100;f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,b))return 0;f=b}if(f%1e4>c)return 0}return 1};a.S=function(b,c){var d,f,e,g,k,h,m;m={};for(d=0;2>d;d++)for(f=0<d?a.Ha:a.g,e=0;e<f.length;e++)if(g=f[e],(k=b[g])||b["!"+g]){if(k&&!c&&("contextData"==g||"retrieveLightData"==g)&&a[g])for(h in a[g])k[h]||(k[h]=a[g][h]);a[g]||(m["!"+g]=1);m[g]=a[g];a[g]=k}return m};a.lc=function(b){var c,d,f,e;for(c=0;2>c;c++)for(d=0<c?a.Ha:a.g,f=0;f<d.length;f++)e=d[f],b[e]=a[e],b[e]||"prop"!==e.substring(0,4)&&"eVar"!==e.substring(0,4)&&"hier"!==e.substring(0,4)&&"list"!==e.substring(0,4)&&"channel"!==e&&"events"!==e&&"eventList"!==e&&"products"!==e&&"productList"!==e&&"purchaseID"!==e&&"transactionID"!==e&&"state"!==e&&"zip"!==e&&"campaign"!==e&&"events2"!==e&&"latitude"!==e&&"longitude"!==e&&"ms_a"!==e&&"contextData"!==e&&"supplementalDataID"!==e&&"tnt"!==e&&"timestamp"!==e&&"abort"!==e&&"useBeacon"!==e&&"linkObject"!==e&&"clickObject"!==e&&"linkType"!==e&&"linkName"!==e&&"linkURL"!==e&&"bodyClickTarget"!==e&&"bodyClickFunction"!==e||(b["!"+e]=1)};a.Qb=function(a){var c,d,f,e,g,k=0,h,m="",n="";if(a&&255<a.length&&(c=""+a,d=c.indexOf("?"),0<d&&(h=c.substring(d+1),c=c.substring(0,d),e=c.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=c.substring(d),c=c.substring(0,d),0<=e.indexOf("google")?k=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")?k=",p,ei,":0<=e.indexOf("baidu.")&&(k=",wd,word,"),k&&h)))){if((a=h.split("&"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("="),0<d&&0<=k.indexOf(","+e.substring(0,d)+",")?m+=(m?"&":"")+e:n+=(n?"&":"")+e;m&&n?h=m+"&"+n:n=""}d=253-(h.length-n.length)-c.length;a=c+(0<d?g.substring(0,d):"")+"?"+h}return a};a.gb=function(b){var c=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];c||(c=a.d.webkitVisibilityState);if(c&&"prerender"==c){if(b)for(c=0;c<d.length;c++)a.d.addEventListener(d[c],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&b()});return!1}return!0};a.ca=!1;a.G=!1;a.Gb=function(){a.G=!0;a.p()};a.I=!1;a.Hb=function(b){a.marketingCloudVisitorID=b.MCMID;a.visitorOptedOut=b.MCOPTOUT;a.analyticsVisitorID=b.MCAID;a.audienceManagerLocationHint=b.MCAAMLH;a.audienceManagerBlob=b.MCAAMB;a.I=!1;a.p()};a.fb=function(b){a.maxDelay||(a.maxDelay=250);return a.u("_d")?(b&&setTimeout(function(){b()},a.maxDelay),!1):!0};a.aa=!1;a.F=!1;a.Ba=function(){a.F=!0;a.p()};a.isReadyToTrack=function(){var b=!0;if(!a.sb()||!a.qb())return!1;a.ub()||(b=!1);a.xb()||(b=!1);a.hb()||(b=!1);return b};a.sb=function(){a.ca||a.G||(a.gb(a.Gb)?a.G=!0:a.ca=!0);return a.ca&&!a.G?!1:!0};a.qb=function(){var b=a.xa();if(b)if(a.ua||a.ba)if(a.ua){if(!b.isApproved(b.Categories.ANALYTICS))return!1}else return!1;else return b.fetchPermissions(a.zb,!0),a.ba=!0,!1;return!0};a.V=function(b){var c=a.xa();return c&&!c.isApproved(c.Categories[b])?!1:!0};a.xa=function(){return h.adobe&&h.adobe.optIn?h.adobe.optIn:null};a.Y=!0;a.ub=function(){var b=a.T();if(!b||!b.getVisitorValues)return!0;a.Y&&(a.Y=!1,a.I||(a.I=!0,b.getVisitorValues(a.Hb)));return!a.I};a.T=function(){var b=a.visitor;b&&!b.isAllowed()&&(b=null);return b};a.xb=function(){a.aa||a.F||(a.fb(a.Ba)?a.F=!0:a.aa=!0);return a.aa&&!a.F?!1:!0};a.hb=function(){a.H||a.clientHints||a.ib();return a.clientHints};a.ba=!1;a.zb=function(){a.ba=!1;a.ua=!0};a.j=q;a.q=0;a.callbackWhenReadyToTrack=function(b,c,d){var f;f={};f.Lb=b;f.Kb=c;f.Ib=d;a.j==q&&(a.j=[]);a.j.push(f);0==a.q&&(a.q=setInterval(a.p,100))};a.p=function(){var b;if(a.isReadyToTrack()&&(a.Fb(),a.j!=q))for(;0<a.j.length;)b=a.j.shift(),b.Kb.apply(b.Lb,b.Ib)};a.Fb=function(){a.q&&(clearInterval(a.q),a.q=0)};a.va=function(b){var c,d={};a.lc(d);if(b!=q)for(c in b)d[c]=b[c];a.callbackWhenReadyToTrack(a,a.Ga,[d]);a.Ea()};a.Sb=function(){var b=a.cookieRead("s_fid"),c="",d="",f;f=8;var e=4;if(!b||0>b.indexOf("-")){for(b=0;16>b;b++)f=Math.floor(Math.random()*f),c+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;b=c+"-"+d}a.cookieWrite("s_fid",b,1)||(b=0);return b};a.Ga=function(b){var c=new Date,d="s"+Math.floor(c.getTime()/108e5)%10+Math.floor(1e13*Math.random()),f=c.getYear(),f="t="+a.escape(c.getDate()+"/"+c.getMonth()+"/"+(1900>f?f+1900:f)+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+" "+c.getDay()+" "+c.getTimezoneOffset()),e=a.T(),g;b&&(g=a.S(b,1));a.Zb()&&!a.visitorOptedOut&&(a.ya()||(a.fid=a.Sb()),a.bc(),a.usePlugins&&a.doPlugins&&a.doPlugins(a),a.account&&(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(c.getTime()/1e3)),b=h.location,a.pageURL||(a.pageURL=b.href?b.href:b),a.referrer||a.ab||(b=a.Util.getQueryParam("adobe_mc_ref",null,null,!0),a.referrer=b||void 0===b?void 0===b?"":b:p.document.referrer),a.ab=1,!a.referrer&&a.Z&&(a.referrer=a.Z),a.Z=0,a.referrer=a.Qb(a.referrer),a.u("_g")),a.Vb()&&!a.abort&&(e&&a.V("TARGET")&&!a.supplementalDataID&&e.getSupplementalDataID&&(a.supplementalDataID=e.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?!1:!0)),a.V("AAM")||(a.contextData["cm.ssf"]=1),a.Wb(),a.Ab(),f+=a.Ub(),a.wb(d,f),a.u("_t"),a.referrer="",a.contextData&&a.contextData.excCodes&&(a.contextData.excCodes=0))));a.referrer&&(a.Z=a.referrer);a.Ea();g&&a.S(g,1)};a.t=a.track=function(b,c){c&&a.S(c);a.Y=!0;a.isReadyToTrack()?null!=a.j&&0<a.j.length?(a.va(b),a.p()):a.Ga(b):a.va(b)};a.Ab=function(){a.writeSecureCookies&&!a.ssl&&a.bb()};a.bb=function(){a.contextData.excCodes=a.contextData.excCodes||[];a.contextData.excCodes.push(1)};a.Ea=function(){a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=h.s_objectID=a.pe=a.pev1=a.pev2=a.pev3=a.e=a.lightProfileID=a.useBeacon=a.referrer=0};a.Da=[];a.registerPreTrackCallback=function(b){for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);"function"==typeof b?a.Da.push([b,c]):a.debugTracking&&a.log("Warning, Non function type passed to registerPreTrackCallback")};a.lb=function(b){a.wa(a.Da,b)};a.Ca=[];a.registerPostTrackCallback=function(b){for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);"function"==typeof b?a.Ca.push([b,c]):a.debugTracking&&a.log("Warning, Non function type passed to registerPostTrackCallback")};a.kb=function(b){a.wa(a.Ca,b)};a.wa=function(b,c){if("object"==typeof b)for(var d=0;d<b.length;d++){var f=b[d][0],e=b[d][1].slice();e.unshift(c);if("function"==typeof f)try{f.apply(null,e)}catch(g){a.debugTracking&&a.log(g.message)}}};a.tl=a.trackLink=function(b,c,d,f,e){a.linkObject=b;a.linkType=c;a.linkName=d;e&&(a.bodyClickTarget=b,a.bodyClickFunction=e);return a.track(f)};a.trackLight=function(b,c,d,f){a.lightProfileID=b;a.lightStoreForSeconds=c;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var b,c;for(b=0;b<a.g.length;b++)if(c=a.g[b],"prop"==c.substring(0,4)||"eVar"==c.substring(0,4)||"hier"==c.substring(0,4)||"list"==c.substring(0,4)||"channel"==c||"events"==c||"eventList"==c||"products"==c||"productList"==c||"purchaseID"==c||"transactionID"==c||"state"==c||"zip"==c||"campaign"==c)a[c]=void 0};a.tagContainerMarker="";a.wb=function(b,c){var d=a.mb()+"/"+b+"?AQB=1&ndh=1&pf=1&"+(a.Aa()?"callback=s_c_il["+a._in+"].doPostbacks&et=1&":"")+c+"&AQE=1";a.lb(d);a.jb(d);a.U()};a.mb=function(){var b=a.nb();return"http"+(a.ssl?"s":"")+"://"+b+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(a.Aa()?"10":"1")+"/JS-"+a.version+(a.fc?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")};a.Aa=function(){return a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks};a.nb=function(){var b=a.dc,c=a.trackingServer;c?a.trackingServerSecure&&a.ssl&&(c=a.trackingServerSecure):(b=b?(""+b).toLowerCase():"d1","d1"==b?b="112":"d2"==b&&(b="122"),c=a.pb()+"."+b+".2o7.net");return c};a.pb=function(){var b=a.visitorNamespace;b||(b=a.account.split(",")[0],b=b.replace(/[^0-9a-z]/gi,""));return b};a.$a=/{(%?)(.*?)(%?)}/;a.kc=RegExp(a.$a.source,"g");a.Pb=function(b){if("object"==typeof b.dests)for(var c=0;c<b.dests.length;++c){var d=b.dests[c];if("string"==typeof d.c&&"aa."==d.id.substr(0,3))for(var f=d.c.match(a.kc),e=0;e<f.length;++e){var g=f[e],k=g.match(a.$a),h="";"%"==k[1]&&"timezone_offset"==k[2]?h=(new Date).getTimezoneOffset():"%"==k[1]&&"timestampz"==k[2]&&(h=a.Tb());d.c=d.c.replace(g,a.escape(h))}}};a.Tb=function(){var b=new Date,c=new Date(6e4*Math.abs(b.getTimezoneOffset()));return a.k(4,b.getFullYear())+"-"+a.k(2,b.getMonth()+1)+"-"+a.k(2,b.getDate())+"T"+a.k(2,b.getHours())+":"+a.k(2,b.getMinutes())+":"+a.k(2,b.getSeconds())+(0<b.getTimezoneOffset()?"-":"+")+a.k(2,c.getUTCHours())+":"+a.k(2,c.getUTCMinutes())};a.k=function(a,c){return(Array(a+1).join(0)+c).slice(-a)};a.qa={};a.doPostbacks=function(b){if("object"==typeof b)if(a.Pb(b),"object"==typeof a.AudienceManagement&&"function"==typeof a.AudienceManagement.isReady&&a.AudienceManagement.isReady()&&"function"==typeof a.AudienceManagement.passData)a.AudienceManagement.passData(b);else if("object"==typeof b&&"object"==typeof b.dests)for(var c=0;c<b.dests.length;++c){var d=b.dests[c];"object"==typeof d&&"string"==typeof d.c&&"string"==typeof d.id&&"aa."==d.id.substr(0,3)&&(a.qa[d.id]=new Image,a.qa[d.id].alt="",a.qa[d.id].src=d.c)}};a.jb=function(b){a.i||a.Xb();a.i.push(b);a.ja=a.A();a.Za()};a.Xb=function(){a.i=a.$b();a.i||(a.i=[])};a.$b=function(){var b,c;if(a.pa()){try{(c=h.localStorage.getItem(a.na()))&&(b=h.JSON.parse(c))}catch(d){}return b}};a.pa=function(){var b=!0;a.trackOffline&&a.offlineFilename&&h.localStorage&&h.JSON||(b=!1);return b};a.Pa=function(){var b=0;a.i&&(b=a.i.length);a.o&&b++;return b};a.U=function(){if(a.o&&(a.v&&a.v.complete&&a.v.C&&a.v.R(),a.o))return;a.Qa=q;if(a.oa)a.ja>a.N&&a.Xa(a.i),a.ra(500);else{var b=a.Jb();if(0<b)a.ra(b);else if(b=a.Na())a.o=1,a.ac(b),a.ec(b)}};a.ra=function(b){a.Qa||(b||(b=0),a.Qa=setTimeout(a.U,b))};a.Jb=function(){var b;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;b=a.A()-a.Va;return a.offlineThrottleDelay<b?0:a.offlineThrottleDelay-b};a.Na=function(){if(0<a.i.length)return a.i.shift()};a.ac=function(b){if(a.debugTracking){var c="AppMeasurement Debug: "+b;b=b.split("&");var d;for(d=0;d<b.length;d++)c+="\n\t"+a.unescape(b[d]);a.log(c)}};a.ya=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.X=!1;var t;try{t=JSON.parse('{"x":"y"}')}catch(v){t=null}t&&"y"==t.x?(a.X=!0,a.W=function(a){return JSON.parse(a)}):h.$&&h.$.parseJSON?(a.W=function(a){return h.$.parseJSON(a)},a.X=!0):a.W=function(){return null};a.ec=function(b){var c,d,f;a.rb(b)&&(d=1,c={send:function(b){a.useBeacon=!1;navigator.sendBeacon(b)?c.R():c.ha()}});!c&&a.ya()&&2047<b.length&&(a.eb()&&(d=2,c=new XMLHttpRequest),c&&(a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks)&&(a.X?c.Ia=!0:c=0));!c&&a.jc&&(b=b.substring(0,2047));!c&&a.d.createElement&&(0!=a.usePostbacks||a.AudienceManagement&&a.AudienceManagement.isReady())&&(c=a.d.createElement("SCRIPT"))&&"async"in c&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(c.type="text/javascript",c.setAttribute("async","async"),d=3):c=0);c||(c=new Image,d=4,c.alt="",c.abort||"undefined"===typeof h.InstallTrigger||(c.abort=function(){c.src=q}));c.Wa=Date.now();c.Ka=function(){try{c.C&&(clearTimeout(c.C),c.C=0)}catch(a){}};c.onload=c.R=function(){c.Wa&&(a.ka=Date.now()-c.Wa);a.kb(b);c.Ka();a.Nb();a.da();a.o=0;a.U();if(c.Ia){c.Ia=!1;try{a.doPostbacks(a.W(c.responseText))}catch(d){}}};c.onabort=c.onerror=c.ha=function(){c.Ka();(a.trackOffline||a.oa)&&a.o&&a.i.unshift(a.Mb);a.o=0;a.ja>a.N&&a.Xa(a.i);a.da();a.ra(500)};c.onreadystatechange=function(){4==c.readyState&&(200==c.status?c.R():c.ha())};a.Va=a.A();if(1===d)c.send(b);else if(2===d)f=b.indexOf("?"),d=b.substring(0,f),f=b.substring(f+1),f=f.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,""),c.open("POST",d,!0),c.withCredentials=!0,c.send(f);else if(c.src=b,3===d){if(a.Ta)try{f.removeChild(a.Ta)}catch(e){}f.firstChild?f.insertBefore(c,f.firstChild):f.appendChild(c);a.Ta=a.v}c.C=setTimeout(function(){c.C&&(c.complete?c.R():(a.trackOffline&&c.abort&&c.abort(),c.ha()))},5e3);a.Mb=b;a.v=h["s_i_"+a.replace(a.account,",","_")]=c;if(a.useForcedLinkTracking&&a.J||a.bodyClickFunction)a.forcedLinkTrackingTimeout||(a.forcedLinkTrackingTimeout=250),a.ea=setTimeout(a.da,a.forcedLinkTrackingTimeout)};a.rb=function(b){var c=!1;navigator.sendBeacon&&(a.tb(b)?c=!0:a.useBeacon&&(c=!0));a.Cb(b)&&(c=!1);return c};a.tb=function(a){return a&&0<a.indexOf("pe=lnk_e")?!0:!1};a.Cb=function(a){return 64e3<=a.length};a.eb=function(){return"undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?!0:!1};a.Nb=function(){if(a.pa()&&!(a.Ua>a.N))try{h.localStorage.removeItem(a.na()),a.Ua=a.A()}catch(b){}};a.Xa=function(b){if(a.pa()){a.Za();try{h.localStorage.setItem(a.na(),h.JSON.stringify(b)),a.N=a.A()}catch(c){}}};a.Za=function(){if(a.trackOffline){if(!a.offlineLimit||0>=a.offlineLimit)a.offlineLimit=10;for(;a.i.length>a.offlineLimit;)a.Na()}};a.forceOffline=function(){a.oa=!0};a.forceOnline=function(){a.oa=!1};a.na=function(){return a.offlineFilename+"-"+a.visitorNamespace+a.account};a.A=function(){return(new Date).getTime()};a.Ra=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(b){var c,d,f;a.fc=b;for(c=0;c<a._il.length;c++)if((d=a._il[c])&&"s_l"==d._c&&d.tagContainerName==b){a.S(d);if(d.lmq)for(c=0;c<d.lmq.length;c++)f=d.lmq[c],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(c in b=a[f],f=d.ml[f],f)!Object.prototype[c]&&("function"!=typeof f[c]||0>(""+f[c]).indexOf("s_c_il"))&&(b[c]=f[c]);if(d.mmq)for(c=0;c<d.mmq.length;c++)f=d.mmq[c],a[f.m]&&(b=a[f.m],b[f.f]&&"function"==typeof b[f.f]&&(f.a?b[f.f].apply(b,f.a):b[f.f].apply(b)));if(d.tq)for(c=0;c<d.tq.length;c++)a.track(d.tq[c]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(b,c,d,f){var e,g="";c||(c=a.pageURL?a.pageURL:h.location);d=d?d:"&";if(!b||!c)return g;c=""+c;e=c.indexOf("?");if(0>e)return g;c=d+c.substring(e+1)+d;if(!f||!(0<=c.indexOf(d+b+d)||0<=c.indexOf(d+b+"="+d))){e=c.indexOf("#");0<=e&&(c=c.substr(0,e)+d);e=c.indexOf(d+b+"=");if(0>e)return g;c=c.substring(e+d.length+b.length+1);e=c.indexOf(d);0<=e&&(c=c.substring(0,e));0<c.length&&(g=a.unescape(c));return g}},getIeVersion:function(){return document.documentMode?document.documentMode:a.za()?7:null}};a.D="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData contextData.cm.ssf contextData.opt.dmp contextData.opt.sell clientHints currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" ");a.g=a.D.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.la="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.O=a.la.slice(0);a.Ha="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout writeSecureCookies useLinkTrackSessionStorage collectHighEntropyUserAgentHints trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData useBeacon usePostbacks registerPreTrackCallback registerPostTrackCallback bodyClickTarget bodyClickFunction AudienceManagement".split(" ");for(m=0;250>=m;m++)76>m&&(a.g.push("prop"+m),a.O.push("prop"+m)),a.g.push("eVar"+m),a.O.push("eVar"+m),6>m&&a.g.push("hier"+m),4>m&&a.g.push("list"+m);m="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID ms_a".split(" ");a.g=a.g.concat(m);a.D=a.D.concat(m);a.ssl=0<=h.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.ta=["architecture","bitness","model","platformVersion","wow64"];a.writeSecureCookies=!1;a.collectHighEntropyUserAgentHints=!1;a.offlineThrottleDelay=0;a.offlineFilename="AppMeasurement.offline";a.P="s_sq";a.Va=0;a.ja=0;a.N=0;a.Ua=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=h;a.d=h.document;a.da=function(){a.ea&&(h.clearTimeout(a.ea),a.ea=q);a.bodyClickTarget&&a.J&&a.bodyClickTarget.dispatchEvent(a.J);a.bodyClickFunction&&("function"==typeof a.bodyClickFunction?a.bodyClickFunction():a.bodyClickTarget&&a.bodyClickTarget.href&&(a.d.location=a.bodyClickTarget.href));a.bodyClickTarget=a.J=a.bodyClickFunction=0};a.Ya=function(){a.b=a.d.body;a.b?(a.r=function(b){var c,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||b&&b["s_fe_"+a._in])){if(a.Ja)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.r,!1);else{a.b.removeEventListener("click",a.r,!0);a.Ja=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=b.srcElement?b.srcElement:b.target;try{if(!a.clickObject||a.M&&a.M==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||a.clickObject.parentNode))a.clickObject=0;else{var k=a.M=a.clickObject;a.ia&&(clearTimeout(a.ia),a.ia=0);a.ia=setTimeout(function(){a.M==k&&(a.M=0)},1e4);f=a.Pa();a.track();if(f<a.Pa()&&a.useForcedLinkTracking&&b.target){for(e=b.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.Ra(g)||(g=0),d=e.target,b.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||h.name&&d==h.name))){try{c=a.d.createEvent("MouseEvents")}catch(l){c=new h.MouseEvent}if(c){try{c.initMouseEvent("click",b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget)}catch(m){c=0}c&&(c["s_fe_"+a._in]=c.s_fe=1,b.stopPropagation(),b.stopImmediatePropagation&&b.stopImmediatePropagation(),b.preventDefault(),a.bodyClickTarget=b.target,a.J=c)}}}}}catch(n){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.r):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&h.MouseEvent)&&(a.Ja=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.r,!0)),a.b.addEventListener("click",a.r,!1))):setTimeout(a.Ya,30)};a.jc=a.za();a.Ob();a.qc||(r?a.setAccount(r):a.log("Error, missing Report Suite ID in AppMeasurement initialization"),a.Ya(),a.loadModule("ActivityMap"))};function s_gi(r){var a,h=window.s_c_il,q,p,m=r.split(","),s,u,t=0;if(h)for(q=0;!t&&q<h.length;){a=h[q];if("s_c"==a._c&&(a.account||a.oun))if(a.account&&a.account==r)t=1;else for(p=a.account?a.account:a.oun,p=a.allAccounts?a.allAccounts:p.split(","),s=0;s<m.length;s++)for(u=0;u<p.length;u++)m[s]==p[u]&&(t=1);q++}t?a.setAccount&&a.setAccount(r):a=new AppMeasurement(r);return a}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);function s_pgicq(){var r=window,a=r.s_giq,h,q,p;if(a)for(h=0;h<a.length;h++)q=a[h],p=s_gi(q.oun),p.setAccount(q.un),p.setTagContainer(q.tagContainerName);r.s_giq=0}s_pgicq();s_pgicq();module.exports={s_gi:s_gi,s_pgicq:s_pgicq}})()},{}],290:[function(require,module,exports){"use strict";var s_gi=require("./AppMeasurement").s_gi;var AppMeasurement=require("./AppMeasurement");function initialize(s_account){if(typeof s_account!=="string"){return}var s=s_gi(s_account);return s}module.exports=initialize},{"./AppMeasurement":289}],291:[function(require,module,exports){"use strict";function init(corePlugins,am){corePlugins.forEach(function(corePlugin){if(corePlugin.init){corePlugin.init(am)}else{corePlugin(am)}})}module.exports.init=init},{}],292:[function(require,module,exports){"use strict";var initSGI=require("./AppMeasurement/initialize");var initPlugins=require("./AppMeasurement/plugins");var app;function init(config){if(!config||app&&config.options.force!==true){return}app=window.s=initSGI(_modifyBucket(config.bucket));setDefaults(config,app);initPlugins.init(config.options.corePlugins,app);return app}function getInstance(){return app}function setDefaults(config,am){Object.keys(config).forEach(function(key){if(key!=="options"){am[key]=config[key]}});if(am.isSafariTopSitesPreview===true){am.t=function(){return""}}}function _modifyBucket(bucket){var dls=document.location.search;if(!bucket||typeof bucket!=="string"){bucket=""}if(dls&&bucket&&bucket.indexOf("applestoreww")===-1){if(dls.indexOf("?cid=AOS-")>-1||dls.indexOf("&cid=AOS-")>-1){bucket+=",applestoreww"}}return bucket}module.exports={init:init,getInstance:getInstance}},{"./AppMeasurement/initialize":290,"./AppMeasurement/plugins":291}],293:[function(require,module,exports){"use strict";var isNodeType=require("@marcom/ac-dom-nodes/isNodeType");var validate=require("./internal/validate");var ELEMENT=require("@marcom/ac-dom-nodes/NODE_TYPES").ELEMENT;module.exports=function ancestor(node,selector,inclusive,context){validate.childNode(node,"ancestors");validate.selector(selector,"ancestors");if(inclusive&&isNodeType(node,ELEMENT)&&(!selector||node.matches(selector))){return node}context=context||document.body;if(node!==context){while((node=node.parentNode)&&isNodeType(node,ELEMENT)){if(!selector||node.matches(selector)){return node}if(node===context){break}}}return null}},{"./internal/validate":294,"@marcom/ac-dom-nodes/NODE_TYPES":259,"@marcom/ac-dom-nodes/isNodeType":269}],294:[function(require,module,exports){"use strict";var isNodeType=require("@marcom/ac-dom-nodes/isNodeType");var NODE_TYPES=require("@marcom/ac-dom-nodes/NODE_TYPES");var COMMENT_NODE=NODE_TYPES.COMMENT;var DOCUMENT_FRAGMENT_NODE=NODE_TYPES.DOCUMENT_FRAGMENT;var DOCUMENT_NODE=NODE_TYPES.DOCUMENT;var ELEMENT_NODE=NODE_TYPES.ELEMENT;var TEXT_NODE=NODE_TYPES.TEXT;var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=" must be an Element, Document, or Document Fragment";var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=" must be an Element, TextNode, or Comment";var ERR_INVALID_SELECTOR=" must be a string";module.exports={parentNode:function(node,funcName){if(!node||!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+": "+"node"+ERR_INVALID_PARENT_NODE)}},childNode:function(node,funcName){if(!node||!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+": "+"node"+ERR_INVALID_CHILD_NODE)}},selector:function(selector,funcName,required){required=typeof required==="boolean"?required:false;if((selector||required)&&typeof selector!=="string"){throw new TypeError(funcName+": "+"selector"+ERR_INVALID_SELECTOR)}}}},{"@marcom/ac-dom-nodes/NODE_TYPES":259,"@marcom/ac-dom-nodes/isNodeType":269}],295:[function(require,module,exports){"use strict";module.exports=function isAncestorOf(ancestor,descendent){if(ancestor===descendent){return false}if("contains"in ancestor){return ancestor.contains(descendent)}else{return!!(ancestor.compareDocumentPosition(descendent)&Node.DOCUMENT_POSITION_CONTAINED_BY)}}},{}],296:[function(require,module,exports){const{defaultOptions,ElementEngagementObserver}=require("./element-engagement-observer/ElementEngagementObserver");module.exports={defaultOptions:defaultOptions,ElementEngagementObserver:ElementEngagementObserver}},{"./element-engagement-observer/ElementEngagementObserver":297}],297:[function(require,module,exports){const defaultOptions={titleDataAttribute:"analytics-element-engagement",dataAttribute:"analyticsElementEngagement",startDataAttribute:"analyticsElementEngagementStart",endDataAttribute:"analyticsElementEngagementEnd",target:document.body,startHandler:null,endHandler:null,evaluateHandler:null,track:null,engagementTimeThreshold:1e3,once:true,autoEnable:false};class ElementEngagementObserver{constructor(options={}){this.options={...defaultOptions,...options};this.observerType="elementEngagement";this.engagements={};if(this.options.autoEnable){this.enable()}}enable(){this.attachEventListeners()}disable(){this.detachEventListeners();for(const title in this.engagements){clearTimeout(this.engagements[title].timeout)}}attachEventListeners(){const{target}=this.options;let{[this.options.startDataAttribute]:startEvt,[this.options.endDataAttribute]:endEvt}=target.dataset;target.addEventListener(startEvt,this.startHandler.bind(this));target.addEventListener(endEvt,this.endHandler.bind(this))}detachEventListeners(){const{target}=this.options;let{[this.options.startDataAttribute]:startEvt,[this.options.endDataAttribute]:endEvt}=target.dataset;target.removeEventListener(startEvt,this.startHandler);target.removeEventListener(endEvt,this.endHandler)}startHandler(evt){const{detail}=evt;const{target}=detail||evt;const{dataset:{analyticsElementEngagement:engagementTitle}}=target;if(!engagementTitle)return;this.engagements[engagementTitle]=this.engagements[engagementTitle]||{};this.engagements[engagementTitle].timeout&&clearTimeout(this.engagements[engagementTitle].timeout);if(!this.options.once||!this.engagements[engagementTitle].hasFired){this.engagements[engagementTitle].timeout=setTimeout(()=>{this.track({engagementTitle:engagementTitle,target:target});if(this.options.once)this.engagements[engagementTitle].hasFired=true},this.options.engagementTimeThreshold)}}endHandler(evt){const{detail}=evt;const{target}=detail||evt;const{dataset:{analyticsElementEngagement:engagementTitle}}=target;if(!engagementTitle)return;this.engagements[engagementTitle]=this.engagements[engagementTitle]||{};this.engagements[engagementTitle].timeout&&clearTimeout(this.engagements[engagementTitle].timeout)}track(data){if(this.options.track&&typeof this.options.track==="function"){this.options.track(data)}}}module.exports={defaultOptions:defaultOptions,ElementEngagementObserver:ElementEngagementObserver}},{}],298:[function(require,module,exports){"use strict";module.exports={getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator}}},{}],299:[function(require,module,exports){"use strict";var os=require("@marcom/useragent-detect").os;var touchAvailable=require("./touchAvailable").original;var globalsHelper=require("./helpers/globals");var once=require("@marcom/function-utils/once");function isDesktop(){var windowObj=globalsHelper.getWindow();return!touchAvailable()&&!windowObj.orientation||os.windows}module.exports=once(isDesktop);module.exports.original=isDesktop},{"./helpers/globals":298,"./touchAvailable":302,"@marcom/function-utils/once":304,"@marcom/useragent-detect":308}],300:[function(require,module,exports){"use strict";var isDesktop=require("./isDesktop").original;var isTablet=require("./isTablet").original;var once=require("@marcom/function-utils/once");function isHandheld(){return!isDesktop()&&!isTablet()}module.exports=once(isHandheld);module.exports.original=isHandheld},{"./isDesktop":299,"./isTablet":301,"@marcom/function-utils/once":304}],301:[function(require,module,exports){"use strict";var isDesktop=require("./isDesktop").original;var globalsHelper=require("./helpers/globals");var once=require("@marcom/function-utils/once");var MIN_TABLET_WIDTH=600;function isTablet(){var windowObj=globalsHelper.getWindow();var width=windowObj.screen.width;if(windowObj.orientation&&windowObj.screen.height<width){width=windowObj.screen.height}return!isDesktop()&&width>=MIN_TABLET_WIDTH}module.exports=once(isTablet);module.exports.original=isTablet},{"./helpers/globals":298,"./isDesktop":299,"@marcom/function-utils/once":304}],302:[function(require,module,exports){"use strict";var globalsHelper=require("./helpers/globals");var once=require("@marcom/function-utils/once");function touchAvailable(){var windowObj=globalsHelper.getWindow();var documentObj=globalsHelper.getDocument();var navigatorObj=globalsHelper.getNavigator();return!!("ontouchstart"in windowObj||windowObj.DocumentTouch&&documentObj instanceof windowObj.DocumentTouch||navigatorObj.maxTouchPoints>0||navigatorObj.msMaxTouchPoints>0)}module.exports=once(touchAvailable);module.exports.original=touchAvailable},{"./helpers/globals":298,"@marcom/function-utils/once":304}],303:[function(require,module,exports){"use strict";var PARAM_ERROR_TEXT="Error: Expected parameter is missing or has the wrong type";var DEFAULT_OPTIONS={trailing:true,leading:false};function debounce(func,wait,options){if(typeof wait!=="number"||typeof func!=="function"){throw new TypeError(PARAM_ERROR_TEXT)}options=Object.assign({},DEFAULT_OPTIONS,options);if(typeof options.trailing!=="boolean"||typeof options.leading!=="boolean"){throw new TypeError(PARAM_ERROR_TEXT)}if(!options.trailing&&!options.leading){options.trailing=true}var timeout=null;var callsNumber=0;function debounced(){if(options.leading&&options.trailing){callsNumber++}var args=arguments;if(timeout===null&&options.leading){func.apply(this,args)}var later=function(){timeout=null;if(options.leading){if(callsNumber>1&&options.trailing){func.apply(this,args);callsNumber=0}}else{func.apply(this,args)}}.bind(this);clearTimeout(timeout);timeout=setTimeout(later,wait)}function cancel(){clearTimeout(timeout)}debounced.cancel=cancel;return debounced}module.exports=debounce},{}],304:[function(require,module,exports){"use strict";module.exports=function once(func){var result;return function(){if(typeof result==="undefined"){result=func.apply(this,arguments)}return result}}},{}],305:[function(require,module,exports){"use strict";module.exports=function defaults(dictionary){const res={};for(const key in dictionary){res[key]=dictionary[key].reduce(function(def,spec){def[spec.name]=false;return def},{version:{string:"",major:0,minor:0,patch:0,documentMode:false}})}return res}},{}],306:[function(require,module,exports){"use strict";module.exports={browser:[{name:"edge",userAgent:"Edge",version:["rv","Edge"],test:function(navigatorObj){return navigatorObj.ua.indexOf("Edge")>-1||navigatorObj.ua==="Mozilla/5.0 (Windows NT 10.0; Win64; x64)"}},{name:"edgeChromium",userAgent:"Edge",version:["rv","Edg"],test:function(navigatorObj){return navigatorObj.ua.indexOf("Edg")>-1&&navigatorObj.ua.indexOf("Edge")===-1}},{name:"chrome",userAgent:"Chrome"},{name:"firefox",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Opera")===-1},version:"Firefox"},{name:"android",userAgent:"Android"},{name:"safari",test:function(navigatorObj){return navigatorObj.ua.indexOf("Safari")>-1&&navigatorObj.vendor.indexOf("Apple")>-1},version:"Version"},{name:"ie",test:function(navigatorObj){return navigatorObj.ua.indexOf("IE")>-1||navigatorObj.ua.indexOf("Trident")>-1},version:["MSIE","rv"],parseDocumentMode:function(){let documentModeForIE=false;if(document.documentMode){documentModeForIE=parseInt(document.documentMode,10)}return documentModeForIE}},{name:"opera",userAgent:"Opera",version:["Version","Opera"]},{name:"samsung",userAgent:"SamsungBrowser"}],os:[{name:"windows",test:function(navigatorObj){return navigatorObj.ua.indexOf("Windows")>-1},version:"Windows NT"},{name:"osx",userAgent:"Mac",test:function(navigatorObj){return navigatorObj.ua.indexOf("Macintosh")>-1}},{name:"ios",test:function(navigatorObj){return navigatorObj.ua.indexOf("iPhone")>-1||navigatorObj.ua.indexOf("iPad")>-1},version:["iPhone OS","CPU OS"]},{name:"linux",userAgent:"Linux",test:function(navigatorObj){return(navigatorObj.ua.indexOf("Linux")>-1||navigatorObj.platform.indexOf("Linux")>-1)&&navigatorObj.ua.indexOf("Android")===-1}},{name:"fireos",test:function(navigatorObj){return navigatorObj.ua.indexOf("Firefox")>-1&&navigatorObj.ua.indexOf("Mobile")>-1},version:"rv"},{name:"android",userAgent:"Android",test:function(navigatorObj){return navigatorObj.ua.indexOf("Android")>-1}},{name:"chromeos",userAgent:"CrOS"}]}},{}],307:[function(require,module,exports){"use strict";const defaults=require("./defaults");const dictionary=require("./dictionary");function _matchVersionStrRegExp(str){return new RegExp(str+"[a-zA-Z\\s/:]+([0-9_.]+)","i")}function _parseVersion(data,ua){if(typeof data.parseVersion==="function"){return data.parseVersion(ua)}else{let versionSearchStr=data.version||data.userAgent;if(typeof versionSearchStr==="string"){versionSearchStr=[versionSearchStr]}const versionSearchStrLength=versionSearchStr.length;let match;for(let i=0;i<versionSearchStrLength;i++){match=ua.match(_matchVersionStrRegExp(versionSearchStr[i]));if(match&&match.length>1){return match[1].replace(/_/g,".")}}}return false}function _parseUserAgent(dictionaryData,defaultObj,navigatorObj){const dictionaryDataLength=dictionaryData.length;let current;let currentVersion;for(let i=0;i<dictionaryDataLength;i++){if(typeof dictionaryData[i].test==="function"){if(dictionaryData[i].test(navigatorObj)===true){current=dictionaryData[i].name}}else{if(navigatorObj.ua.indexOf(dictionaryData[i].userAgent)>-1){current=dictionaryData[i].name}}if(current){defaultObj[current]=true;currentVersion=_parseVersion(dictionaryData[i],navigatorObj.ua);if(typeof currentVersion==="string"){const versionBreakdown=currentVersion.split(".");defaultObj.version.string=currentVersion;if(versionBreakdown&&versionBreakdown.length>0){defaultObj.version.major=parseInt(versionBreakdown[0]||0);defaultObj.version.minor=parseInt(versionBreakdown[1]||0);defaultObj.version.patch=parseInt(versionBreakdown[2]||0)}}else if(current==="edge"){defaultObj.version.string="12.0.0";defaultObj.version.major="12";defaultObj.version.minor="0";defaultObj.version.patch="0"}if(typeof dictionaryData[i].parseDocumentMode==="function"){defaultObj.version.documentMode=dictionaryData[i].parseDocumentMode()}return defaultObj}}return defaultObj}function parseUserAgent(navigatorObj){const userAgent={};const fallback=defaults(dictionary);userAgent.browser=_parseUserAgent(dictionary.browser,fallback.browser,navigatorObj);userAgent.os=_parseUserAgent(dictionary.os,fallback.os,navigatorObj);return userAgent}module.exports=parseUserAgent},{"./defaults":305,"./dictionary":306}],308:[function(require,module,exports){"use strict";const envBrowser=typeof window!=="undefined";const navigator=envBrowser?window.navigator:{userAgent:"",platform:"",vendor:""};const navigatorObj={ua:navigator.userAgent,platform:navigator.platform,vendor:navigator.vendor};module.exports=require("./parseUserAgent")(navigatorObj)},{"./parseUserAgent":307}],309:[function(require,module,exports){const errorHandler=require("../ErrorHandler");const appMeasurementSetup=require("@marcom/appmeasurement-setup");const biscuitTin=require("@apple/analytics-biscuit-tin");const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const refreshDataLayer=require("../helpers/dataLayer").refresh;const eventsToString=require("../helpers/eventsToString");const formatter=require("../helpers/formatter");const passiveTrackerInit=require("@apple/analytics-passive-tracker").init;const triggerNewPage=require("@apple/analytics-passive-tracker").triggerNewPage;const generateSpecialExitLinks=require("../helpers/generateSpecialExitLinks");const submitMethods=require("./submit-methods/submitMethods");const templateVarHelper=require("../helpers/templateVar");const constants=require("../constants");const metaKey=constants.dataLayer.meta.key;const confKey=constants.dataLayer.configuration.key;const optionsKey=constants.dataLayer.configuration.optionsKey;const dlKeys=constants.dataLayer.configuration.keys;const doPlugins=require("./doPlugins/doPlugins");const corePlugins=require("./appMeasurementPlugins");const urlHelpers=require("@apple/analytics-utils").urlHelpers;const observerRegistry=require("../observers/observerRegistry");const cookie=require("../helpers/cookie");const defaultOptions={force:true,destroyObservers:false};const moduleName="AppMeasurementPlugin";class AppMeasurementPlugin{constructor(options){this.options={...defaultOptions,...options};this.conf={};this._bindMethods()}destroy(options){this.options={...defaultOptions,...options};this.destroyAppMeasurement();this.resetReferrer();this.resetLoadTiming();if(this.options.destroyObservers){this.destroyObservers(this.options)}}initialize(options){this.refreshData(options);passiveTrackerInit({muleVersion:"v1",cookieDomain:get(confKey)[dlKeys.trackingDomain]});if(errorHandler.exception){return}let data=this.getAppMeasurementConfig();if(errorHandler.exception){return}data=this.preAppMeasurementInit(data);if(errorHandler.exception){return}appMeasurementSetup.init(data)}refreshData(options){refreshDataLayer(options);this._prepareDataLayer();biscuitTin.retrieve()}_prepareDataLayer(){const items=get(metaKey);if(!this._hasRequiredData(items)){errorHandler.log(moduleName,"_prepareDataLayer","Missing required source data")}if(errorHandler.exception){return}Object.keys(items).forEach(key=>{this.conf[this._transformPropertyName(key)]=items[key]});this._setConfigurationProperty(dlKeys.pageName,this._getPageName(this.conf[dlKeys.track]));this._setConfigurationProperty(dlKeys.productName,this._getProductName(this.conf[dlKeys.track]));this._setConfigurationProperty(dlKeys.locale,this._getLocale(this.conf[dlKeys.track]));if(!this.conf[dlKeys.locale]){errorHandler.log(moduleName,"_prepareDataLayer","ISO code must be provided")}if(errorHandler.exception){return}this._setConfigurationProperty(dlKeys.pageType,this._getPageType(this.conf[dlKeys.pageName]));const pageUrl=urlHelpers.sanitizeUrl({url:document.location.href,pageType:this.conf[dlKeys.pageType]});this._setConfigurationProperty(dlKeys.pageURL,pageUrl);const pageUrlObj=new URL(pageUrl);this._setConfigurationProperty(dlKeys.queryString,pageUrlObj.search);this._setConfigurationProperty(dlKeys.pageURLNoQueryString,pageUrl.replace(pageUrlObj.search,""));let referrer=get([confKey,dlKeys.referrer]);if(!referrer){referrer=urlHelpers.sanitizeUrl({url:document.referrer,pageType:this.conf[dlKeys.pageType],isReferrerUrl:true})}this._setConfigurationProperty(dlKeys.referrer,referrer||"");this._setConfigurationProperty(dlKeys.searchTerm,this._getSearchTerm());this._setConfigurationProperty(dlKeys.initialTimeStamp,Date.now());this._setConfigurationProperty(dlKeys.platform,this._getPlatform());this._setConfigurationProperty(dlKeys.countryBuckets,constants.countryBuckets);this._setConfigurationProperty(dlKeys.subdomains,constants.subdomains);this._setConfigurationProperty(dlKeys.subdomainSupportedDomains,constants.supportedSubdomains);this._setConfigurationProperty(dlKeys.currencyCode,"USD");this._setConfigurationProperty(dlKeys.acAnalyticsVersion,constants.acAnalyticsVersion);this._setConfigurationProperty(dlKeys.trackingDomain,this.getTrackingDomain());this._setConfigurationProperty(dlKeys.cookieDomainPeriods,this.setCookieDomainPeriods());this._setConfigurationProperty(dlKeys.cookieLifetime,constants.cookieLifetime);this._setConfigurationProperty(dlKeys.clickTimerCount,0);this._setConfigurationProperty(dlKeys.clickTimerLinkInteraction,false);this._setConfigurationProperty(dlKeys.trackingServer,this.getTrackingServer());this._setConfigurationProperty(dlKeys.trackingServerSecure,this.getSecureTrackingServer());this._setConfigurationProperty(dlKeys.linkDownloadFileTypes,constants.linkDownloadFileTypes.join(","));if(errorHandler.exception){return}this.formattedValues={};const formattedLocale=this.conf.locale.toLowerCase();this.formattedValues.countryCodeFilter=formatter.countryCodeFilter(formattedLocale);this.formattedValues.legacyCountryCode=formatter.legacyCountryCode(formattedLocale);this.formattedValues.pageName=formatter.pageName(this.conf.pageName,formattedLocale);this.formattedValues.channel=formatter.channel(this.conf.channel,formattedLocale);this.formattedValues.productName=formatter.productName(this.conf.productName);this.formattedValues.campaign=this.conf.campaign;this._setConfigurationProperty(dlKeys.linkInternalFiltersLocale,this._getLinkInternalFiltersLocale(this.formattedValues.countryCodeFilter));this._setConfigurationProperty(dlKeys.computedCampaign,this.formattedValues.campaign);this._setConfigurationProperty(dlKeys.computedProductName,this.formattedValues.productName);this._setConfigurationProperty(dlKeys.computedPageName,this.formattedValues.pageName);this._setConfigurationProperty(dlKeys.legacyCountryCode,this.formattedValues.legacyCountryCode);this._setConfigurationProperty(dlKeys.countryCodeFilter,this.formattedValues.countryCodeFilter);set(confKey,this.conf);set(["pageDataModel","config","global","cookieDomain"],this.conf[dlKeys.trackingDomain]);this.templateVarArr=templateVarHelper.set();this._setConfigurationProperty(dlKeys.bucket,this._getBucket(this.conf,this.formattedValues.legacyCountryCode));set([confKey,dlKeys.bucket],this.conf.bucket);this.conf[dlKeys.computedChannel]=this._replaceTemplateVars(this.formattedValues.channel);set([confKey,dlKeys.computedChannel],this.conf.computedChannel);Object.keys(this.options).forEach(key=>{set([optionsKey,key],this.options[key])});this.conf={}}_setConfigurationProperty(property,value){if(typeof this.conf[property]==="undefined"){this.conf[property]=value}}_hasRequiredData(data){return!Object.values(data).some(val=>{return typeof val==="undefined"||val===""})}getAppMeasurementConfig(){const conf=get(confKey);const data={};data.acAnalytics={};data.options={};data.acAnalytics.version=conf[dlKeys.acAnalyticsVersion];data.acAnalytics.trackingDomain=data.Ia=conf[dlKeys.trackingDomain];data.cookieDomainPeriods=conf[dlKeys.cookieDomainPeriods];data.pageName=conf[dlKeys.computedPageName];data.bucket=conf[dlKeys.bucket];const extraReportSuite=window.localStorage.getItem("acAnalyticsValidationExtraReportSuite");if(extraReportSuite&&typeof extraReportSuite==="string"){if(!data.bucket.includes(extraReportSuite)){data.bucket+=`,${extraReportSuite}`}}data.channel=conf[dlKeys.computedChannel];data.currencyCode=conf[dlKeys.currencyCode];data.trackDownloadLinks=true;data.trackExternalLinks=true;data.trackInlineStats=true;data.useForcedLinkTracking=true;data.forcedLinkTrackingTimeout=100;data.linkDownloadFileTypes=conf[dlKeys.linkDownloadFileTypes];data.linkInternalFilters="tel:,mailto:,javascript:,"+data.acAnalytics.trackingDomain+","+data.acAnalytics.trackingDomain+"/media,"+data.acAnalytics.trackingDomain+"/105";data.linkLeaveQueryString=false;data._isSafari=false;data.usePlugins=true;data.doPlugins=doPlugins;data.cookieLifetime=conf[dlKeys.cookieLifetime];data.writeSecureCookies=true;data.trackingServer=conf[dlKeys.trackingServer];data.trackingServerSecure=conf[dlKeys.trackingServerSecure];const trackingServer=window.localStorage.getItem("acAnalyticsValidatationTrackingServer");if(trackingServer&&typeof trackingServer==="string"){data.trackingServerSecure=trackingServer}data.dc=this.getDataCenterId();let overrides={};if(conf&&conf.options){data.options=conf.options;if(conf.options.overrides){overrides=conf.options.overrides;Object.keys(data).forEach(key=>{data[key]=overrides[key]})}}data.options.corePlugins=corePlugins;return data}resetReferrer(){let referrer;if(this.options&&this.options.referrer){referrer=this.options.referrer}else{referrer=get([confKey,dlKeys.pageURL]);set([confKey,dlKeys.referrer],referrer)}}resetLoadTiming(){this.conf.loadTiming=Date.now()}destroyObservers(){observerRegistry.destroy()}preAppMeasurementInit(data){cookie.updateCookieOptions(data.acAnalytics.trackingDomain);set([confKey,dlKeys.specialExitLinks],generateSpecialExitLinks());return data}getTrackingDomain(){if(constants.domainRegex.test(window.location.hostname)){return"apple.com.cn"}else{return"apple.com"}}setCookieDomainPeriods(){if(constants.domainRegex.test(window.location.hostname)){return"3"}else{return"2"}}destroyAppMeasurement(){const appMeasurement=appMeasurementSetup.getInstance();triggerNewPage();if(typeof appMeasurement==="object"){appMeasurement.ac_amt.destroy();appMeasurement.manageVars("clearVars");appMeasurement.tcall=undefined;appMeasurement.pageURL=appMeasurement.g_prop6=appMeasurement.g_pageURL=appMeasurement.g_channel=""}}submit(trackingData){const appMeasurement=appMeasurementSetup.getInstance();if(!trackingData||typeof trackingData!=="object"){errorHandler.log(moduleName,"submit",`Request param (${trackingData}) is not an object`)}if(errorHandler.exception){return}if(!trackingData.type||typeof trackingData.type!=="string"){errorHandler.log(moduleName,"submit",`property "type" (${trackingData.type}") must be a string`)}if(!window.s||typeof window.s!=="object"){errorHandler.log(moduleName,"submit",`appMeasurement (${window.s}) is not an object`)}if(errorHandler.exception){return}if(trackingData.submitMethod&&submitMethods[trackingData.submitMethod]){this._setAppMeasurementProps(trackingData);submitMethods[trackingData.submitMethod](trackingData,get(confKey),appMeasurement)}}_getLinkInternalFiltersLocale(countryCodeFilter){let value="";if(countryCodeFilter!=="us"){value=countryCodeFilter}return value}_setAppMeasurementProps(trackingData){const beacon=trackingData.beacon||{};trackingData.linkTrackVars=[];const appMeasurement=appMeasurementSetup.getInstance();appMeasurement.linkTrackEvents="";for(const key in beacon){if(key==="events"){if(trackingData.type!=="page"){beacon[key]=eventsToString(beacon[key]);appMeasurement.linkTrackEvents=beacon[key].replace(/=([^,]+)/g,"")}}if(key!=="title"){if(trackingData.type!=="page"){trackingData.linkTrackVars.push(key)}appMeasurement[key]=beacon[key]}}}_getProductName(track){const analyticsPageTitle=this._strToArray(track);if(!Array.isArray(analyticsPageTitle)||analyticsPageTitle.length===0){errorHandler.log(moduleName,"_getProductname",'"track" meta tag value is malformed. e.g. "product name - page name"')}if(errorHandler.exception){return}return analyticsPageTitle[0].trim()}_getPageName(track){if(!track||track===""){errorHandler.log(moduleName,"_getPageName",'"track" meta tag value is malformed. e.g. "product name - page name"')}else if(track.match(/[^\S ]/g)){errorHandler.warn(moduleName,"_getPageName",'"track" meta tag value includes an invalid whitespace character, identified by the following regex: "[^\\S ]"')}if(errorHandler.exception){return}let pgEscaped=escape(track);pgEscaped=pgEscaped.replace(/(%u2018|%u2019|%u02BC|%u02BD)/g,"%27");pgEscaped=pgEscaped.replace(/(%u201C|%u201D|%E2%80%9C|%E2%80%9D)/g,"%22");pgEscaped=pgEscaped.replace(/(%09|%0A|%0D)/g,"");track=unescape(pgEscaped);return track.toLowerCase()}_getPageType(pageName){if(pageName==="search - results"){return"search"}else if(pageName==="404 - page not found"){return"errorPage"}else{return"normal"}}_getSearchTerm(){return window.location.pathname.split("/").filter(item=>item).pop()}_getLocale(){if(!document||!document.documentElement){return}const htmlEl=document.documentElement;const locale=htmlEl.getAttribute("data-locale")||htmlEl.lang;return locale}_getPlatform(){let value="other";const userAgent=navigator.userAgent;const patterns={"mobile other":"/(kindle|silk-accelerated|android|webos|rim tablet os|windows phone)/i",windows:/windows/i,"iphone/ipod touch":/(iphone|ipod)/i,ipad:/(ipad)/i,Mac:/Mac OS X/i};for(const key in patterns){if(userAgent.match(patterns[key])){value=key;break}}return value}_strToArray(str,separator){separator=separator||"-";if(typeof str!=="string"){errorHandler.log(moduleName,"_strToArray",str+" is not a valid string")}if(errorHandler.exception){return}return str.split(separator)}_transformPropertyName(name){const transformed=name.replace(/^s-/,"");return transformed.replace(/-+(.)?/g,function(match,character){return character?character.toUpperCase():""})}_getBucket(data,legacyCountryCode){const countryBucketSize=constants.countryBuckets.length;let index=2;for(let i=0;i<countryBucketSize;i++){if(constants.countryBuckets[i].indexOf(legacyCountryCode)!==-1){index=i;break}}const bucket=this._replaceTemplateVars(data["bucket"+index]);if(!bucket){errorHandler.log(moduleName,"bucket","analytics-s-bucket-"+index+" metadata tag must exist")}if(errorHandler.exception){return}const bucketProduct=this._replaceTemplateVars(data["bucketProduct"+index]);const bucketStore=this._replaceTemplateVars(data.bucketStore);return bucket+(bucketProduct?","+bucketProduct:"")+(bucketStore?","+bucketStore:"")}_replaceTemplateVars(str){return templateVarHelper.translate(str,this.templateVarArr)}isSafariTopSitesPreview(){if(navigator&&navigator.loadPurpose&&navigator.loadPurpose==="preview"){return true}return false}getTrackingServer(){return this._isProduction()?"metrics."+this.conf[dlKeys.trackingDomain]:window.location.hostname}getSecureTrackingServer(){return this._isProduction()?"securemetrics."+this.conf[dlKeys.trackingDomain]:window.location.hostname}getDataCenterId(){return 112}_isProduction(){const productionUrls=this.generateProdURLs();const hostname=window.location.host;if(productionUrls.indexOf(hostname)>-1){return true}return false}generateProdURLs(){const trackingDomain=this.conf[dlKeys.trackingDomain];const prodUrlsArr=[];const subdomainSupportedDomains=constants.supportedSubdomains||["apple.com"];const subdomains=constants.subdomains||["www"];if(subdomainSupportedDomains.indexOf(trackingDomain)!==-1){subdomains.forEach(function(subdomain){prodUrlsArr.push(subdomain+"."+trackingDomain)})}return prodUrlsArr}_bindMethods(){this._replaceTemplateVars=this._replaceTemplateVars.bind(this)}}module.exports=AppMeasurementPlugin},{"../ErrorHandler":356,"../constants":359,"../helpers/cookie":362,"../helpers/dataLayer":363,"../helpers/eventsToString":366,"../helpers/formatter":368,"../helpers/generateSpecialExitLinks":369,"../helpers/templateVar":383,"../observers/observerRegistry":396,"./appMeasurementPlugins":310,"./doPlugins/doPlugins":321,"./submit-methods/submitMethods":353,"@apple/analytics-biscuit-tin":27,"@apple/analytics-data-layer":46,"@apple/analytics-passive-tracker":126,"@apple/analytics-utils":190,"@marcom/appmeasurement-setup":288}],310:[function(require,module,exports){const plugins=[require("./appMeasurementPlugins/AppMeasurementTools"),require("./appMeasurementPlugins/utilities/utilities"),require("./appMeasurementPlugins/linkHandler"),require("./appMeasurementPlugins/getPercentPageViewed"),require("./appMeasurementPlugins/getQueryParam"),require("./appMeasurementPlugins/getValOnce"),require("./appMeasurementPlugins/activitymap/link"),require("./appMeasurementPlugins/activitymap/region"),require("./appMeasurementPlugins/activitymap/ActivityMapCollection")];module.exports=plugins},{"./appMeasurementPlugins/AppMeasurementTools":311,"./appMeasurementPlugins/activitymap/ActivityMapCollection":312,"./appMeasurementPlugins/activitymap/link":314,"./appMeasurementPlugins/activitymap/region":315,"./appMeasurementPlugins/getPercentPageViewed":316,"./appMeasurementPlugins/getQueryParam":317,"./appMeasurementPlugins/getValOnce":318,"./appMeasurementPlugins/linkHandler":319,"./appMeasurementPlugins/utilities/utilities":320}],311:[function(require,module,exports){"use strict";module.exports=function(am){if(am.ac_amt&&am.ac_amt._isEmpty&&am.ac_amt.eventListeners&&!am.ac_amt._isEmpty(am.ac_amt.eventListeners)&&am.ac_amt.destroy){am.ac_amt.destroy()}am.ac_amt={addListener:function(key,node,type,listener,options){if(!key||!node||!type||!listener){return}if(this.eventListeners[key]){this.removeListener(this.eventListeners[key])}this.eventListeners[key]={node:node,type:type,listener:listener};node.addEventListener(type,listener,options)},destroy:function(){this.removeListeners()},removeListeners:function(){if(this.eventListeners){for(const key in this.eventListeners){if(!this.eventListeners.hasOwnProperty(key)){continue}this.removeListener(key,this.eventListeners[key].node,this.eventListeners[key].type,this.eventListeners[key].listener)}this.eventListeners={}}},removeListener:function(key,node,type,listener){if(!key||!node||!type||!listener){return}node.removeEventListener(type,listener);delete this.eventListeners[key]},eventListeners:{},options:{reinitializeActivityMapCollection:true},_isEmpty:function(obj){for(const key in obj){if(obj.hasOwnProperty(key)){return false}}return true}}}},{}],312:[function(require,module,exports){"use strict";const _ancestor=require("@marcom/dom-traversal/ancestor");const _isAncestorOf=require("@marcom/dom-traversal/isAncestorOf");const _helpers=require("./helpers/helpers.js");const DELIMITER=" - ";function ActivityMapCollection(){this._regionSelectors=["[data-analytics-activitymap-region-id]","[data-analytics-section-engagement]","[data-card-analytics]"];this._globalRegionSelectors=['[data-analytics-region="buy strip"]',"#globalnav","#ac-globalnav","#ac-localnav","#ac-globalfooter","#chapternav"];this.createActivityMapCollection=this.createActivityMapCollection.bind(this);this.addElToCollection=this.addElToCollection.bind(this)}const proto=ActivityMapCollection.prototype;proto.init=function(am){this.AppMeasurement=am;if(this.AppMeasurement&&this.AppMeasurement.ac_amt){if(document.readyState!=="complete"&&document.readyState!=="interactive"&&this.AppMeasurement.ac_amt.addListener){this.AppMeasurement.ac_amt.addListener("amc_readystatechange",document,"readystatechange",event=>{if(event.target.readyState==="interactive"||event.target.readyState==="complete"){this.createActivityMapCollection()}})}else if(this.AppMeasurement.ac_amt.options&&this.AppMeasurement.ac_amt.options.reinitializeActivityMapCollection){this.createActivityMapCollection()}}};proto.createActivityMapCollection=function(){this.AppMeasurement=this.AppMeasurement||window.s;if(this.AppMeasurement){this.AppMeasurement.acAnalyticsActivityMapCollection=null;this.AppMeasurement.acAnalyticsActivityMapCollection=this._assembleActivityMapCollection()}};proto._createLinkData=function(node){const region=this._determineRegionName(node,this._globalRegionElements,this._regionSelectors);const linkId=this._createLinkId(node,region.id);const linkData={element:node,linkId:linkId,regionElement:region.el,regionName:region.id};return linkData};proto.addElToCollection=function(node){const linkData=this._createLinkData(node);return this._addToActivityMapCollection(linkData)};proto._addToActivityMapCollection=function(linkData){let noUniqueId=true;let duplicationNumber=0;let duplicationCheckStr;let duplicate;duplicate=this.AppMeasurement.acAnalyticsActivityMapCollection.filter(function(obj){return obj.linkId===linkData.linkId})[0];if(duplicate){duplicate.linkId=duplicate.linkId.concat(DELIMITER,"#",_helpers.prefixCharacters(1));linkData.linkId=linkData.linkId.concat(DELIMITER,"#",_helpers.prefixCharacters(2))}else{while(noUniqueId){duplicationNumber++;duplicationCheckStr=linkData.linkId.concat(DELIMITER,"#",_helpers.prefixCharacters(duplicationNumber));duplicate=this.AppMeasurement.acAnalyticsActivityMapCollection.filter(function(obj){return obj.linkId===duplicationCheckStr})[0];if(!duplicate){noUniqueId=false;if(duplicationNumber>1){linkData.linkId=duplicationCheckStr}}}}this.AppMeasurement.acAnalyticsActivityMapCollection.push(linkData)};proto._assembleActivityMapCollection=function(){this._globalRegionElements=_helpers.getGlobalElements(this._globalRegionSelectors);const linkEls=document.querySelectorAll("a, button");const collection=[];for(let j=0;j<linkEls.length;j++){const linkData=this._createLinkData(linkEls[j]);collection.push(linkData)}return this._renameDuplicateIds(collection)};proto._renameDuplicateIds=function(collection){const count={};const location={};for(let i=0;i<collection.length;i++){const currentId=collection[i].linkId;count[currentId]=count[currentId]?count[currentId]+1:1;if(count[currentId]>1){collection[i].linkId=collection[i].linkId+" - #"+_helpers.prefixCharacters(count[currentId])}else{location[currentId]=i}if(count[currentId]===2){collection[location[currentId]].linkId=collection[location[currentId]].linkId+" - #01"}}return collection};proto._determineRegionName=function(linkEl,globalRegionElements,regionSelectors){let regionEl=null;let regionId=null;for(let i=0;i<globalRegionElements.length;i++){if(_isAncestorOf(globalRegionElements[i],linkEl)&&!regionEl){regionEl=globalRegionElements[i];if(globalRegionElements[i].id==="ac-globalnav"){regionId=regionEl.getAttribute("data-analytics-region")||"global nav"}else{regionId=regionEl.id||regionEl.getAttribute("data-analytics-region")}}}if(!regionEl){regionEl=_ancestor(linkEl,regionSelectors.join(","),true);if(regionEl){const currentRegionSelector=regionSelectors.find(selector=>{return regionEl.hasAttribute(_helpers.removeArrayBrackets(selector))});regionId=regionEl.getAttribute(_helpers.removeArrayBrackets(currentRegionSelector));if(currentRegionSelector==="[data-analytics-section-engagement]"){regionId=regionId.replace("name:","")}}}if(!regionEl){regionEl=document.body;regionId="body"}return{el:regionEl,id:regionId.toLowerCase()}};proto._createLinkId=function(el,region){const linkText=_helpers.createLinkText(el);const linkHref=_helpers.createLinkHref(el,this.AppMeasurement);const linkRegion=_helpers.limitStrLength(region,40);const linkId=_helpers.createLinkId(linkText,linkHref,linkRegion,DELIMITER);return linkId.toLowerCase()};module.exports=new ActivityMapCollection},{"./helpers/helpers.js":313,"@marcom/dom-traversal/ancestor":293,"@marcom/dom-traversal/isAncestorOf":295}],313:[function(require,module,exports){"use strict";function Helpers(){this.createLinkId=this.createLinkId.bind(this)}const proto=Helpers.prototype;proto.prefixCharacters=function(id,numberOfCharacters,prefixCharacter){let prefix="";numberOfCharacters=numberOfCharacters||2;prefixCharacter=prefixCharacter||0;while(numberOfCharacters){prefix+=prefixCharacter;numberOfCharacters--}return prefix.substring(0,prefix.length-id.toString().length)+id};proto.limitStrLength=function(str,characters){return str.substring(0,characters).trim()};proto.removeArrayBrackets=function(str){if(str[0]==="["&&str[str.length-1]==="]"){return str.substr(1,str.length-2)}else{return str}};proto.getGlobalElements=function(arr){const storage=[];for(let i=0;i<arr.length;i++){const el=document.querySelector(arr[i]);if(el){storage.push(el)}}return storage};proto.createLinkText=function(el){let linkText=el.getAttribute("data-analytics-activitymap-link-id")||el.getAttribute("data-ac-gallery-trigger")||el.getAttribute("data-analytics-title")||this.removeSpecialChars(el.textContent)||el.id||el.tagName||"no text";return linkText=this.limitStrLength(linkText,50)};proto.createLinkHref=function(el,am){let externalLink;let linkHref;if(el.protocol&&el.protocol!=="http:"&&el.protocol!=="https:"){linkHref=el.protocol.substring(0,el.protocol.length-1)}else{if(el.hostname!==window.location.hostname&&el.hostname!=="www."+am.acAnalytics.trackingDomain){externalLink=el.hostname+el.pathname}linkHref=externalLink||el.hash||el.pathname||"no href"}return linkHref};proto.createLinkId=function(text,href,region,delimiter){let limitForHref;let trimmedHref;let linkId=text.concat(delimiter,href,delimiter,region);if(linkId.length>128){limitForHref=128-text.concat(delimiter,delimiter,region).length;trimmedHref=this.limitStrLength(href,limitForHref);linkId=text.concat(delimiter,trimmedHref,delimiter,region)}return linkId};proto.removeSpecialChars=function(strToClean){const charNotAllowedArr=["&rlm;","\\u200F","&#8207;","&#x200f;"];let cleanStr;if(strToClean){const regexStr=charNotAllowedArr.join("|");const regexNotAllowedChars=new RegExp(regexStr,"gi");cleanStr=strToClean.replace(regexNotAllowedChars,"").replace(/\s+/g," ").trim()}return cleanStr};module.exports=new Helpers},{}],314:[function(require,module,exports){"use strict";const ActivityMapCollection=require("./ActivityMapCollection");const useragent=require("@marcom/useragent-detect");const closeStr="close";const openStr="open";const initialBagState=useragent.browser.firefox||useragent.browser.ie?openStr:closeStr;const alteredBagState=useragent.browser.firefox||useragent.browser.ie?closeStr:openStr;module.exports=function(appMeasurement){appMeasurement.ActivityMap.link=function(linkElement,linkName){let activityMapItem;function findInCollection(el){return(appMeasurement.acAnalyticsActivityMapCollection||[]).filter(function(obj){return obj.element.isSameNode(el)})[0]}if(linkName){if(linkName.indexOf("v@e")!==-1||linkName.indexOf("v@sk")!==-1||linkName.indexOf("v@m")!==-1){return}}if(!linkElement){return}if(linkElement.hasAttribute("data-analytics-ignore-link")){return}activityMapItem=findInCollection(linkElement);if(activityMapItem){if(activityMapItem.linkId.indexOf("/shop/goto/bag")!==-1){const path=getPath(activityMapItem.element.href);if(activityMapItem.element.getAttribute("aria-expanded")==="true"){return getBagString(initialBagState,path)}else{return getBagString(alteredBagState,path)}}return activityMapItem.linkId}ActivityMapCollection.addElToCollection(linkElement);activityMapItem=findInCollection(linkElement);if(activityMapItem){return activityMapItem.linkId}}};function getPath(href){return href.replace(/.+\.com(\.cn)?/,"")}function getBagString(action,path){return`${action} - bag - ${path} - globalnav - ${action}`}},{"./ActivityMapCollection":312,"@marcom/useragent-detect":308}],315:[function(require,module,exports){"use strict";module.exports=function(appMeasurement){appMeasurement.ActivityMap.region=function(el){if(!el){return}const result=appMeasurement.acAnalyticsActivityMapCollection.filter(function(obj){return obj.element.isSameNode(el)})[0];if(result){return result.regionName}}}},{}],316:[function(require,module,exports){"use strict";const isStorageAvailable=require("../../helpers/isStorageAvailable");const SESSION_STORAGE=require("../../constants").sessionStorage;module.exports=function(appMeasurement){if(!isStorageAvailable(SESSION_STORAGE)){return}appMeasurement.getPercentPageViewed=function(){if(typeof s.linkType==="undefined"){try{s.ppv.previous=sessionStorage.getItem(s.ppv.sessionStorageKey)?sessionStorage.getItem(s.ppv.sessionStorageKey):""}catch(a){}s.ppv.init();return s.ppv.previous.split(",")}if(!s.ppv.previous){try{s.ppv.previous=sessionStorage.getItem(s.ppv.sessionStorageKey)||""}catch(a){}s.ppv.init();return s.ppv.previous.split(",")}};appMeasurement.ppv={initialPercent:0,maxPercent:0,throttleAmount:500,sessionStorageKey:"s_ppv",init:function(){const useCapture=!1;if(s&&s.ac_amt&&s.ac_amt.addListener){s.ac_amt.addListener("ppv_scroll",window,"scroll",s.ppv.throttle(s.ppv.scroll,s.ppv.throttleAmount),useCapture);s.ac_amt.addListener("ppv_resize",window,"resize",s.ppv.throttle(s.ppv.scroll,s.ppv.throttleAmount),useCapture);s.ac_amt.addListener("ppv_beforeunload",window,"beforeunload",s.ppv.unload,useCapture);if(document.readyState!=="complete"){s.ac_amt.addListener("ppv_load",window,"load",s.ppv.scroll,useCapture)}else{s.ppv.scroll()}}},scroll:function(){const a=s.ppv;if(a.maxPercent!==100){const g=void 0!==window.pageYOffset?window.pageYOffset:document.documentElement||document.body.parentNode||document.body.scrollTop;const d=document.clientHeight||document.documentElement.clientHeight||document.body.clientHeight;let b=a.getDocHeight();b=Math.round((g+d)/b*100);a.initialPercent||(a.initialPercent=b);if(b>a.maxPercent){a.maxPercent=b;const c=[];c.push(s.pageName);c.push(b);c.push(a.initialPercent);c.push(g+d);try{sessionStorage.setItem(a.sessionStorageKey,c.join(","))}catch(e){}}}},getDocHeight:function(){const a=window.document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))},unload:function(){try{sessionStorage.getItem(s.ppv.sessionStorageKey)&&sessionStorage.setItem(s.ppv.sessionStorageKey,sessionStorage.getItem(s.ppv.sessionStorageKey))}catch(a){}},throttle:function(a,g){let d;let b;let c;let e=null;let f=0;const l=function(){f=new Date;e=null;c=a.apply(d,b)};return function(){const h=new Date;f||(f=h);const k=g-(h-f);b=arguments;k<=0?(clearTimeout(e),e=null,f=h,c=a.apply(this,b)):e||(e=setTimeout(l,k));return c}}}}},{"../../constants":359,"../../helpers/isStorageAvailable":375}],317:[function(require,module,exports){"use strict";module.exports=function(appMeasurement){appMeasurement.getQueryParam=appMeasurement.Util.getQueryParam}},{}],318:[function(require,module,exports){"use strict";module.exports=function(appMeasurement){appMeasurement.getValOnce=function(sPropertyValue,cookieName,expirationInDays,useMinutesInsteadOfDays){sPropertyValue=sPropertyValue||"";cookieName=cookieName||"s_gvo";expirationInDays=expirationInDays||0;const previousCookieValue=this.c_r(cookieName);if(sPropertyValue){let expirationDate=0;if(expirationInDays!==0){expirationDate=new Date;const expirationMultiplier=useMinutesInsteadOfDays==="m"?6e4:864e5;const expirationDuration=expirationInDays*expirationMultiplier;expirationDate.setTime(expirationDate.getTime()+expirationDuration)}this.c_w(cookieName,sPropertyValue,expirationDate)}return sPropertyValue===previousCookieValue?"":sPropertyValue}}},{}],319:[function(require,module,exports){"use strict";module.exports=function(appMeasurement){appMeasurement.p_gn=function(t,h){var i=t?t.indexOf("~"):-1,n,x;if(t&&h){n=i<0?"":t.substring(0,i);x=t.substring(i+1);if(h.indexOf(x.toLowerCase())>-1)return n?n:"[["}return 0};appMeasurement.p_gh=function(){var s=this;if(s.linkObject)return s.linkObject.href;if(!s.eo&&!s.lnk)return"";var o=s.eo?s.eo:s.lnk,y=s.ot(o),n=s.oid(o),x=o.s_oidt;if(s.eo&&o==s.eo)while(o&&!n&&y!="BODY"){o=o.parentElement?o.parentElement:o.parentNode;if(!o)return"";y=s.ot(o);n=s.oid(o);x=o.s_oidt}return o.href?o.href:""};appMeasurement.pt=function(x,d,f,a){var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:""}return""};appMeasurement.linkHandler=function(p,t,e){var s=this,o=s.p_gh(),h=o,i,l;t=t?t:"o";if(!h||s.linkType&&(h||s.linkName))return"";i=h.indexOf("?");h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.pt(p,"|","p_gn",h.toLowerCase());if(l){s.linkName=l=="[["?"":l;s.linkType=t;return e?o:h}return""}}},{}],320:[function(require,module,exports){"use strict";module.exports=function(appMeasurement){appMeasurement.manageVars=function(c,l,f){var s=this,vl,la,vla;l=l?l:"";f=f?f:1;if(!s[c])return false;vl="pageName,purchaseID,channel,server,pageType,campaign,state,zip,events,products,transactionID";for(var n=1;n<76;n++)vl+=",prop"+n;for(var n=1;n<251;n++)vl+=",eVar"+n;for(n=1;n<6;n++)vl+=",hier"+n;for(n=1;n<4;n++)vl+=",list"+n;for(n in s.contextData)vl+=",contextData."+n;if(l&&(f==1||f==2)){if(f==1)vl=l.replace("['",".").replace("']","");if(f==2){la=l.split(",");vla=vl.split(",");vl="";for(var x in la){if(la.hasOwnProperty(x)){if(la[x].indexOf("contextData")>-1){lax=la[x].split("'");la[x]="contextData."+lax[1]}for(var y in vla)if(la[x]==vla[y])vla[y]=""}}for(var y in vla)vl+=vla[y]?","+vla[y]:""}s.pt(vl,",",c,0);return true}else if(l==""&&f==1){s.pt(vl,",",c,0);return true}else return false};appMeasurement.clearVars=function(t){var s=this;if(t.indexOf("contextData")==-1)s[t]="";else if(t.indexOf("contextData")>-1){var c=t.substring(t.indexOf(".")+1);s.contextData[c]=""}};appMeasurement.lowercaseVars=function(t){var s=this;if(t!="events"&&t.indexOf("contextData")==-1&&s[t]){s[t]=s[t].toString();if(s[t].indexOf("D=")!=0)s[t]=s[t].toLowerCase()}else if(t.indexOf("contextData")>-1){var c=t.substring(t.indexOf(".")+1);if(s.contextData[c]){s.contextData[c]=s.contextData[c].toString();s.contextData[c]=s.contextData[c].toLowerCase()}}};appMeasurement.pt=function(x,d,f,a){var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:""}return""};appMeasurement.join=function(v,p){var s=this;var f,b,d,w;if(p){f=p.front?p.front:"";b=p.back?p.back:"";d=p.delim?p.delim:"";w=p.wrap?p.wrap:""}var str="";for(var x=0;x<v.length;x++){if(typeof v[x]=="object")str+=s.join(v[x],p);else str+=w+v[x]+w;if(x<v.length-1)str+=d}return f+str+b};appMeasurement.apl=function(L,v,d,u){var s=this,m=0;if(!L)L="";if(u){var i,n,a=s.split(L,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?n==v:n.toLowerCase()==v.toLowerCase())}}if(!m)L=L?L+d+v:v;return L};appMeasurement.split=function(l,d){var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length)}return a}}},{}],321:[function(require,module,exports){const doPluginsRegistry=require("./doPluginsRegistry");function doPlugins(am){doPluginsRegistry.run(am)}module.exports=doPlugins},{"./doPluginsRegistry":322}],322:[function(require,module,exports){class DoPluginsPhase{constructor(name){this.name=name;this.steps=[]}}class DoPluginsStage{constructor(name,phases){this.name=name;this.phases=phases;this.phases.forEach(phase=>{this[phase.name]=phase})}}class DoPluginsRegistry{constructor(stages){this.stages=stages;this.stages.forEach(stage=>{this[stage.name]=stage})}run(am){this.stages.forEach(stage=>{if(stage.phases){stage.phases.forEach(phase=>{if(phase.steps){phase.steps.forEach(step=>{step(am)})}})}})}}const doPluginsRegistry=new DoPluginsRegistry([new DoPluginsStage("pretracking",[new DoPluginsPhase("initialize"),new DoPluginsPhase("main"),new DoPluginsPhase("finalize")]),new DoPluginsStage("tracking",[new DoPluginsPhase("initialize"),new DoPluginsPhase("sideEffects"),new DoPluginsPhase("main"),new DoPluginsPhase("finalize"),new DoPluginsPhase("sanitize")]),new DoPluginsStage("cleanup",[new DoPluginsPhase("initialize"),new DoPluginsPhase("main"),new DoPluginsPhase("finalize")])]);const trackingState=require("./plugins/trackingState");doPluginsRegistry.pretracking.main.steps.push(require("./plugins/referrerQueryParam"));doPluginsRegistry.tracking.sideEffects.steps.push(require("./plugins/handleLink"),require("./plugins/specialRssLinks"));doPluginsRegistry.tracking.main.steps.push(trackingState.begin,require("./plugins/acAnalyticsVersion"),require("./plugins/externalCampaign"),require("./plugins/internalCampaign"),require("./plugins/percentPageViewed"),require("./plugins/afid"),require("./plugins/retailCookies"),require("./plugins/feedbackPage"),require("./plugins/contactRetail"),require("./plugins/asTex"),require("./plugins/enhanceDownloadLinks"),require("./plugins/langLocale"),require("./plugins/userSignInStatus"),require("./plugins/pageName"),require("./plugins/asPvi"),require("./plugins/hierarchy1"),require("./plugins/referrerAndCurrentUrl"),require("./plugins/clickTimer"),require("./plugins/beaconType"),require("./plugins/linkMissingTitle"));doPluginsRegistry.tracking.finalize.steps.push(require("./plugins/passiveTracker"),require("./plugins/newPassiveTracker"));doPluginsRegistry.tracking.sanitize.steps.push(require("./plugins/removeSpacesInLinkTrackVars"),require("./plugins/manageVars"));doPluginsRegistry.cleanup.main.steps.push(require("./plugins/clearLinkTracksAfterDownloadAndExit"));doPluginsRegistry.cleanup.finalize.steps.push(trackingState.end,require("./plugins/setTcallToFalse"));module.exports=doPluginsRegistry},{"./plugins/acAnalyticsVersion":324,"./plugins/afid":325,"./plugins/asPvi":326,"./plugins/asTex":327,"./plugins/beaconType":328,"./plugins/clearLinkTracksAfterDownloadAndExit":329,"./plugins/clickTimer":330,"./plugins/contactRetail":331,"./plugins/enhanceDownloadLinks":332,"./plugins/externalCampaign":333,"./plugins/feedbackPage":334,"./plugins/handleLink":335,"./plugins/hierarchy1":336,"./plugins/internalCampaign":337,"./plugins/langLocale":338,"./plugins/linkMissingTitle":339,"./plugins/manageVars":340,"./plugins/newPassiveTracker":341,"./plugins/pageName":342,"./plugins/passiveTracker":343,"./plugins/percentPageViewed":344,"./plugins/referrerAndCurrentUrl":345,"./plugins/referrerQueryParam":346,"./plugins/removeSpacesInLinkTrackVars":347,"./plugins/retailCookies":348,"./plugins/setTcallToFalse":349,"./plugins/specialRssLinks":350,"./plugins/trackingState":351,"./plugins/userSignInStatus":352}],323:[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const dataLayerConfig=require("../../constants").dataLayer.configuration;const isIntraPageLink=require("../../helpers/DOM").isIntraPageLink;function getReferrer(){return get([dataLayerConfig.key,dataLayerConfig.keys.referrer])||document.referrer||""}function setReferrer(val){set([dataLayerConfig.key,dataLayerConfig.keys.referrer],val)}function isMicroEvent(am){return!!am.linkType}function isPageLoad(am){return am.tcall}function isExitLink(am){return am.linkType==="e"}function appendList(am,str,data,separator=",",caseSensitive=1){if(typeof data==="string"){data=[data]}if(typeof am[str]!=="string"){am[str]=JSON.stringify(am[str])}data.forEach(val=>{am[str]=am.apl(am[str],val,separator,caseSensitive)})}function isTracking(am){return isPageLoad(am)||isMicroEvent(am)}function isOutgoingLink(am){return!isIntraPageLink(am.linkObject)}function getPropertyRegex(am,...args){const suffix="(\\d+?)?$";let propMatchString="";Array.prototype.forEach.call(arguments,(arg,idx)=>{if(idx!==0)propMatchString+=propMatchString?`|${arg}`:`(${arg}`});propMatchString+=`)${suffix}`;const propertyRegex=new RegExp(propMatchString);return propertyRegex}function getAppMeasurementProperties(am,...args){const propertyRegex=getPropertyRegex.apply(null,arguments);const keys=[];for(const key in am){if(propertyRegex.test(key)){keys.push(key)}}return keys}function sanitizeProperties(am,matchRegex,propertiesString){let properties=propertiesString.split(",");properties.unshift(am);properties=getAppMeasurementProperties.apply(null,properties);properties.forEach(property=>{am[property]=am[property].replace(matchRegex," ")})}module.exports={isMicroEvent:isMicroEvent,isPageLoad:isPageLoad,isExitLink:isExitLink,isTracking:isTracking,appendList:appendList,getReferrer:getReferrer,setReferrer:setReferrer,isOutgoingLink:isOutgoingLink,sanitizeProperties:sanitizeProperties}},{"../../constants":359,"../../helpers/DOM":361,"@apple/analytics-data-layer":46}],324:[function(require,module,exports){const{isPageLoad}=require("../helpers");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;function acAnalyticsVersion(am){if(!isPageLoad(am)){return}const version=get([dataLayerConfig.key,dataLayerConfig.keys.acAnalyticsVersion]);if(!version){return}am.server=`ac-${version}`}module.exports=acAnalyticsVersion},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],325:[function(require,module,exports){const{isPageLoad}=require("../helpers");const propName="eVar10";function afid(am){if(!isPageLoad(am)){return}const data=am.getQueryParam("afid");if(data){am[propName]=am.getValOnce(data,"s_afc")}}module.exports=afid},{"../helpers":323}],326:[function(require,module,exports){const{isPageLoad,isMicroEvent,appendList}=require("../helpers");const trackingProp="prop51";const cookieName="as_pvi";function asPvi(am){if(isPageLoad(am)){const cookieValue=am.Util.cookieRead(cookieName);if(cookieValue){am[trackingProp]=cookieValue}}else if(isMicroEvent(am)){if(am[trackingProp]){appendList(am,"linkTrackVars",trackingProp)}}}module.exports=asPvi},{"../helpers":323}],327:[function(require,module,exports){const{isTracking,isMicroEvent,appendList}=require("../helpers");const propName="list3";const propData="D=as_tex";function asTex(am){if(!isTracking(am)){return}am[propName]=propData;if(isMicroEvent(am)){appendList(am,"linkTrackVars",propName)}}module.exports=asTex},{"../helpers":323}],328:[function(require,module,exports){const{isPageLoad,isMicroEvent,appendList}=require("../helpers");const propName="eVar97";const pageLoadIdentifer="s.t-p";const microEventIndentifer="s.tl-";function beaconType(am){if(isPageLoad(am)){am[propName]=pageLoadIdentifer}else if(isMicroEvent(am)){am[propName]=`${microEventIndentifer}${am.linkType}`;appendList(am,"linkTrackVars",propName)}}module.exports=beaconType},{"../helpers":323}],329:[function(require,module,exports){function clearLinkTracksAfterDownloadAndExit(am){if(am.linkType==="d"||am.linkType==="e"){am.bodyClickFunction=function(am){am.linkTrackVars="";am.linkTrackEvents=""}.bind(null,am)}}module.exports=clearLinkTracksAfterDownloadAndExit},{}],330:[function(require,module,exports){const utils=require("@apple/analytics-utils");const mergeIntoDeferredBeacon=require("../../../helpers/mergeIntoDeferredBeacon");const beaconHelpers=utils.beaconHelpers;const toStr=utils.toStr;const isOutgoingLink=require("../helpers").isOutgoingLink;const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const dataLayerKeys=require("../../../constants").dataLayer;const confKey=dataLayerKeys.configuration.key;const confKeys=dataLayerKeys.configuration.keys;const clickCount=[confKey,confKeys.clickTimerCount];const linkInteraction=[confKey,confKeys.clickTimerLinkInteraction];const loadTiming=[confKey,confKeys.loadTiming];const COUNT_PROP="eVar93";const TIME_PROP="eVar94";const TIME_EVENT="event210";const TIME_EVENT_COUNTER="event246";const INVALID_EVENT="event242";const CLICK_TIME_THRESHOLD=900;function trackClickTime(am){if(am.linkName){if(am.linkName.indexOf("v@e")!==-1||am.linkName.indexOf("v@sk")!==-1||am.linkName.indexOf("v@m")!==-1){return}}if(am.tcall){_track(am);return}if(isOutgoingLink(am)&&!(am.linkType==="e"||am.linkType==="d")){_storeData(am);return}if(get(linkInteraction)&&am.linkName){_track(am);return}if(am.linkObject){if(am.linkType==="d"||am.linkType==="e"){_track(am);return}set(linkInteraction,true)}}function _track(am){if(!am.tcall){_incrementClickTimer();const data=_createDataObject(am);set(linkInteraction,false);if(data){_applyData(am,data)}}}function _storeData(am){_incrementClickTimer();const legacyData=_createDataObject(am);const newData={};newData.events=JSON.parse(JSON.stringify(legacyData.events));newData.events=newData.events.join(",");newData[COUNT_PROP]=legacyData[COUNT_PROP];newData[TIME_PROP]=legacyData[TIME_PROP];if(beaconHelpers.isNotEmpty(newData)){mergeIntoDeferredBeacon(_sanitizeBeacon(newData))}}function _applyData(am,data){if(data[COUNT_PROP]){am[COUNT_PROP]=data[COUNT_PROP]}if(data[TIME_PROP]){am[TIME_PROP]=data[TIME_PROP]}if(data.events){_applyEventsData(am,data.events)}if(!am.tcall){if(typeof data.linkTrackEvents!=="undefined"){data.linkTrackEvents.forEach(function(event){am.linkTrackEvents=am.apl(am.linkTrackEvents,event,",",1)})}if(typeof data.linkTrackVars!=="undefined"){data.linkTrackVars.forEach(function(prop){am.linkTrackVars=am.apl(am.linkTrackVars,prop,",",1)})}}}function _createDataObject(){const time=_getTimeSinceLoad();const data={linkTrackVars:[],linkTrackEvents:[],events:[]};if(time!==null){data.events.push(TIME_EVENT_COUNTER);data.events.push(TIME_EVENT+"="+time);data.linkTrackVars.push(TIME_PROP);data.linkTrackEvents.push(TIME_EVENT,TIME_EVENT_COUNTER);data[TIME_PROP]=time}else{data.events.push(INVALID_EVENT);data.linkTrackEvents.push(INVALID_EVENT)}data[COUNT_PROP]=get(clickCount);data.linkTrackVars.push(COUNT_PROP);data.linkTrackVars.push("events");return data}function _incrementClickTimer(){let count=get(clickCount);if(count){count++}else{count=1}set(clickCount,count)}function _applyEventCounter(am,event){if(!event){return}am.events=am.apl(am.events,event,",",1)}function _applyEventWithValue(am,event){if(!event){return}const trackedEventsKeys={};const eventName=event.split("=")[0];const trackedEvents=am.events.split(",");trackedEvents.forEach(function(trackedEvent,index){trackedEventsKeys[trackedEvent.split("=")[0]]=index});if(isNaN(trackedEventsKeys[eventName])){am.events=am.apl(am.events,event,",",1);return}trackedEvents.splice(trackedEventsKeys[eventName],1,event);am.events=trackedEvents.join(",")}function _applyEventsData(am,events){if(typeof am.events!=="string"&&typeof am.events!=="undefined"){return}events.forEach(function(event){if(event.indexOf("=")===-1){_applyEventCounter(am,event)}else{_applyEventWithValue(am,event)}})}function _getTimeSinceLoad(){let loadTime=get(loadTiming);if(!loadTime){if(window&&window.performance&&window.performance.timing&&window.performance.timing.domInteractive){loadTime=window.performance.timing.domInteractive}else{return null}}let time=((Date.now()-loadTime)/1e3).toFixed(2);if(isNaN(time)){return null}time=parseFloat(time);if(time>=CLICK_TIME_THRESHOLD||time<=0){return null}return time}function _sanitizeBeacon(beacon){Object.keys(beacon).forEach(function(key){const type=key.substring(0,4);const value=toStr(beacon[key]);if(type==="prop"){beacon[key]=value.substring(0,100)}else if(type==="eVar"){beacon[key]=value.substring(0,250)}});return beacon}module.exports=trackClickTime},{"../../../constants":359,"../../../helpers/mergeIntoDeferredBeacon":376,"../helpers":323,"@apple/analytics-data-layer":46,"@apple/analytics-utils":190}],331:[function(require,module,exports){const appendList=require("../helpers").appendList;const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const contactRetailProp="prop41";function contactRetail(am){if(am.linkType==="e"&&am.linkName==="contactretail"){let region="none";if(am.ActivityMap&&am.ActivityMap.region&&am.linkObject){region=am.ActivityMap.region(am.linkObject)}const pageName=get([dataLayerConfig.key,dataLayerConfig.keys.computedPageName])||"none";am[contactRetailProp]=`open | apple chat | ${region} | ${pageName}`;appendList(am,"linkTrackVars",contactRetailProp)}}module.exports=contactRetail},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],332:[function(require,module,exports){const appendList=require("../helpers").appendList;const downloadEvent="event5";const interactionTrackingProp="prop16";const interactionTrackingVar="eVar16";function enhanceDownloadLinks(am){if(am.linkType==="d"&&am.linkURL){if(am.linkURL.match(/\.rss|\.xml/)){am[interactionTrackingVar]=am[interactionTrackingProp]="sign ups"}else{am[interactionTrackingVar]=am[interactionTrackingProp]="downloads";appendList(am,"events",downloadEvent);appendList(am,"linkTrackVars","events");appendList(am,"linkTrackEvents",downloadEvent)}appendList(am,"linkTrackVars",[interactionTrackingVar,interactionTrackingProp])}}module.exports=enhanceDownloadLinks},{"../helpers":323}],333:[function(require,module,exports){const{isPageLoad,setReferrer}=require("../helpers");const propName="campaign";const cookieName="s_campaign";const queryParam="cid";const regexPattern=/OAS-.+?-DOMAINS-/i;function externalCampaign(am){if(!isPageLoad(am)){return}if(!am[propName]){am[propName]=am.getQueryParam(queryParam);if(am[propName].match(regexPattern)){setReferrer("http://"+am[propName].replace(regexPattern,""))}}am[propName]=am.getValOnce(am[propName],cookieName,0)}module.exports=externalCampaign},{"../helpers":323}],334:[function(require,module,exports){const isPageLoad=require("../helpers").isPageLoad;const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const trackingProp="prop16";const trackingVar="eVar16";function feedbackPage(am){const pageName=get([dataLayerConfig.key,dataLayerConfig.keys.pageName]);if(isPageLoad){if(pageName.match(/feedback - thank you/)){am[trackingProp]=am[trackingVar]="feedback"}}}module.exports=feedbackPage},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],335:[function(require,module,exports){const{isPageLoad,appendList}=require("../helpers");const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const parseFromDataAttribute=require("../../../helpers/parseFromDataAttribute");const{isOutgoingLink}=require("../helpers");const passiveTrackerInput=require("../../../passiveTracker");function handleLink(am){if(isPageLoad(am)||!am.linkObject||am.linkObject.tagName!=="A"){return}cancelFalseExitLink(am);specialExitLink(am);exitLinkAttribute(am);shoppingBag(am);passiveLink(am)}function cancelFalseExitLink(am){if(am.linkType==="e"&&!isOutgoingLink(am)){am.linkURL="";am.linkType=""}}function specialExitLink(am){am.linkHandler(get([dataLayerConfig.key,dataLayerConfig.keys.specialExitLinks]),"e")}function exitLinkAttribute(am){if(am.linkType!=="e"&&am.linkType!=="d"&&am.linkObject.hasAttribute("data-analytics-exit-link")&&am.linkObject.getAttribute("data-analytics-exit-link")!=="false"){am.linkType="e";am.linkName=am.linkObject.getAttribute("data-analytics-exit-link")}}function shoppingBag(am){if(am.linkObject.classList.contains("ac-gn-link-bag")||am.linkObject.classList.contains("globalnav-link-bag")){const pageTitle=get([dataLayerConfig.key,dataLayerConfig.keys.pageName]);const linkTitle=am.linkObject.dataset.analyticsTitle;am.linkName=`${pageTitle} - ${linkTitle}`;am.prop3=linkTitle;am.linkType="o";am.bodyClickTarget=am.linkObject;set([dataLayerConfig.key,dataLayerConfig.keys.clickTimerLinkInteraction],true);am.eVar1=`${am.pageName} | global nav | ${linkTitle}`;appendList(am,"linkTrackVars",["eVar1","prop3"]);am.bodyClickFunction=function(am){am.M=0;am.linkTrackVars="";am.eVar1="";am.prop3=""}.bind(null,am)}}function passiveLink(am){const passiveData=am.linkObject.getAttribute("data-analytics-passive-link");if(passiveData){const trackingData=parseFromDataAttribute(passiveData);if(trackingData){passiveTrackerInput(trackingData)}}}module.exports=handleLink},{"../../../constants":359,"../../../helpers/parseFromDataAttribute":379,"../../../passiveTracker":397,"../helpers":323,"@apple/analytics-data-layer":46}],336:[function(require,module,exports){const{isTracking,isMicroEvent,appendList}=require("../helpers");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const propName="hier1";function hierarchy1(am){if(isTracking(am)){am[propName]=get([dataLayerConfig.key,dataLayerConfig.keys.computedChannel])||"";if(am[propName]&&isMicroEvent(am)){appendList(am,"linkTrackVars",propName)}}}module.exports=hierarchy1},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],337:[function(require,module,exports){const{isPageLoad}=require("../helpers");const propName="eVar7";const cookieName="s_var_7";const queryParam="aid";function internalCampaign(am){if(!isPageLoad(am)){return}if(!am[propName]){am[propName]=am.getQueryParam(queryParam)}am[propName]=am.getValOnce(am[propName],cookieName,0)}module.exports=internalCampaign},{"../helpers":323}],338:[function(require,module,exports){const{appendList,isMicroEvent,isPageLoad}=require("../helpers");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const langLocaleProp="eVar14";function langLocale(am){if(isPageLoad(am)){let docLang=get([dataLayerConfig.key,dataLayerConfig.keys.locale]);if(!docLang){docLang="n/a"}am[langLocaleProp]=docLang}else if(isMicroEvent(am)){appendList(am,"linkTrackVars",langLocaleProp)}}module.exports=langLocale},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],339:[function(require,module,exports){const passiveTracker=require("../../../passiveTracker");const get=require("@apple/analytics-data-layer").get;const dataLayerKeys=require("../../../constants").dataLayer;const confKey=dataLayerKeys.configuration.key;const confKeys=dataLayerKeys.configuration.keys;const linkInteraction=[confKey,confKeys.trackingStateLinkInteraction];const beacon={events:"event500"};function linkMissingTitle(am){if(get(linkInteraction)){if(!am.linkObject.getAttribute("data-analytics-title")){passiveTracker(beacon)}}}module.exports=linkMissingTitle},{"../../../constants":359,"../../../passiveTracker":397,"@apple/analytics-data-layer":46}],340:[function(require,module,exports){const{isTracking,sanitizeProperties}=require("../helpers");const propertiesString=require("../../../constants").sanitize.propertiesString;const sanitizePattern=require("../../../constants").sanitize.sanitizePattern;function manageVars(am){if(isTracking(am)){am.manageVars("lowercaseVars","purchaseID,pageType,events,products,transactionID",2);sanitizeProperties(am,sanitizePattern,propertiesString)}}module.exports=manageVars},{"../../../constants":359,"../helpers":323}],341:[function(require,module,exports){const passiveTrackerLoader=require("@apple/analytics-bp-passive-tracker-loader").passiveTrackerLoader;const{parseEventCollectionString}=require("@apple/analytics-omniture-collection");const{isTracking,isPageLoad}=require("../helpers");function track(appMeasurementObject){if(!isTracking(appMeasurementObject)){return}const data={beacon:appMeasurementObject};if(isPageLoad(appMeasurementObject)){data.type="pageLoad";if(data.beacon.events&&typeof data.beacon.events==="string"){data.beacon.events=parseEventCollectionString(data.beacon.events)}}else{data.type="userInteraction"}passiveTrackerLoader(data)}module.exports=track},{"../helpers":323,"@apple/analytics-bp-passive-tracker-loader":35,"@apple/analytics-omniture-collection":105}],342:[function(require,module,exports){const{isTracking,isMicroEvent,appendList}=require("../helpers");const propName="eVar4";function pageName(am){if(!isTracking(am)){return}am[propName]="D=pageName";if(isMicroEvent(am)){appendList(am,"linkTrackVars",propName)}}module.exports=pageName},{"../helpers":323}],343:[function(require,module,exports){const{parseEventCollectionString}=require("@apple/analytics-omniture-collection");const{merge}=require("@apple/analytics-merge-beacons");const{isMicroEvent,isExitLink}=require("../helpers");const filterBeaconsByType=require("../../../helpers/filterBeaconsByType");const getPassiveTrackerData=require("../../../helpers/getPassiveTrackerData");const mergePassiveTrackerData=require("../../../helpers/mergePassiveTrackerData");let am;const remove=require("@apple/analytics-data-layer").remove;const passiveTrackerPath=require("../../../constants").dataLayer.paths.passiveTracker;function track(appMeasurementObject){let data;am=appMeasurementObject;if(!isMicroEvent(am)||!isStorageAvailable("sessionStorage")){return}data=getPassiveTrackerData();if(!data){return}const type=trackingType();data=filterBeaconsByType(data,type);if(!data.length){return}data=mergePassiveTrackerData(data);if(data){prepareAppMeasurement(data)}}function trackingType(){if(isMicroEvent(am)){if(isExitLink(am)){return"exit"}else{return"micro-event"}}}function prepareAppMeasurement(data){setEventsData(data);setVarData(data);remove(passiveTrackerPath)}function setEventsData(data){if(!data.events){return}const newData={events:parseEventCollectionString(data.events)};const currentData={};if(am.events){currentData.events=parseEventCollectionString(am.events)}else{currentData.events={}}const mergedData=merge({target:currentData,source:newData});am.linkTrackEvents=[...mergedData.events.keys()].join(",");am.events=mergedData.events.toString();am.linkTrackVars=am.apl(am.linkTrackVars,"events",",",1);delete data.events}function setVarData(data){if(Object.keys(data)===0){return}Object.keys(data).forEach(prop=>{am[prop]=data[prop];if(isMicroEvent(am)){am.linkTrackVars=am.apl(am.linkTrackVars,prop,",",1)}})}function isStorageAvailable(type){try{const storage=window[type];const testItem="acAnalyticsStorageTestItem";storage.setItem(testItem,"a");storage.removeItem(testItem);return true}catch(e){return false}}module.exports=track},{"../../../constants":359,"../../../helpers/filterBeaconsByType":367,"../../../helpers/getPassiveTrackerData":370,"../../../helpers/mergePassiveTrackerData":377,"../helpers":323,"@apple/analytics-data-layer":46,"@apple/analytics-merge-beacons":94,"@apple/analytics-omniture-collection":105}],344:[function(require,module,exports){const{isPageLoad}=require("../helpers");function percentPageViewed(am){if(!isPageLoad(am)){return}let percentPageViewedData;if(!am.prop17){if(typeof am.getPercentPageViewed==="function"){percentPageViewedData=am.getPercentPageViewed()}if(percentPageViewedData&&percentPageViewedData.length>=4&&typeof percentPageViewedData[1]!=="undefined"){am.prop17=percentPageViewedData[1]+":"+percentPageViewedData[2];am.prop28=Math.round(percentPageViewedData[3]/10)*10}}}module.exports=percentPageViewed},{"../helpers":323}],345:[function(require,module,exports){const{isPageLoad,isMicroEvent,isTracking,appendList,getReferrer}=require("../helpers");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../../constants").dataLayer.configuration;const currentUrlProp="eVar54";const secondCurrentUrlProp="prop4";const referrerProp="eVar49";const currentUrlDynamicVariable="D=g";const referrerDynamicVariable="D=r";function referrerAndCurrentUrl(am){if(isTracking(am)){const calculatedReferrer=getReferrer();if(isPageLoad(am)){const pageUrl=get([dataLayerConfig.key,dataLayerConfig.keys.pageURL]);am.pageURL=pageUrl;am[currentUrlProp]=currentUrlDynamicVariable;const cleanPageUrl=get([dataLayerConfig.key,dataLayerConfig.keys.pageURLNoQueryString]);let secondaryCurrentUrl;if(pageUrl===cleanPageUrl){secondaryCurrentUrl=currentUrlDynamicVariable}else{secondaryCurrentUrl=cleanPageUrl}am[secondCurrentUrlProp]=secondaryCurrentUrl;if(calculatedReferrer){am.referrer=calculatedReferrer;am[referrerProp]=referrerDynamicVariable}}if(isMicroEvent(am)){if(calculatedReferrer){am[referrerProp]=calculatedReferrer}appendList(am,"linkTrackVars",[currentUrlProp,referrerProp])}}}module.exports=referrerAndCurrentUrl},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],346:[function(require,module,exports){const{isPageLoad,setReferrer}=require("../helpers");const queryParam="ref";function referrerQueryParam(am){if(!isPageLoad(am)){return}const refParamValue=am.getQueryParam(queryParam);if(refParamValue){setReferrer(refParamValue)}}module.exports=referrerQueryParam},{"../helpers":323}],347:[function(require,module,exports){const{isTracking}=require("../helpers");function removeSpacesInLinkTrackVars(am){if(isTracking(am)&&am.linkTrackVars){am.linkTrackVars=am.linkTrackVars.replace(/ /g,"")}}module.exports=removeSpacesInLinkTrackVars},{"../helpers":323}],348:[function(require,module,exports){const{isPageLoad,appendList}=require("../helpers");const eventName="event37";function retailCookies(am){if(!isPageLoad(am)){return}const retailCookie=am.Util.cookieRead("rtsid")||am.Util.cookieRead("rtsidInt");if(!retailCookie){return}appendList(am,"events",eventName)}module.exports=retailCookies},{"../helpers":323}],349:[function(require,module,exports){function setTcallToFalse(am){am.tcall=false}module.exports=setTcallToFalse},{}],350:[function(require,module,exports){const appendList=require("../helpers").appendList;const trackingProp="prop16";const trackingVar="eVar16";function specialRssLinks(am){am.linkHandler("rss~rss.support.apple.com");if(am.linkURL&&am.linkURL.includes("/ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/")&&am.linkType&&am.linkType==="e"){am.linkName="rss"}if(am.linkName==="rss"){am[trackingVar]=am[trackingProp]="sign ups";appendList(am,"linkTrackVars",[trackingVar,trackingProp])}}module.exports=specialRssLinks},{"../helpers":323}],351:[function(require,module,exports){const{isTracking}=require("../helpers");const set=require("@apple/analytics-data-layer").set;const dataLayerKeys=require("../../../constants").dataLayer;const confKey=dataLayerKeys.configuration.key;const confKeys=dataLayerKeys.configuration.keys;const linkInteraction=[confKey,confKeys.trackingStateLinkInteraction];function begin(am){if(!isTracking(am)){if(am.linkObject){set(linkInteraction,true)}}}function end(am){if(!isTracking(am)){set(linkInteraction,false)}}module.exports={begin:begin,end:end}},{"../../../constants":359,"../helpers":323,"@apple/analytics-data-layer":46}],352:[function(require,module,exports){const{isMicroEvent,isTracking,appendList}=require("../helpers");const cookieName="as_cn";const eventName="event209";function userSignInStatus(am){if(isTracking(am)){if(am.Util.cookieRead(cookieName)){appendList(am,"events",eventName);if(isMicroEvent(am)){appendList(am,"linkTrackEvents",eventName);appendList(am,"linkTrackVars","events")}}}}module.exports=userSignInStatus},{"../helpers":323}],353:[function(require,module,exports){const t=require("./t");const tl=require("./tl");module.exports={t:t,tl:tl}},{"./t":354,"./tl":355}],354:[function(require,module,exports){function submit(request,metadata,appMeasurement){if(typeof appMeasurement==="object"&&typeof appMeasurement.t==="function"){appMeasurement.tcall=true;appMeasurement.t()}}module.exports=submit},{}],355:[function(require,module,exports){const errorHandler=require("../../ErrorHandler");const moduleName="appMeasurementPluginSubmitMethodtl";const DOMHelper=require("../../helpers/DOM");function submit(trackingData,metadata,appMeasurement){let linkType;let targetEl;if(typeof appMeasurement==="object"&&typeof appMeasurement.tl==="function"){if(typeof trackingData.beacon!=="object"){errorHandler.log(moduleName,"submit",`trackingData param data (${trackingData.beacon}) is not an object`)}if(typeof trackingData.beacon.title!=="string"){errorHandler.log(moduleName,"submit",`trackingData param title (${trackingData.beacon.title}) is not a string`)}if(errorHandler.exception){return}if(trackingData.linkTrackVars&&trackingData.linkTrackVars.length>0){appMeasurement.linkTrackVars=trackingData.linkTrackVars.join(",")}linkType=trackingData.beacon.linkType||"o";targetEl=_targetEl(trackingData.data.targetEl);appMeasurement.forcedLinkTrackingTimeout=_forcedLinkTrackingTimeout(trackingData);if(trackingData.options.useBeacon){appMeasurement.useBeacon=true}appMeasurement.tl(targetEl,linkType,trackingData.beacon.title);_clearTrackingData(appMeasurement)}}function _clearTrackingData(appMeasurement){appMeasurement.linkTrackVars="";appMeasurement.linkTrackEvents=""}function _forcedLinkTrackingTimeout(request){let duration=0;const element=request.data.targetEl;if(request.type&&request.type==="link"||request.type==="click"){if(_isOutgoingLink(element)===true){duration=500}}return duration}function _targetEl(element){const result=_isOutgoingLink(element);return result===true?element:true}function _isOutgoingLink(element){if(!element){return false}if(DOMHelper.isIntraPageLink(element)===true){return false}return true}module.exports=submit},{"../../ErrorHandler":356,"../../helpers/DOM":361}],356:[function(require,module,exports){const log=require("@marcom/ac-console/log");const trace=require("@marcom/ac-console/trace");const messagePrefix="Analytics";class ErrorHandler{constructor(){this.exception=false;this.errors=[]}log(moduleName,methodName,message){const formattedMessage=this._formatMessage(moduleName,methodName,message);this.exception=true;this.errors.push({instance:moduleName,method:methodName,message:formattedMessage});log(formattedMessage);trace()}warn(moduleName,methodName,message){const formattedMessage=this._formatMessage(moduleName,methodName,message);log(formattedMessage);trace()}report(index){let out="";if(typeof index==="number"&&this.errors[index]){out=this.errors[index].message;log(this.errors[index].message)}else{this.errors.forEach(function(err){out+=`${err.message} '\r\n`});log(out)}return out}_formatMessage(moduleName,methodName,message){let throwerString="";const separator=" : ";let throwerSep;if(!!moduleName||!!methodName){throwerSep=moduleName&&methodName?".":"";throwerString=(moduleName||"")+throwerSep+(methodName||"")+separator}return messagePrefix+separator+throwerString+message}bailed(){return this.errors.length>0}}module.exports=new ErrorHandler},{"@marcom/ac-console/log":253,"@marcom/ac-console/trace":254}],357:[function(require,module,exports){const jsonEncoder=require("@apple/analytics-utils").jsonEncoder;const errorHandler=require("./ErrorHandler");const queueDataLayerKey=require("./constants").dataLayer.paths.queue;const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const remove=require("@apple/analytics-data-layer").remove;const isStorageAvailable=require("./helpers/isStorageAvailable");class Queue{constructor(){this._arr=[];this._length=0}add(item){if(!item){errorHandler.log("Queue","add",item+" is not a valid object")}if(errorHandler.exception){return}this._arr.push(item);this._updateQueueSize()}remove(){if(this.size()>0){this._arr.shift();this._updateQueueSize()}}reset(){this._arr=[];this._length=0}peek(){if(this.size()>0){return this._arr[0]}return undefined}isEmpty(){return this.size()===0}size(){return this._length}load(){let data=get(queueDataLayerKey);data=jsonEncoder.decode(data);if(!data){return}if(data&&Array.isArray(data)){this._arr=data;remove(queueDataLayerKey);this._updateQueueSize()}}save(){set(queueDataLayerKey,jsonEncoder.encode(this._arr));this.reset()}collect(){let analyticsQueue=this._arr;const analyticsData=jsonEncoder.decode(get(queueDataLayerKey));if(Array.isArray(analyticsData)){analyticsQueue=analyticsData.concat(analyticsQueue)}set(queueDataLayerKey,jsonEncoder.encode(analyticsQueue));this.reset()}canSave(){return isStorageAvailable()}_updateQueueSize(){this._length=this._arr.length}}module.exports=Queue},{"./ErrorHandler":356,"./constants":359,"./helpers/isStorageAvailable":375,"@apple/analytics-data-layer":46,"@apple/analytics-utils":190}],358:[function(require,module,exports){const Queue=require("./Queue");const AppMeasurement=require("./Appmeasurement/AppMeasurement");const passiveTracker=require("./passiveTracker");const errorHandler=require("./ErrorHandler");const moduleName="Tracker";const templateVarHelper=require("./helpers/templateVar");const isEmptyObj=require("./helpers/isEmptyObj");const trackerRegistry=require("./trackers/TrackerRegistry");const mergeIntoDeferredBeacon=require("./helpers/mergeIntoDeferredBeacon");trackerRegistry.registerAllTrackers();class Tracker{constructor(){this.AppMeasurement=new AppMeasurement;this.paused=false;this._queue=new Queue;this.trackGeneric=this.trackGeneric.bind(this);this.resume()}track(data){if(!data||typeof data!=="object"||!data.type){errorHandler.log(moduleName,"track",data+" is not a valid request object")}if(errorHandler.exception){return}const templateVarArr=templateVarHelper.set();if(data.type==="page"){data.submitMethod="t";data.beacon=JSON.parse(JSON.stringify(data.data))}else{data.submitMethod="tl";data.beacon={}}trackerRegistry.processBeaconByType(data.type,data);if(isEmptyObj(data.beacon)){return}for(const prop in data.beacon){if(typeof data.beacon[prop]==="string"){data.beacon[prop]=templateVarHelper.translate(data.beacon[prop],templateVarArr)}}if(data.options.deferred){if(data.beacon.title){delete data.beacon.title}mergeIntoDeferredBeacon(data.beacon);return}if(data.options.usePassiveTracker){delete data.beacon.title;passiveTracker(data.beacon);return}if(data.options.silent===true){return}this._queue.add(data);if(this.paused===true){this._queue.collect();return}this._run()}isPaused(){return this.paused}resume(){this._queue.load();const queueSize=this._queue.size();if(queueSize===0){return}this.paused=false;this._run()}_run(){let promise;if(this._queue.size()===0){return}const request=this._queue.peek();const options=request.options||{};if(typeof options.async==="undefined"){options.async=true}if(options.async===false){promise=this.sync(this.send.bind(this))}else{promise=this.async(this.send.bind(this))}promise.then(function(){if(!this.paused&&this._queue.size()>0){this._run()}}.bind(this))}send(){if(typeof this.AppMeasurement.submit!=="function"){errorHandler.log(moduleName,"send","provided plugin does not contain a valid submit method")}if(errorHandler.exception){return}if(this._queue.size()===0){return}const request=this._queue.peek();this.AppMeasurement.submit(request);this._queue.remove()}pause(){if(this.paused===true){return}if(!this.canPause()){return}if(this._queue.size()>0){this._queue.save()}this.paused=true}canPause(){return this._queue.canSave()}async(callback){if(!callback||typeof callback!=="function"){errorHandler.log(moduleName,"async",'Provided callback "'+callback+'" is not a function')}if(errorHandler.exception){return}return new Promise(function(resolve){setTimeout(function(){callback();resolve()},0)})}sync(callback){if(!callback||typeof callback!=="function"){errorHandler.log(moduleName,"sync",'Provided callback "'+callback+'" is not a function')}if(errorHandler.exception){return}return new Promise(function(resolve){callback();resolve()})}trackGeneric(data,options){const request={data:data,type:"custom",options:options||{}};this.track(request)}}module.exports=new Tracker},{"./Appmeasurement/AppMeasurement":309,"./ErrorHandler":356,"./Queue":357,"./helpers/isEmptyObj":371,"./helpers/mergeIntoDeferredBeacon":376,"./helpers/templateVar":383,"./passiveTracker":397,"./trackers/TrackerRegistry":398}],359:[function(require,module,exports){const dataLayerKeys=require("@apple/analytics-data-layer").KEYS;const constants={acAnalyticsVersion:"2.20.0",sessionStorage:"sessionStorage",primaryDomain:"apple.com",domainRegex:/apple.com.cn$/,performanceTimingEvents:"event220,event221,event222,event223,event224,event225,event226,event227,event228,event229,event230,event231,event232",dataLayer:{meta:{key:dataLayerKeys.METADATA,keys:{"s-bucket-0":"s-bucket-0","s-bucket-1":"s-bucket-1","s-bucket-2":"s-bucket-2","s-campaign":"s-campaign","s-channel":"s-channel","s-page-tracking-data":"s-page-tracking-data",track:"track"},selector:'meta[property^="analytics-"]',keyAttribute:"property",valueAttribute:"content",keyPrefix:"analytics-"},paths:{deferred:[dataLayerKeys.PERSISTED,dataLayerKeys.DEFERRED_BEACON],passiveTracker:["passiveTracker"],queue:[dataLayerKeys.PERSISTED,"acAnalyticsQueue"],performancePage:[dataLayerKeys.SESSION_STORE,"performanceTimingPage"],performanceAssets:[dataLayerKeys.SESSION_STORE,"performanceTimingAssets"]},deferred:{key:dataLayerKeys.DEFERRED_BEACON},pageDataModel:{key:dataLayerKeys.PAGE_DATA_MODEL,selector:"script#metrics"},persisted:{key:dataLayerKeys.PERSISTED},sessionStore:{key:dataLayerKeys.SESSION_STORE},configuration:{key:"conf",optionsKey:"conf.options",keys:{acAnalyticsVersion:"acAnalyticsVersion",bucket:"bucket",bucket0:"bucket0",bucket1:"bucket1",bucket2:"bucket2",bucketstore:"bucketstore",campaign:"campaign",channel:"channel",clickTimerCount:"clickTimerCount",clickTimerLinkInteraction:"clickTimerLinkInteraction",computedCampaign:"computedCampaign",computedChannel:"computedChannel",computedPageName:"computedPageName",computedProductName:"computedProductName",cookieLifetime:"cookieLifetime",countryBuckets:"countryBuckets",countryCodeFilter:"countryCodeFilter",currencyCode:"currencyCode",initialTimeStamp:"initialTimeStamp",legacyCountryCode:"legacyCountryCode",linkDownloadFileTypes:"linkDownloadFileTypes",loadTiming:"loadTiming",locale:"locale",pageName:"pageName",pageTrackingData:"pageTrackingData",pageType:"pageType",pageURL:"pageURL",pageURLNoQueryString:"pageURLNoQueryString",platform:"platform",productName:"productName",queryString:"queryString",referrer:"referrer",searchTerm:"searchTerm",specialExitLinks:"specialExitLinks",subdomains:"subdomains",subdomainSupportedDomains:"subdomainSupportedDomains",track:"track",trackingDomain:"trackingDomain",trackingServer:"trackingServer",trackingServerSecure:"trackingServerSecure",trackingStateLinkInteraction:"trackingStateLinkInteraction"}}},countryBuckets:["us","au|ca|cn|de|es|fr|it|jp|uk","ap|at|bf|bl|br|ce|cr|dk|fi|hk|ie|in|kr|la|mx|nl|no|nz|pl|pt|ru|se|sg|th|tw|za"],subdomains:["www","images","movies","ssl","search","smb","nova","experience","partner-relay"],supportedSubdomains:["apple.com","apple.com.cn"],cookieLifetime:"1800",linkDownloadFileTypes:["ical","ics","zip","wav","mp3","doc","pdf","xls","dmg","sit","pkg","exe","m4a","rss","xml","extz","safariextz","ibooks","epub","pages","numbers","key","xlsx","pptx","docx","psd","aif"],sanitize:{propertiesString:"prop,eVar",sanitizePattern:/(\n|\t|\r|\s{2,}|&nbsp;)+/g},regexp:{curlyBracePattern:/[{|}]/g,storeUrlPattern:/^(https?:\/\/.*\.apple\.com)?(\/[a-z\-_0-9]*)?\/shop(\/.*)?$/i,tokenPattern:/(\{[a-zA-Z][\w-]+?\})/g}};module.exports=Object.freeze(constants)},{"@apple/analytics-data-layer":46}],360:[function(require,module,exports){const regions=require("./trackers/regions/regions");const Tracker=require("./Tracker");const defaultOptions={clearRegions:true};function destroy(options={}){options={...defaultOptions,...options};if(options.clearRegions){regions.clearRegions()}Tracker.AppMeasurement.destroy(options)}module.exports=destroy},{"./Tracker":358,"./trackers/regions/regions":412}],361:[function(require,module,exports){const domNodes=require("@marcom/ac-dom-nodes");const errorHandler=require("../ErrorHandler");const storeUrlPattern=require("../constants").storeUrlPattern;const moduleName="appMeasurementPluginHelper-DOM";function isIntraPageLink(element){let href;if(!domNodes.isNodeType(element,domNodes.NODE_TYPES.ELEMENT)){return true}if(!element.href){return true}href=element.getAttribute("href").trim();if(href.charAt(0)==="#"||href.indexOf("javascript:")===0||href.indexOf("mailto:")===0||href.indexOf("tel:")===0){return true}if(element.classList.contains("ac-gn-link-search")||element.classList.contains("ac-gn-link-bag")||element.classList.contains("globalnav-link-search")||element.classList.contains("globalnav-link-bag")){return true}if(element.hasAttribute("data-analytics-intrapage-link")||element.hasAttribute("data-analytics-id")||element.hasAttribute("data-analytics-video-id")){return true}return false}function isStoreLink(url){if(typeof url!=="string"){errorHandler.log(moduleName,"isStoreLink",url+" is not a valid string")}if(errorHandler.exception){return}return storeUrlPattern.test(url)}function getLinkHref(targetEl){return targetEl.getAttribute("href")||""}module.exports={isIntraPageLink:isIntraPageLink,isStoreLink:isStoreLink,getLinkHref:getLinkHref}},{"../ErrorHandler":356,"../constants":359,"@marcom/ac-dom-nodes":260}],362:[function(require,module,exports){const utils=require("@apple/analytics-utils");const cookieJson=utils.cookieJson;const beaconHelpers=utils.beaconHelpers;const toStr=utils.toStr;const cookieName="mk_epub";const cookieOpts={path:"/",domain:"apple.com",secure:true};function getSharedCookie(options={}){options=Object.assign({},cookieOpts,options);const data=cookieJson.get(cookieName);cookieJson.set(cookieName,null,options);return data}function setSharedCookie(beacon,options={}){options=Object.assign({},cookieOpts,options);if(beaconHelpers.isNotEmpty(beacon)){cookieJson.set(cookieName,sanitizeBeacon(beacon),options)}}function sanitizeBeacon(beacon){Object.keys(beacon).forEach(key=>{const type=key.substring(0,4);const value=toStr(beacon[key]);if(type==="prop"){beacon[key]=value.substring(0,100)}else if(type==="eVar"){beacon[key]=value.substring(0,250)}});return beacon}function updateCookieOptions(domain){cookieOpts.domain=domain}module.exports={getSharedCookie:getSharedCookie,setSharedCookie:setSharedCookie,sanitizeBeacon:sanitizeBeacon,updateCookieOptions:updateCookieOptions}},{"@apple/analytics-utils":190}],363:[function(require,module,exports){const dataLayer=require("@apple/analytics-data-layer");const constants=require("../constants");const errorHandler=require("../ErrorHandler");const init=dataLayer.init;const set=dataLayer.set;function refresh(options){const{key,selector,keyAttribute,keyPrefix,valueAttribute}=constants.dataLayer.meta;init(constants.dataLayer);if(options.sourceData){const bucket0Data=options.sourceData["s-bucket-0"];const bucket1Data=options.sourceData["s-bucket-1"];const bucket2Data=options.sourceData["s-bucket-2"];const channelData=options.sourceData["s-channel"];const trackData=options.sourceData.track;if(!bucket0Data||!bucket1Data||!bucket2Data||!channelData||!trackData){errorHandler.log(`Missing page data passed - cannot initialize. |bucket0 - ${bucket0Data}|bucket1 - ${bucket1Data}|bucket2 - ${bucket2Data}|channel - ${channelData}|track - ${trackData}`);return}return set(key,options.sourceData)}const result={};const metas=document.querySelectorAll(selector);for(let i=0;i<metas.length;i++){const metaKey=metas[i].getAttribute(keyAttribute).replace(keyPrefix,"");result[metaKey]=metas[i].getAttribute(valueAttribute)}set(key,result)}module.exports={refresh:refresh}},{"../ErrorHandler":356,"../constants":359,"@apple/analytics-data-layer":46}],364:[function(require,module,exports){const errorHandler=require("../ErrorHandler");const moduleName="dataAttributeHelper";const methodName="dataStringToObject";function dataStringToObject(str){if(!str){errorHandler.log(moduleName,methodName,"`str` must not be falsey");return{}}if(typeof str!=="string"||str.length===0){errorHandler.log(moduleName,methodName,"`str` must contain a value and be of type string");return{}}let parsedStr;try{parsedStr=JSON.parse(str)}catch(e){}if(parsedStr){return parsedStr}const dataObj={};const keyValuePairs=str.split(",");for(let keyValuePair of keyValuePairs){const[key,value]=keyValuePair.split(":").map(splitStr=>splitStr.trim());if(!value&&!dataObj["dataAttrValue"]){dataObj["dataAttrValue"]=key}else{dataObj[key]=value}}return dataObj}module.exports=dataStringToObject},{"../ErrorHandler":356}],365:[function(require,module,exports){const isEmptyString=require("./isEmptyString");let eventListeners={};let keyIncrementor=0;const dynamicEventBinder=({parentSelector,eventType,childSelector,callback,exactMatch}={})=>{if(typeof callback!=="function"||isEmptyString(parentSelector)||isEmptyString(eventType)||isEmptyString(childSelector)){if(parentSelector!==window){return}}if(parentSelector===window){const node=window;keyIncrementor++;const handler=event=>{callback(event)};eventListeners[keyIncrementor]={node:node,type:eventType,handler:handler};node.addEventListener(eventType,handler);return}const parents=document.querySelectorAll(parentSelector);parents.forEach(node=>{const handler=event=>{const target=event.target;if(exactMatch){if(target.matches(childSelector)){event.dynamicEventBinderTarget=target}}else{const child=target.closest(childSelector);if(node.contains(child)){event.dynamicEventBinderTarget=child;callback(event)}}};keyIncrementor++;eventListeners[keyIncrementor]={node:node,type:eventType,handler:handler};node.addEventListener(eventType,handler)})};function removeListener(key){eventListeners[key].node.removeEventListener(eventListeners[key].type,eventListeners[key].handler);delete eventListeners[key]}function removeListeners(){if(eventListeners){Object.keys(eventListeners).forEach(key=>{removeListener(key)});eventListeners={}}}module.exports={dynamicEventBinder:dynamicEventBinder,removeListeners:removeListeners}},{"./isEmptyString":372}],366:[function(require,module,exports){function eventsToString(events){if(events&&events!=="string"&&events.toString){return events.toString()}return events}module.exports=eventsToString},{}],367:[function(require,module,exports){function filterBeaconsByType(data,type){let beaconFilter;switch(type){case"page":beaconFilter=filterByPage;break;case"exit":beaconFilter=filterByExit;break;case"micro-event":beaconFilter=filterByMicroEvent;break;default:return}return data.filter(item=>{const opts=item.options;return beaconFilter(opts)})}function filterByPage(options){return options.trackOnPageLoad||!options.trackOnExitLink}function filterByExit(options){return options.trackOnExitLink||!options.trackOnPageLoad}function filterByMicroEvent(options){return!options.trackOnPageLoad&&!options.trackOnExitLink}module.exports=filterBeaconsByType},{}],368:[function(require,module,exports){const errorHandler=require("../ErrorHandler");const moduleName="appMeasurementPluginFormatter";const separator=require("./separator");function productName(value){return lowerCaseString(value)}function channel(value,locale){if(!value){errorHandler.log(moduleName,"channel","analytics-s-channel metadata tag must exist")}if(errorHandler.exception){return}value=value.toLowerCase().split(" ").join(".");let prefix="www.";const customCountryCodeFormat={"fr-ca":"ca.fr"};prefix+=customCountryCodeFormat[locale]?customCountryCodeFormat[locale]:legacyCountryCode(locale);return prefix+"."+value}function pageName(originalPageName,locale){let suffix="";const customCountryCodes={"fr-ca":"ca-fr"};const customCode=customCountryCodes[locale];originalPageName=originalPageName||"";if(typeof locale==="string"){locale=locale.toLowerCase();suffix=customCode||legacyCountryCode(locale);suffix=_decorateCountryCode(suffix)}return lowerCaseString(originalPageName)+suffix}function eventString(prefix,suffix){prefix=prefix||"";suffix=suffix||"";return prefix?prefix+"@"+suffix:suffix}function countryCodeFilter(locale){let translated;const customCountryFilter={"fr-ca":"ca/fr","en-419":"lae","es-419":"la","en-ap":"asia","en-gb":"uk"};const reversedLocales=["fr-be","nl-be","fr-ch","de-ch"];if(customCountryFilter[locale]){translated=customCountryFilter[locale]}else if(reversedLocales.indexOf(locale)>=0){const localeStr=_transformLocale(locale);translated=localeStr.reverse().join("-")}else{translated=_getCountryCodeFromLocale(locale)}return translated}function legacyCountryCode(locale){let legacy;const customCountryCode={"fr-be":"bf","nl-be":"bl","fr-ch":"cr","de-ch":"ce","en-419":"la","es-419":"la","en-gb":"uk"};if(customCountryCode[locale]){legacy=customCountryCode[locale]}else{legacy=_getCountryCodeFromLocale(locale)}return legacy}function cleanProps(properties){const cleanProperties={};if(typeof properties==="object"){for(const key in properties){cleanProperties[key]=_sanitize(properties[key])}}return cleanProperties}function stringReplacer(str,target,replaceWith){let transformedStr=str;target=typeof target==="string"?target:"";replaceWith=typeof replaceWith==="string"?replaceWith:"";if(typeof transformedStr==="string"){transformedStr=transformedStr.replace(new RegExp(target,"gi"),replaceWith)}return transformedStr}function getRegionAncestry(data){let regionAncestry="";if(Array.isArray(data.regionAncestry)){data.regionAncestry.forEach(function(region){regionAncestry+=region.name+separator.pipe})}return regionAncestry}function lowerCaseString(str){if(typeof str==="string"){str=str.toLowerCase()}return str}function _getCountryCodeFromLocale(locale){if(!locale){errorHandler.log(moduleName,"_getCountryCodeFromLocale","locale should be a valid string")}if(errorHandler.exception){return}const temp=_transformLocale(locale);let country;if(temp.length>1){country=lowerCaseString(temp[1])}return country}function _decorateCountryCode(countryCode){if(!countryCode){errorHandler.log(moduleName,"_decorateCountryCode","countryCode should be a valid string")}if(errorHandler.exception){return}return" ("+lowerCaseString(countryCode)+")"}const whitelist=/[]/g;function _sanitize(value){if(typeof value==="string"){value=value.replace(whitelist,"")}return value}function _transformLocale(locale){return locale.split(/[-_]/)}module.exports={productName:productName,channel:channel,pageName:pageName,eventString:eventString,countryCodeFilter:countryCodeFilter,legacyCountryCode:legacyCountryCode,cleanProps:cleanProps,stringReplacer:stringReplacer,lowerCaseString:lowerCaseString,getRegionAncestry:getRegionAncestry}},{"../ErrorHandler":356,"./separator":380}],369:[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../constants").dataLayer.configuration;const constants=require("../constants");const specialExitLinkList=[{name:"deploy",url:"deploy.apple.com"},{name:"ade",url:"ade.apple.com"},{name:"appleteacher",url:"appleteacher.apple.com"},{name:"ecommerce",url:"ecommerce.apple.com"},{name:"school",url:"school.apple.com"},{name:"help",url:"help.apple.com"},{name:"survey",url:"survey.apple.com"},{name:"itunespartner",url:"itunespartner.apple.com"},{name:"investor",url:"investor.apple.com"},{name:"consultants",url:"consultants.apple.com"},{name:"itms",url:"itms.apple.com"},{name:"artists",url:"artists.apple.com"},{name:"itunes",url:"itunes.apple.com"},{name:"tv",url:"tv.apple.com"},{name:"contactretail",url:"contactretail.apple.com"}];function specialExitLinks(){const trackingDomain=get([dataLayerConfig.key,dataLayerConfig.keys.trackingDomain]);if(trackingDomain&&trackingDomain===constants.primaryDomain){specialExitLinkList.push({name:"apple.com.cn",url:"apple.com.cn"})}let specialExitLinkString="";specialExitLinkList.forEach(item=>{specialExitLinkString+=item.name+"~"+item.url+"|"});specialExitLinkString=specialExitLinkString.slice(0,-1);return specialExitLinkString}module.exports=specialExitLinks},{"../constants":359,"@apple/analytics-data-layer":46}],370:[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const passiveTrackerPath=require("../constants").dataLayer.paths.passiveTracker;function getPassiveTrackerData(){let data=get(passiveTrackerPath);if(!data){return}try{return data=JSON.parse(data)}catch(e){}}module.exports=getPassiveTrackerData},{"../constants":359,"@apple/analytics-data-layer":46}],371:[function(require,module,exports){const isEmptyObj=obj=>Object.keys(obj).length===0&&obj.constructor===Object;module.exports=isEmptyObj},{}],372:[function(require,module,exports){const toStr=require("@apple/analytics-utils").toStr;const isEmptyString=checkingString=>toStr(checkingString).trim()==="";module.exports=isEmptyString},{"@apple/analytics-utils":190}],373:[function(require,module,exports){function isFirstPageView(){if(window.sessionStorage.fpv===undefined){window.sessionStorage.fpv=0;return!isAppleReferred()}return false}function isAppleReferred(){return/\.apple\.com/.test(document.referrer)}module.exports=isFirstPageView},{}],374:[function(require,module,exports){function isNumeric(val){return!isNaN(val)}module.exports=isNumeric},{}],375:[function(require,module,exports){"use strict";function isStorageAvailable(type){try{const storage=window[type];const testItem="acAnalyticsStorageTestItem";storage.setItem(testItem,"a");storage.removeItem(testItem);return true}catch(e){return false}}module.exports=isStorageAvailable},{}],376:[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const deferredPath=require("../constants").dataLayer.paths.deferred;const merge=require("@apple/analytics-merge-beacons").merge;const biscuitTin=require("@apple/analytics-biscuit-tin");const{parseEventCollectionString}=require("@apple/analytics-omniture-collection");function mergeIntoDeferredBeacon(beacon){const deferredBeacon=get(deferredPath);if(deferredBeacon){beacon.events=provideEventsString(beacon.events);deferredBeacon.events=provideEventsString(deferredBeacon.events);const mergedEventsData=merge({target:{events:parseEventCollectionString(deferredBeacon.events)},source:{events:parseEventCollectionString(beacon.events)}});if(typeof beacon.events==="string"){beacon.events=mergedEventsData.events.toString()}beacon=merge({target:deferredBeacon,source:beacon})}set(deferredPath,beacon);biscuitTin.store()}function provideEventsString(events){if(!events){return""}if(typeof events==="string"){return events}if(events.toString){return events.toString()}return""}module.exports=mergeIntoDeferredBeacon},{"../constants":359,"@apple/analytics-biscuit-tin":27,"@apple/analytics-data-layer":46,"@apple/analytics-merge-beacons":94,"@apple/analytics-omniture-collection":105}],377:[function(require,module,exports){const{parseEventCollectionString}=require("@apple/analytics-omniture-collection");function mergePassiveTrackerData(data){if(data){if(data.length>1){data.sort((a,b)=>b.options.priority-a.options.priority);data=mergeData(data)}else{data=data[0]}}return data}function mergeData(data){data=data.reduce((merged,currentItem)=>{const mergedData=mergeItem(merged,currentItem);if(merged.events&&currentItem.events){const eventsData=parseEventCollectionString(merged.events);eventsData.merge(parseEventCollectionString(currentItem.events));mergedData.events=eventsData.toString()}return mergedData});delete data.options;return data}function mergeItem(original,overwrite){return{...original,...overwrite}}module.exports=mergePassiveTrackerData},{"@apple/analytics-omniture-collection":105}],378:[function(require,module,exports){function onDocumentReady(func){function _documentReadyCallback(){if(document.readyState==="complete"){func();document.removeEventListener("readystatechange",_documentReadyCallback)}}if(document.readyState==="complete"){func()}else{document.addEventListener("readystatechange",_documentReadyCallback)}}module.exports=onDocumentReady},{}],379:[function(require,module,exports){const tokenReplacer=require("./tokens/tokenReplacer");const dataStringToObject=require("./dataStringToObject");const isNode=require("@marcom/ac-dom-nodes/isNode");function parseFromDataAttribute(dataAttrValue,el){let dataObj;let tokensArr;let replacements={};let translatedStr;tokensArr=tokenReplacer.parseTokens(dataAttrValue);if(!tokensArr||tokensArr.length===0){return dataStringToObject(dataAttrValue)}replacements=_getTokenValues(el,tokensArr);translatedStr=tokenReplacer.replace(dataAttrValue,replacements);dataObj=dataStringToObject(translatedStr);return dataObj}function _getTokenValues(el,tokensArr){const replacements={};let value;const len=tokensArr.length;let i=0;if(isNode(el)){for(i=0;i<len;i++){if(el.getAttribute(tokensArr[i])){value=el.getAttribute(tokensArr[i]);replacements[tokensArr[i]]=value}}}return replacements}module.exports=parseFromDataAttribute},{"./dataStringToObject":364,"./tokens/tokenReplacer":385,"@marcom/ac-dom-nodes/isNode":267}],380:[function(require,module,exports){module.exports={pipe:" | ",hyphen:" - ",colon:": ",dot:".",space:" "}},{}],381:[function(require,module,exports){const DOMHelper=require("./DOM");function async(data){const isIntraPageLink=DOMHelper.isIntraPageLink(data.targetEl);let isAsync=true;if(!isIntraPageLink){isAsync=false}return isAsync}module.exports={async:async}},{"./DOM":361}],382:[function(require,module,exports){function setProperty(beacon,key,value){if(typeof beacon[key]==="undefined"&&typeof value!=="undefined"){beacon[key]=value}}module.exports=setProperty},{}],383:[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const formatter=require("./formatter");const dataLayerConfig=require("../constants").dataLayer.configuration;function set(){return[{name:"{PAGE_NAME}",value:get([dataLayerConfig.key,dataLayerConfig.keys.computedPageName])},{name:"{PAGE_NAME_NO_LOCALE}",value:get([dataLayerConfig.key,dataLayerConfig.keys.pageName])},{name:"{CHANNEL}",value:get([dataLayerConfig.key,dataLayerConfig.keys.channel])},{name:"{CAMPAIGN}",value:get([dataLayerConfig.key,dataLayerConfig.keys.computedCampaign])},{name:"{COUNTRY_CODE}",value:get([dataLayerConfig.key,dataLayerConfig.keys.legacyCountryCode])},{name:"{COUNTRY_CODE_FILTER}",value:get([dataLayerConfig.key,dataLayerConfig.keys.countryCodeFilter])},{name:"{PRODUCT_NAME}",value:get([dataLayerConfig.key,dataLayerConfig.keys.productName])},{name:"{PLATFORM}",value:get([dataLayerConfig.key,dataLayerConfig.keys.platform])}]}function translate(str,templateVarArr){if(typeof str==="string"){templateVarArr.forEach(templateVar=>{if(templateVar.name&&typeof templateVar.name==="string"){if(str.toLowerCase().indexOf(templateVar.name.toLowerCase())>-1){str=formatter.stringReplacer(str,templateVar.name,templateVar.value)}}})}return str}module.exports={set:set,translate:translate}},{"../constants":359,"./formatter":368,"@apple/analytics-data-layer":46}],384:[function(require,module,exports){"use strict";const moduleName="TokenRegistry";const errorHandler=require("../../ErrorHandler");class TokenRegistry{constructor(){this.tokens={};this._size=0}setToken(tokenName,tokenValue){if(typeof tokenName!=="string"){errorHandler.log(moduleName,"setToken",`${tokenName} is not a valid string`)}if(typeof tokenValue!=="string"){errorHandler.log(moduleName,"setToken",`${tokenValue} is not a valid string`)}if(errorHandler.exception){return}this.tokens[tokenName]=tokenValue;this._updateSize()}removeToken(tokenName){if(typeof tokenName!=="string"){errorHandler.log(moduleName,"removeToken",tokenName+" is not a valid string")}if(!this.tokens[tokenName]){errorHandler.log(moduleName,"removeToken",tokenName+" doesnt exist")}if(errorHandler.exception){return}delete this.tokens[tokenName];this._updateSize()}getToken(tokenName){if(typeof tokenName!=="string"){errorHandler.log(moduleName,"getToken",tokenName+" is not a valid string")}if(errorHandler.exception){return}return this.tokens[tokenName]}size(){return this._size}clear(){this.tokens={};this._size=0}_updateSize(){this._size=Object.keys(this.tokens).length}}module.exports=new TokenRegistry},{"../../ErrorHandler":356}],385:[function(require,module,exports){"use strict";const moduleName="TokenReplacer";const tokenPattern=require("../../constants").tokenPattern;const curlysPattern=require("../../constants").curlysPattern;const tokenRegistry=require("./Registry");const errorHandler=require("../../ErrorHandler");class TokenReplacer{constructor(){this.registry=tokenRegistry}replace(str,replacements){if(typeof str!=="string"){errorHandler.log(moduleName,"replace",str+" is not a valid string")}if(errorHandler.exception){return}if(typeof replacements==="object"){str=this._replace(str,replacements)}if(this.registry.size()>0){str=this._replace(str,this.registry.tokens)}return str}parseTokens(str){let tokens;if(typeof str!=="string"){errorHandler.log(moduleName,"parseTokens",str+" is not a valid string")}if(errorHandler.exception){return}tokens=str.match(tokenPattern);if(tokens){return tokens.map(value=>{return this._removeCurlys(value)})}}_replace(str,replacements){return str.replace(tokenPattern,match=>{return typeof replacements[this._removeCurlys(match)]==="string"?replacements[this._removeCurlys(match)]:match})}_removeCurlys(str){str=str.trim();return str.replace(curlysPattern,"")}}module.exports=new TokenReplacer},{"../../ErrorHandler":356,"../../constants":359,"./Registry":384}],386:[function(require,module,exports){const PageObserver=require("./observers/Page");const LinkObserver=require("./observers/Link");const ClickObserver=require("./observers/Click");const SectionObserver=require("./observers/Section");const ElementEngagementObserver=require("./observers/ElementEngagement");const onDocumentReady=require("./helpers/onDocumentReady");const AdobeTargetObserver=require("./observers/AdobeTarget");const isNode=require("@marcom/ac-dom-nodes").isNode;const defaults={onDOMContentLoadedOptions:{section:{autoEnable:false},globalNav:{autoEnable:false,initListener(){const acGlobalNav=document.querySelector("#globalnav");if(acGlobalNav){this.onEnableListenerCallback({detail:{target:acGlobalNav}})}else{window.addEventListener("globalnav:mounted",this.onEnableListenerCallback.bind(this))}}}},onPageDataLoadedOptions:{page:{},click:{},link:{}},compatibilityMode:false};function initialize(options){if(!options){options=getSettings()}if(options&&options.compatibilityMode){options=setLegacySettings(options)}options=options?{...defaults,...options}:defaults;const onPageDataLoadedObservers=onPageDataLoaded(options.onPageDataLoadedOptions);const onDOMContentLoadedObservers=onDOMContentLoaded(options.onDOMContentLoadedOptions);return{...onPageDataLoadedObservers,...onDOMContentLoadedObservers}}function onPageDataLoaded(options){return{page:new PageObserver(options.page),link:new LinkObserver(options.link),click:new ClickObserver(options.click),adobeTarget:new AdobeTargetObserver}}function onDOMContentLoaded(options){const observers={section:new SectionObserver(options.section),globalNav:new ElementEngagementObserver(options.globalNav)};onDocumentReady(()=>{Object.keys(observers).forEach(observer=>{observers[observer].enable()})});return observers}function getSettings(){if(window.acAnalyticsSettings){if(isNode(window.acAnalyticsSettings)){return getSettingsFromDOM()}else{return window.acAnalyticsSettings}}}function getSettingsFromDOM(){const script=document.getElementById("acAnalyticsSettings");if(script){try{return JSON.parse(script.innerHTML)}catch(error){}}}function setLegacySettings(options){const reportSuites="applestoreww";const pageName=getLegacyPageName();const locale=getLocale();const channel=getChannel();const defaultValues={"s-bucket-0":reportSuites,"s-bucket-1":reportSuites,"s-bucket-2":reportSuites,"s-channel":channel,track:pageName,locale:locale};if(!options){options={}}if(!options.onPageDataLoadedOptions){options.onPageDataLoadedOptions={}}if(!options.onPageDataLoadedOptions.page){options.onPageDataLoadedOptions.page={}}if(!options.onPageDataLoadedOptions.page.sourceData){options.onPageDataLoadedOptions.page.sourceData={}}options.onPageDataLoadedOptions.page.sourceData={...defaultValues,...options.onPageDataLoadedOptions.page.sourceData};return options}function getLegacyPageName(){const metaTags=document.getElementsByTagName("meta");for(let i=0,metaTag;metaTag=metaTags[i];i++){if(metaTag.getAttribute("name")==="omni_page"){return metaTag.getAttribute("content").toLowerCase()}}const title=document.title;const host=window.location.hostname;let pathName=window.location.pathname;let pageName=title.toLowerCase();if(/\s-\s/.test(pageName)){pageName=pageName.replace(/\s*-?\s*(apple|||||apple|)\s+[^-]*-?\s*/,"")}if(!pathName.match(/^\/(ws|pr|g5|go|ta|wm)\//)){pathName=pathName.replace(/^\/(\w{2}|befr|benl|chfr|chde|asia|lae)(?=\/)/,"")}if(pathName.match(/\//g).length<=2&&!pathName.match(/support/)&&!host.match(/support/)&&!host.match(/selfsolve/)&&(!!pathName.match(/index\.html/)||!pathName.match(/\.html/))){pageName+=" - index"}if(/\/pr\//.test(pathName)){pageName="pr - "+pageName}return pageName}function getLocale(){if(document&&document.documentElement){const htmlLang=document.documentElement.getAttribute("data-locale")||document.documentElement.lang;if(htmlLang){return htmlLang}const globalNav=document.getElementById("globalnav")||document.getElementById("ac-globalnav");if(globalNav){const globalNavLang=globalNav.getAttribute("lang");if(globalNavLang){return globalNavLang}}const segmentBar=document.getElementById("globalmessage-segment")||document.getElementById("ac-gn-segmentbar");if(segmentBar){const segmentBarLang=segmentBar.getAttribute("lang");if(segmentBarLang){return segmentBarLang}}const globalFooter=document.getElementById("ac-globalfooter");if(globalFooter){const globalFooterLang=globalFooter.getAttribute("lang");if(globalFooterLang){return globalFooterLang}}const ogLocale=document.querySelector('meta[property="og:locale"]');if(ogLocale){const ogLocaleContent=ogLocale.getAttribute("content").split("_").join("-");if(ogLocaleContent){return ogLocaleContent}}}}function getChannel(){let channel;if(window&&window.location&&window.location.pathname){channel=window.location.pathname.split("/")[1]}if(channel===""){channel="root"}return channel}module.exports=initialize},{"./helpers/onDocumentReady":378,"./observers/AdobeTarget":387,"./observers/Click":388,"./observers/ElementEngagement":389,"./observers/Link":392,"./observers/Page":393,"./observers/Section":394,"@marcom/ac-dom-nodes":260}],387:[function(require,module,exports){const Tracker=require("../Tracker");const observerRegistry=require("./observerRegistry");const isFirstPageView=require("../helpers/isFirstPageView");const merge=require("@apple/analytics-passive-tracker").merge;const get=require("@apple/analytics-data-layer").get;const passiveTrack=require("../passiveTracker");class AdobeTargetObserver{constructor(){this.observerType="target";observerRegistry.add(this);this.tracker=Tracker;this.isEnabled=true;this.isFirstPageView=isFirstPageView();this.listenForTargetEvent()}listenForTargetEvent(){document.addEventListener("at-content-rendering-succeeded",this.track.bind(this));if(window.ac_target&&window.ac_target.data){this.track()}}track(){const targetData=getTargetData();const pageName=get("conf.pageName")?get("conf.pageName"):"";if(!this.tracker||!targetData){return}if(this.isFirstPageView){this.passivelyTrack(targetData,pageName);return}this.tracker.trackGeneric({title:"abtnnb",eVar57:`${targetData}:${pageName}`.toLowerCase()})}passivelyTrack(targetData,pageName){const beacon={eVar57:`${targetData}:${pageName}`.toLowerCase()};merge("beacon",beacon);passiveTrack(beacon)}}function getTargetData(){if(!window||!window.ac_target){return}const data=window.ac_target.data;const tracked=window.ac_target.tracked;if(!data||tracked){return}window.ac_target.tracked=true;return data}module.exports=AdobeTargetObserver},{"../Tracker":358,"../helpers/isFirstPageView":373,"../passiveTracker":397,"./observerRegistry":396,"@apple/analytics-data-layer":46,"@apple/analytics-passive-tracker":126}],388:[function(require,module,exports){const ancestor=require("@marcom/dom-traversal/ancestor");const acDomNodes=require("@marcom/ac-dom-nodes");const Tracker=require("../Tracker");const errorHandler=require("../ErrorHandler");const EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;const observerRegistry=require("./observerRegistry");const defaultOptions={dataAttribute:"analytics-click",titleDataAttribute:"analytics-title",autoEnable:true};const moduleName="ClickAnalyticsObserver";const exitLinkPattern=/^https?:\/\/|^\/\//i;class ClickAnalyticsObserver extends EventEmitterMicro{constructor(options={}){super(options);this.options={...defaultOptions,...options};this.observerType="click";observerRegistry.add(this);this.tracker=Tracker;this.isEnabled=false;this._boundOnInteraction=this._onInteraction.bind(this);this._elements=null;if(this.options.autoEnable===true){this.enable()}}enable(){if(errorHandler.exception){return}if(!this.isEnabled){this.addListener();this.isEnabled=true;this.trigger("enabled")}}addListener(){document.body.addEventListener("click",this._boundOnInteraction)}removeListener(){document.body.removeEventListener("click",this._boundOnInteraction)}_onInteraction(e){let targetEl=e.target;let linkAncestor;if(!targetEl.getAttribute("data-"+this.options.dataAttribute)){linkAncestor=ancestor(targetEl,"[data-"+this.options.dataAttribute+"]");if(linkAncestor){targetEl=linkAncestor}}if(targetEl.classList.contains("ac-gn-link-bag")||targetEl.classList.contains("globalnav-link-bag")||targetEl.id==="ac-gn-link-search"||targetEl.id==="ac-gn-link-search-small"||targetEl.id==="globalnav-menubutton-link-search"){return}if(targetEl.hasAttribute("href")&&targetEl.tagName==="A"&&!targetEl.hasAttribute("data-analytics-intrapage-link")){if(exitLinkPattern.test(targetEl.getAttribute("href"))){return}}if(targetEl.getAttribute("data-"+this.options.dataAttribute)){this.track(e,targetEl)}}track(e,targetEl){if(!this.tracker){return}const data={};if(!acDomNodes.isNodeType(targetEl,acDomNodes.NODE_TYPES.ELEMENT)){errorHandler.log(moduleName,"track",targetEl+" is not a valid DOM element")}if(errorHandler.exception){return}data.targetEl=targetEl;this.tracker.track({type:"click",event:e,data:data,options:JSON.parse(JSON.stringify(this.options))})}destroy(){this.removeListener();this.options=null;this.tracker=null;this.isEnabled=null;this._boundOnInteraction=null;this._elements=null;observerRegistry.remove(this)}}module.exports=ClickAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"./observerRegistry":396,"@marcom/ac-dom-nodes":260,"@marcom/ac-event-emitter-micro":281,"@marcom/dom-traversal/ancestor":293}],389:[function(require,module,exports){const EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;const Tracker=require("../Tracker");const{defaultOptions:eeoDefaultOptions,ElementEngagementObserver:EEO}=require("@marcom/element-engagement-observer");const defaultOptions={...eeoDefaultOptions,initListener(){this.onEnableListenerCallback({detail:{target:document.body}})}};class ElementEngagementObserver extends EventEmitterMicro{constructor(options){super(options);this.options=Object.assign(defaultOptions,options);this.tracker=Tracker}enable(){this.options.initListener.call(this)}onEnableListenerCallback(evt){const{detail}=evt;const{target}=detail||evt;this.options.target=target;this.elementEngagementObserver=new EEO({...this.options,autoEnable:true,track:this.track.bind(this)})}track(d){const{engagementTitle,target}=d;const data=Object.assign({},d);data.engagementTitle=engagementTitle;data.target=target;const trackingData={type:"elementEngagement",observer:this,options:this.options,data:data};this.tracker.track(trackingData)}}module.exports=ElementEngagementObserver},{"../Tracker":358,"@marcom/ac-event-emitter-micro":281,"@marcom/element-engagement-observer":296}],390:[function(require,module,exports){const errorHandler=require("../ErrorHandler");const Tracker=require("../Tracker");const observerRegistry=require("./observerRegistry");const defaultOptions={interactionEvents:[],interactionEventCallbacks:{}};const moduleName="EventAnalyticsObserver";class EventAnalyticsObserver{constructor(targetObj,options={}){if(!targetObj||typeof targetObj!=="object"||typeof targetObj.on!=="function"||typeof targetObj.off!=="function"){errorHandler.log(moduleName,null,targetObj+" does not appear to be a valid EventEmitter")}this.options={...defaultOptions,...options};this.observerType="event";observerRegistry.add(this);if(!Array.isArray(this.options.interactionEvents)){errorHandler.log(moduleName,null,this.options.interactionEvents+" is not an array")}this.tracker=Tracker;this.targetObj=targetObj;this._callbacks={};this.attachEvents()}attachEvents(){if(errorHandler.exception){return}const options=this.options;let interactionEventCallback;options.interactionEvents.forEach(function(interactionEvent){interactionEventCallback=options.interactionEventCallbacks[interactionEvent];interactionEventCallback=typeof interactionEventCallback==="function"?interactionEventCallback:this.track.bind(this);this._callbacks[interactionEvent]=interactionEventCallback;this.addListener(interactionEvent,interactionEventCallback)},this)}detachEvents(){Object.keys(this._callbacks).forEach(function(callbackName){this.removeListener(callbackName,this._callbacks[callbackName])},this)}addListener(eventType,callback){this.targetObj.on(eventType,callback)}removeListener(eventType,callback){this.targetObj.off(eventType,callback)}track(data){if(!this.tracker){return}this.tracker.track({type:"custom",data:data,options:this.options})}destroy(){this.detachEvents();this.options=null;this.tracker=null;this.targetObj=null;this._callbacks=null;observerRegistry.remove(this)}}module.exports=EventAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"./observerRegistry":396}],391:[function(require,module,exports){const Tracker=require("../Tracker");const get=require("@apple/analytics-data-layer").get;const errorHandler=require("../ErrorHandler");const dataLayerConfig=require("../constants").dataLayer.configuration;const confKey=dataLayerConfig.key;const observerRegistry=require("./observerRegistry");const defaultOptions={trackAutoRotate:false,beforeUpdateEvent:"willShow",afterUpdateEvent:"didShow"};const moduleName="GalleryAnalyticsObserver";class GalleryAnalyticsObserver{constructor(gallery,options={}){if(!gallery||typeof gallery!=="object"){errorHandler.log(moduleName,null,gallery+" is not an object")}this.options={...defaultOptions,...options};this.observerType="gallery";observerRegistry.add(this);this.gallery=gallery;this.tracker=Tracker;this.trackedInteractionTypes=[];this.outgoingSlideInteractionType="auto";this.incomingSlideTimestamp=get([confKey,dataLayerConfig.keys.initialTimeStamp]);this._onUpdate=this._onUpdate.bind(this);this._onComplete=this.track.bind(this);this.addListener()}addListener(){if(errorHandler.exception){return}if(this.options.beforeUpdateEvent){this.gallery.on(this.options.beforeUpdateEvent,this._onUpdate)}if(this.options.afterUpdateEvent){this.gallery.on(this.options.afterUpdateEvent,this._onComplete)}}removeListener(){if(this.options.beforeUpdateEvent){this.gallery.off(this.options.beforeUpdateEvent,this._onUpdate)}if(this.options.afterUpdateEvent){this.gallery.off(this.options.afterUpdateEvent,this._onComplete)}}_createInteractionEvent(evt){let interactionEvent=evt.interactionEvent.originalEvent||evt.interactionEvent;if(interactionEvent){return interactionEvent={type:interactionEvent.type,target:interactionEvent.target,srcElement:interactionEvent.srcElement}}return null}_onUpdate(d){this.interactionEvent=null;if(d.interactionEvent){this.interactionEvent=this._createInteractionEvent(d)}}_getSlideId(slide){let slideId="";let length=0;if(slide&&Array.isArray(slide)){length=slide.length;for(let i=0;i<length;i++){if(typeof slide[i].getElement==="function"&&typeof slide[i].getElementId==="function"){const slideElement=slide[i].getElement();const customSlideId=slideElement?slideElement.getAttribute("data-analytics-gallery-item-id"):null;if(customSlideId){slideId+=customSlideId+"-"}else{slideId+=slide[i].getElementId()+"-"}}}}return slideId.slice(0,slideId.length-1)}track(d){if(!this.tracker){return}if(this.options.trackAutoRotate===false){if(!d.interactionEvent||d.interactionEvent.gallery&&d.interactionEvent.gallery===this.gallery){return}}const data=Object.assign({},d);data.interactionEvent=this.interactionEvent||this._createInteractionEvent(d);if(!this.options.galleryName){errorHandler.log(moduleName,"track",this.options.galleryName+" is not a valid gallery name")}if(errorHandler.exception){return}if(data.incoming&&typeof data.incoming.id!=="string"){data.incoming.id=this._getSlideId(data.incoming)}if(data.outgoing&&typeof data.outgoing.id!=="string"){data.outgoing.id=this._getSlideId(data.outgoing)}this.outgoingSlideTimestamp=this.incomingSlideTimestamp;this.incomingSlideTimestamp=Date.now();data.incomingSlideTimestamp=this.incomingSlideTimestamp;data.outgoingSlideTimestamp=this.outgoingSlideTimestamp;this.tracker.track({type:"gallery",data:data,observer:this,options:this.options})}destroy(){if(!this.gallery){errorHandler.log(moduleName,"destroy",this.gallery+" is not an object")}if(errorHandler.exception){return}this.removeListener();this.options=null;this.tracker=null;this.gallery=null;this.trackedInteractionTypes=null;this.interactionEvent=null;observerRegistry.remove(this)}}module.exports=GalleryAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"../constants":359,"./observerRegistry":396,"@apple/analytics-data-layer":46}],392:[function(require,module,exports){const ancestor=require("@marcom/dom-traversal/ancestor");const Tracker=require("../Tracker");const errorHandler=require("../ErrorHandler");const EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;const isIntraPageLink=require("../helpers/DOM").isIntraPageLink;const observerRegistry=require("./observerRegistry");const defaultOptions={dataAttribute:"analytics-link",titleDataAttribute:"analytics-title",silent:true,deferred:true,autoEnable:true};class LinkAnalyticsObserver extends EventEmitterMicro{constructor(options={}){super(options);this.options={...defaultOptions,...options};this.observerType="link";observerRegistry.add(this);this.tracker=Tracker;this.isEnabled=false;this.defaultTracking=this.track.bind(this);if(this.options.autoEnable===true){this.enable()}}enable(){if(errorHandler.exception){return}if(!this.isEnabled){this.addListener();this.isEnabled=true;this.trigger("enabled")}}addListener(){const element=document.body;element.addEventListener("mouseup",this.defaultTracking)}removeListener(){const element=document.body;element.removeEventListener("mouseup",this.defaultTracking)}track(e){if(!this.tracker){return}const data={};let targetEl;let linkAncestor;const element=e.target;if(element.nodeName.toLowerCase()==="a"){targetEl=element}if(!targetEl){linkAncestor=ancestor(element,"a");if(linkAncestor){targetEl=linkAncestor}}if(!targetEl||isIntraPageLink(targetEl)){return}data.targetEl=targetEl;this.tracker.track({type:"link",event:e,data:data,options:this.options})}destroy(){this.removeListener();this.options=null;this.tracker=null;this.isEnabled=null;this.defaultTracking=null;observerRegistry.remove(this)}}module.exports=LinkAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"../helpers/DOM":361,"./observerRegistry":396,"@marcom/ac-event-emitter-micro":281,"@marcom/dom-traversal/ancestor":293}],393:[function(require,module,exports){const Tracker=require("../Tracker");const errorHandler=require("../ErrorHandler");const onDocumentReady=require("../helpers/onDocumentReady");const dynamicEventBinder=require("../helpers/dynamicEventBinder").dynamicEventBinder;const dynamicEventBinderRemoveListeners=require("../helpers/dynamicEventBinder").removeListeners;const EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;const isIntraPageLink=require("../helpers/DOM").isIntraPageLink;const ancestor=require("@marcom/dom-traversal/ancestor");const endOfPageTrack=require("@apple/analytics-end-of-page").endOfPage;const observerRegistry=require("./observerRegistry");const defaultOptions={autoEnable:true};const body="body";class PageAnalyticsObserver extends EventEmitterMicro{constructor(options={}){super(options);this.options={...defaultOptions,...options};this.observerType="page";observerRegistry.add(this);this.tracker=Tracker;this.initialized=false;this.enabled=false;const onReadyStateOptions={silent:true};this.onReadyTracking=this.track.bind(this,"readyStateComplete",onReadyStateOptions);this.onFocusIn=this.track.bind(this,"focusin",{});this.onEndOfPage=this.trackEndOfPage.bind(this,"endOfPage",{});this.onSubmit=this.track.bind(this,"submit",{deferred:true});this.onLinkClick=this.track.bind(this,"linkClick",{});this.onNavigationalLink=this.onNavigationalLink.bind(this);this.onPageHide=this.track.bind(this,"pageHide",{deferred:true,beacon:{}});this.onScroll=this.onScroll.bind(this);if(this.options.autoEnable===true){this.enable()}}onScroll(){endOfPageTrack({element:document.querySelector("#ac-globalfooter"),onPageEnd:this.onEndOfPage});document.removeEventListener("scroll",this.onScroll)}enable(){if(errorHandler.exception){return}if(!this.enabled){this.tracker.AppMeasurement.initialize(this.options);this.track("page");this.enabled=true;this.trigger("enabled");setTimeout(()=>{this.track("storeAtPageLoad",{deferred:true});onDocumentReady(this.onReadyTracking);dynamicEventBinder({parentSelector:body,eventType:"focusin",childSelector:"input",callback:this.onFocusIn});dynamicEventBinder({parentSelector:body,eventType:"click",childSelector:"a",callback:this.onLinkClick});dynamicEventBinder({parentSelector:body,eventType:"click",childSelector:"a",callback:this.onNavigationalLink});dynamicEventBinder({parentSelector:body,eventType:"submit",childSelector:"form",callback:this.onSubmit});dynamicEventBinder({parentSelector:window,eventType:"pagehide",callback:this.onPageHide})},0);setTimeout(()=>{document.addEventListener("scroll",this.onScroll)},1e3)}}onNavigationalLink(e){if(!this.tracker){return}const data={};let targetEl;let linkAncestor;const element=e.target;const options={deferred:true,beacon:{}};if(element.nodeName.toLowerCase()==="a"){targetEl=element}if(!targetEl){linkAncestor=ancestor(element,"a");if(linkAncestor){targetEl=linkAncestor}}if(!targetEl||isIntraPageLink(targetEl)){return}data.targetEl=targetEl;this.tracker.track({type:"navigationalLink",event:e,data:data,options:JSON.parse(JSON.stringify(options))})}track(type,options,e){if(!this.tracker){return}let data={};if(type==="page"&&this.options&&this.options.data){data=this.options.data}options={...this.options,...options};this.tracker.track({type:type,event:e,data:data,options:JSON.parse(JSON.stringify(options))})}trackEndOfPage(type,options,data){if(!this.tracker){return}this.tracker.track({type:type,data:{events:data.beacon.events.toString()},options:JSON.parse(JSON.stringify(options))})}destroy(){this.options=null;this.tracker=null;this.initialized=null;dynamicEventBinderRemoveListeners();document.removeEventListener("scroll",this.onScroll);observerRegistry.remove(this)}}module.exports=PageAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"../helpers/DOM":361,"../helpers/dynamicEventBinder":365,"../helpers/onDocumentReady":378,"./observerRegistry":396,"@apple/analytics-end-of-page":90,"@marcom/ac-event-emitter-micro":281,"@marcom/dom-traversal/ancestor":293}],394:[function(require,module,exports){const ElementEngagement=require("@marcom/ac-element-engagement");const Tracker=require("../Tracker");const errorHandler=require("../ErrorHandler");const dataStringToObject=require("../helpers/dataStringToObject");const isNumeric=require("../helpers/isNumeric");const EventEmitterMicro=require("@marcom/ac-event-emitter-micro").EventEmitterMicro;const debounce=require("@marcom/function-utils/debounce");const observerRegistry=require("./observerRegistry");const moduleName="SectionAnalyticsObserver";ElementEngagement._elementInViewPastThreshold=function(trackedElement){let isInThreshold=false;if(trackedElement.engaged){isInThreshold=trackedElement.pixelsInView>=Math.min(this._windowHeight/3,325)}else{isInThreshold=trackedElement.pixelsInView>=Math.min(this._windowHeight/2.1,450)}isInThreshold=isInThreshold||trackedElement.percentInView>trackedElement.inViewThreshold;return isInThreshold};const defaultOptions={dataAttribute:"analytics-section-engagement",autoEnable:true,customInitialization:false};const trackedElementDefaults={stopOnEngaged:false,timeToEngage:1e3};const debounceOptions={leading:true};class SectionAnalyticsObserver extends EventEmitterMicro{constructor(options={}){super(options);if(ElementEngagement.elements.length>0){errorHandler.warn(moduleName,"constructor","element engagement was already tracking elements when a new section observer was created. This could lead to errors in tracking. Make sure to destroy section observer before creating a new one.")}this.options=Object.assign({},defaultOptions,options);this.observerType="section";observerRegistry.add(this);this.tracker=Tracker;this.elementEngagement=ElementEngagement;this.isEnabled=false;this.sections=[];this._listeners=false;if(this.options.autoEnable===true){this.enable()}}enable(){if(errorHandler.exception){return}if(!this.isEnabled){this._bindMethods();if(!this.options.customInitialization){this._loadSections();this.initializeTracking()}}}initializeTracking(){if(this.sections&&this.sections.length>0){this._setPosition();this.options.elements=this.sections;this._addListeners();this.elementEngagement.start();this.isEnabled=true;this.trigger("enabled")}else{errorHandler.warn(moduleName,"initializeTracking","initialization of Section Observer had no effect because no valid sections were queued before initialization.")}}initializeSection(el){if(!this.sections||this.sections.length===0){return}const trackedElement=this._getTrackedElement(el);if(trackedElement){this._setPosition();if(!this._listeners){this._addListeners()}if(this.options.elements&&Array.isArray(this.options.elements)){this.options.elements.push(el)}else{this.options.elements=[el]}trackedElement.tracking=false;this.elementEngagement.start(trackedElement)}}addSection(el){if(!el||!(el instanceof window.Element)||this._getTrackedElement(el)){return}this.sections.push(el);let options;const dataString=el.getAttribute("data-"+this.options.dataAttribute);options=dataStringToObject(dataString);options=this._castDataAttributeOptions(options);options=Object.assign({},trackedElementDefaults,options);this.elementEngagement.addElement(el,options)}removeSection(el){const trackedElement=this._getTrackedElement(el);const index=this.sections.indexOf(el);if(index>-1){this.sections.splice(index,1)}this.elementEngagement.stop(trackedElement)}clearSections(){if(this.elementEngagement){if(this.elementEngagement.elements){this.elementEngagement.elements.forEach(function(trackedElement){this.elementEngagement.stop(trackedElement)}.bind(this))}}this.sections=[]}refreshMetrics(){this.elementEngagement.refreshAllElementMetrics()}startSectionEngagement(el){const trackedElement=this._getTrackedElement(el);if(trackedElement){trackedElement.trigger("thresholdenter",trackedElement);trackedElement.trigger("engaged",trackedElement);this.elementEngagement._engaged.call(this.elementEngagement,trackedElement)}}endSectionEngagement(el){const trackedElement=this._getTrackedElement(el);if(trackedElement&&trackedElement.tracking){trackedElement.thresholdExitTime=Date.now();this.elementEngagement.stop(trackedElement);this.track({element:trackedElement})}}pauseElementTracking(el){const trackedElement=this._getTrackedElement(el);if(trackedElement){trackedElement.isActive=false}}resumeElementTracking(el){const trackedElement=this._getTrackedElement(el);if(trackedElement){trackedElement.isActive=true}}_bindMethods(){this._onThresholdExit=this._onThresholdExit.bind(this);this._onScroll=this._onScroll.bind(this);this._onResize=this._onResize.bind(this);this.endSectionEngagement=this.endSectionEngagement.bind(this);this._getTrackedElement=this._getTrackedElement.bind(this)}_loadSections(){const sections=[...document.querySelectorAll("[data-"+this.options.dataAttribute+"]")];sections.forEach(function(section){this.addSection(section)},this)}_setPosition(){let i;const totalSections=this.sections.length;for(i=0;i<totalSections;i+=1){this.sections[i].position=i+1}}_castDataAttributeOptions(options){options=Object.assign({},options);Object.keys(options).forEach(function(key){const value=options[key];let castValue;if(value==="false"){castValue=false}else if(value==="true"){castValue=true}else if(isNumeric(value)){castValue=value}else{castValue=value}options[key]=castValue});return options}_addListeners(){this._listeners=true;this.elementEngagement.on("thresholdexit",this._onThresholdExit);window.addEventListener("scroll",this._onScroll);window.addEventListener("resize",this._onResize);window.addEventListener("orientationchange",this._onResize)}_removeListeners(){this._listeners=false;if(this.elementEngagement&&this.elementEngagement.off&&typeof this.elementEngagement.off==="function"){this.elementEngagement.off("thresholdexit",this._onThresholdExit)}window.removeEventListener("scroll",this._onScroll);window.removeEventListener("resize",this._onResize);window.removeEventListener("orientationchange",this._onResize)}_onThresholdExit(trackedElement){if(trackedElement.engaged){const data={element:trackedElement};this.elementEngagement.stop(trackedElement);this.track(data)}}_onScroll(){return debounce(()=>{this.refreshMetrics();this._checkForPageEnd()},300,debounceOptions)()}_onResize(){return debounce(()=>{this._checkForPageEnd()},300,debounceOptions)()}_checkForPageEnd(){if(window.pageYOffset>=document.body.scrollHeight-window.innerHeight){this._pageEnd()}}_pageEnd(){const sectionsInView=[];this.elementEngagement.elements.forEach(function(element){if(element.inView&&element.inThreshold&&element.tracking&&element.isActive){sectionsInView.push(element)}});sectionsInView.forEach(function(section){if(section.engaged){this.endSectionEngagement(section)}else{if(section.has("engaged")===false){section.once("engaged",this.endSectionEngagement)}}},this)}track(data){if(!this.tracker){return}this.tracker.track({type:"section",data:data,options:this.options})}destroy(){if(this.elementEngagement){this.clearSections();this.elementEngagement.stop()}this._removeListeners();this.options=null;this.elementEngagement=null;this.tracker=null;this.sections=null;observerRegistry.remove(this)}_getTrackedElement(trackedElement){if(trackedElement instanceof window.Element){trackedElement=this.elementEngagement.elements.filter(function(elementTracker){return elementTracker.element===trackedElement})[0]}if(!(trackedElement instanceof EventEmitterMicro)){return null}return trackedElement}}module.exports=SectionAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"../helpers/dataStringToObject":364,"../helpers/isNumeric":374,"./observerRegistry":396,"@marcom/ac-element-engagement":271,"@marcom/ac-event-emitter-micro":281,"@marcom/function-utils/debounce":303}],395:[function(require,module,exports){const errorHandler=require("../ErrorHandler");const Tracker=require("../Tracker");const isNode=require("@marcom/ac-dom-nodes/isNode");const debounce=require("@marcom/function-utils/debounce");const isHandheld=require("@marcom/feature-detect/isHandheld")();const acUserAgent=require("@marcom/useragent-detect");const observerRegistry=require("./observerRegistry");const dataAttributeAnalyticsId="analytics-id";const moduleName="VideoAnalyticsObserver";const videoSegmentBoundries=[0,.1,.25,.5,.75,.9,1];const defaultOptions={mediaEvents:[],mediaEventCallbacks:{},dataAttribute:dataAttributeAnalyticsId,trackCaptions:true,trackMilestones:true,trackSeeking:true,trackDuration:true,trackCurrentTime:true,streamingVideo:false};const AC_VIDEO_SUPPORTS_CUSTOM_PLAY_VERSION="3.6.1";const IS_IE=acUserAgent.browser.ie;const IS_MOBILE=acUserAgent.os.ios||acUserAgent.os.android;class VideoAnalyticsObserver{constructor(video,options={}){if(!video||typeof video!=="object"){errorHandler.log(moduleName,null,video+" is not an object")}this.options={...defaultOptions,...options};this.observerType="video";observerRegistry.add(this);if(this.options.streamingVideo===true){this.options.trackMilestones=false;this.options.trackSeeking=false;this.options.trackDuration=false;this.options.trackCurrentTime=false}if(!Array.isArray(this.options.mediaEvents)){errorHandler.log(moduleName,null,this.options.mediaEvents+" is not a valid media events array")}this.tracker=Tracker;this.video=video;this.playCount=0;this.ttShowCount=0;this._callbacks={};this._events={play:"play",playing:"playing",pause:"pause",timeupdate:"timeupdate",seeking:"seeking",seeked:"seeked",ended:"ended",texttrackshow:"texttrackshow",PlayPromiseResolved:"PlayPromiseResolved"};this._onWebkitEndFullscreen=this._onWebkitEndFullscreen.bind(this);this._onPlayingFromStart=this._onPlayFromStart.bind(this);this._getPlayEventName=this._getPlayEventName.bind(this);this._initializeInDOM()}_initializeInDOM(){if(errorHandler.exception){return}if(this.options.videoElement){this.videoElement=this.options.videoElement}else if(this._isAcVideo()){this._setVideoElement()}if(this.options.trackMilestones||this.options.trackSeeking){this._setupMilestoneTracking()}this.attachEvents()}_setupMilestoneTracking(){this._milestoneTrackingTimeout=null;this._hadSeeked=false;this._hadJustEnded=false;this._milestoneTimeoutDuration=1e3;this._allVideoMilestone=this._createVideoMilestones();this._activeVideoMilestones=[];this._milestonesSeeked=debounce(()=>{if(this._hadSeeked){return}if(this._hadJustEnded&&this._isAcVideo()){this._hadJustEnded=false;return}this._hadSeeked=true;this._refreshMilestones();if(this.videoElement&&!this.videoElement.paused){this._milestoneTimeoutDuration=2500;this._checkForMilestone()}},100);this._milestonesSeekedCancel=this._milestonesSeeked.cancel;this._bindMilestoneHandlers()}_createVideoMilestones(){const milestones=[];videoSegmentBoundries.forEach(function(item,index){if(index===videoSegmentBoundries.length-1){return}milestones.push([item,videoSegmentBoundries[index+1]])});return milestones}attachEvents(){const options=this.options;let mediaEventCallback;options.mediaEvents.forEach(function(mediaEvent){mediaEventCallback=options.mediaEventCallbacks[mediaEvent];mediaEventCallback=typeof mediaEventCallback==="function"?mediaEventCallback:this._defaultTracking.bind(this,mediaEvent);this._callbacks[mediaEvent]=mediaEventCallback;this.addListener(mediaEvent,this._callbacks[mediaEvent])}.bind(this));this._attachDefaultEvents()}_attachDefaultEvents(){this._prepareForPlayFromStart();this.video.on(this._events.ended,this._onEnded,this);this.video.on(this._events.timeupdate,this._onTimeupdate,this);if(this.options.trackCaptions===true){this.video.on(this._events.texttrackshow,this._onTextTrackShow,this)}}detachEvents(){const options=this.options;options.mediaEvents.forEach(function(mediaEvent){this.removeListener(mediaEvent,this._callbacks[mediaEvent])}.bind(this));this._detachPrivateEvents()}_detachPrivateEvents(){this.video.off(this._events.play,this._onPlayFromStart,this);this.video.off(this._events.PlayPromiseResolved,this._onPlayingFromStart,this);this.video.off(this._events.ended,this._onEnded,this);this.video.off(this._events.timeupdate,this._onTimeupdate,this);this.video.off(this._events.texttrackshow,this._onTextTrackShow,this)}_prepareForPlayFromStart(){if(!this._playBound){if(this.options.trackMilestones||this.options.trackSeeking){this._cleanUpMilestoneTracking()}if(IS_IE&&this._isAcVideo()&&this.ended){this.videoElement.addEventListener(this._events.playing,this._onPlayingFromStart)}else{if(IS_IE){this.video.once(this._events.play,this._onPlayFromStart,this)}else{this.video.once(this._getPlayEventName(),this._onPlayingFromStart,this)}}this._playBound=true}}_onPlayFromStart(e){if(this.started){return}if(this.options.trackMilestones||this.options.trackSeeking){this._setVideoElement();if(this.videoElement){if(IS_IE&&this._isAcVideo()&&this.ended){this.videoElement.removeEventListener(this._events.playing,this._onPlayingFromStart)}if(isHandheld&&!this._isAcVideo()){this.videoElement.addEventListener("webkitendfullscreen",this._onWebkitEndFullscreen)}}this._hadSeeked=false;this._refreshMilestones();this._startTrackingMilestones()}this._started=true;const data=this._bundleTrackingData(this._events.play,e);data.playCount=this.playCount;this.track(data);this.playCount+=1;this._playBound=false}_onWebkitEndFullscreen(){this._started=false;if(this.videoElement){this.videoElement.removeEventListener("webkitendfullscreen",this._prepareForPlayFromStart)}this._prepareForPlayFromStart()}_onTimeupdate(e){if(e.currentTime<.1){let paused=true;if(this.videoElement&&typeof this.videoElement.paused!==undefined){paused=this.videoElement.paused}if(this.playCount>0&&this._started&&paused){this._started=false;this._prepareForPlayFromStart()}}}_onEnded(e){if(this.options.trackMilestones||this.options.trackSeeking){this._milestonesSeekedCancel();this._hadJustEnded=true}this._started=false;const data=this._bundleTrackingData("ended",e);this.ended=true;this.track(data);this._prepareForPlayFromStart()}_onTextTrackShow(e){const videoEl=this.video._videoImpl.getMediaElement();const data=this._bundleTrackingData(this._events.texttrackshow,e);const isPlaying=!videoEl.paused&&!videoEl.ended&&videoEl.currentTime>0;if(isPlaying){data.ttShowCount=this.ttShowCount;this.track(data);this.ttShowCount+=1}}_setVideoElement(){if(!this.video){return}if(typeof this.video.getMediaElement!=="undefined"&&this.video.getMediaElement()){this.videoElement=this.video.getMediaElement();return}if(this.video.videoId){this.videoElement=document.querySelector('[data-analytics-video-id="'+this.video.videoId+'"] video')}}_startTrackingMilestones(){if(!this.videoElement){return}this._setMilestoneEventListeners();this._checkForMilestone()}_bindMilestoneHandlers(){this._milestonesSeeking=this._milestonesSeeking.bind(this);this._milestonesSeeked=this._milestonesSeeked.bind(this);this._milestonesPlay=this._milestonesPlay.bind(this);this._milestonesPause=this._milestonesPause.bind(this)}_setMilestoneEventListeners(){this.videoElement.addEventListener(this._events.seeking,this._milestonesSeeking);this.videoElement.addEventListener(this._events.seeked,this._milestonesSeeked);if(IS_IE||IS_MOBILE){this.videoElement.addEventListener(this._events.play,this._milestonesPlay)}else{this.videoElement.addEventListener(this._getPlayEventName(),this._milestonesPlay)}this.videoElement.addEventListener(this._events.pause,this._milestonesPause)}_milestonesSeeking(){if(this._hadSeeked){this._hadSeeked=false}if(this._milestoneTrackingTimeout){if(this._hadJustEnded&&this._isAcVideo()){return}clearTimeout(this._milestoneTrackingTimeout);this._milestoneTrackingTimeout=null}}_milestonesPlay(){this._checkForMilestone()}_milestonesPause(){clearTimeout(this._milestoneTrackingTimeout);this._milestoneTrackingTimeout=null}_checkForMilestone(){if(this._milestoneTrackingTimeout){clearTimeout(this._milestoneTrackingTimeout)}this._milestoneTrackingTimeout=setTimeout(function(){const milestone=this._getElligibleMilestone();if(milestone){this._trackMilestone(milestone)}this._milestoneTimeoutDuration=1e3;this._checkForMilestone()}.bind(this),this._milestoneTimeoutDuration)}_getElligibleMilestone(){if(!this.videoElement||this.videoElement.paused||this.videoElement.currentTime===0||this.videoElement.readyState<3||this.videoElement.duration===0||this.videoElement.duration===Infinity||isNaN(this.videoElement.duration)){return}if(!this._activeVideoMilestones[0]){return}const currentTimeAsPercentage=this.videoElement.currentTime/this.videoElement.duration;if(isNaN(currentTimeAsPercentage)){return}const firstMilestoneBoundry=this._activeVideoMilestones[0][0];if(firstMilestoneBoundry>currentTimeAsPercentage){return}let matchedMilestoneIndex;const currentMilestone=this._activeVideoMilestones.filter(function(milestone,index){if(currentTimeAsPercentage>=milestone[0]&&currentTimeAsPercentage<milestone[1]){matchedMilestoneIndex=index;return true}});if(currentMilestone&&currentMilestone[0]){return{name:currentMilestone[0][0],index:matchedMilestoneIndex}}}_trackMilestone(milestone){this._activeVideoMilestones.splice(milestone.index,1);const data=this._bundleTrackingData("milestone");data.milestone=milestone.name;if(this._hadSeeked){data.seeked=true;this._hadSeeked=false}this.track(data)}_cleanUpMilestoneTracking(){this._hadSeeked=false;this._refreshMilestones();clearTimeout(this._milestoneTrackingTimeout);this._milestoneTrackingTimeout=null;if(this.videoElement){this.videoElement.removeEventListener(this._events.seeking,this._milestonesSeeking);this.videoElement.removeEventListener(this._events.seeked,this._milestonesSeeked);if(IS_IE||IS_MOBILE){this.videoElement.removeEventListener(this._events.play,this._milestonesPlay)}else{this.videoElement.removeEventListener(this._getPlayEventName(),this._milestonesPlay)}this.videoElement.removeEventListener(this._events.pause,this._milestonesPause)}}_refreshMilestones(){if(this._hadSeeked){this._activeVideoMilestones=this._allVideoMilestone.slice(0)}else{this._activeVideoMilestones=this._allVideoMilestone.slice(1)}}addListener(eventType,callback){this.video.on(eventType,callback)}removeListener(eventType,callback){this.video.off(eventType,callback)}_getCommonVideoData(eventType){const data={};data.targetEl=this.video.el||null;const videoIdFromDataAttr=data.targetEl&&isNode(data.targetEl)?data.targetEl.getAttribute("data-"+dataAttributeAnalyticsId):"";data.videoId=videoIdFromDataAttr||this.video.targetId;data.ended=this.ended;data.eventType=eventType;if(data.eventType==="playing"){data.eventType="play"}if(this.videoElement){data.duration=NaN;data.currentTime=NaN;data.src=null;if(!isNaN(this.videoElement.duration)){data.duration=this.videoElement.duration}if(!isNaN(this.videoElement.currentTime)){data.currentTime=this.videoElement.currentTime}if(typeof this.videoElement.src!=="undefined"){data.src=this._getUniqueVideoId(this.videoElement.src)}}if(this._hadSeeked&&data.currentTime){data.currentTime=data.currentTime-this._milestoneTimeoutDuration/(this._milestoneTimeoutDuration/2)}return data}_getUniqueVideoId(videoSrc){let videoId=null;videoId=videoSrc.match(/[\w\d]{8}[\w\d-]+[\w\d/]+\//g);if(videoId&&videoId.length){return videoId[0]}return videoSrc}_bundleTrackingData(eventType,e){const commonTrackingData=this._getCommonVideoData(eventType);return Object.assign({},e,commonTrackingData)}_defaultTracking(eventType){const data=this._bundleTrackingData(eventType);this.track(data)}_isAcVideo(){return typeof this.video.play==="function"}_getPlayEventName(){if(this.video.VERSION){const isCustomPlayAvailable=this._isVersionGreaterOrEqual(this.video.VERSION.toArray(),AC_VIDEO_SUPPORTS_CUSTOM_PLAY_VERSION.split("."));if(isCustomPlayAvailable){return this._events.PlayPromiseResolved}else{return this._events.play}}return this._events.play}_isVersionGreaterOrEqual(v1,v2){if(!v1.length&&!v2.length){return true}else if(v1[0]>v2[0]){return true}else if(parseInt(v1[0])===parseInt(v2[0])){return this._isVersionGreaterOrEqual(v1.slice(1),v2.slice(1))}else if(v1[0]<v2[0]){return false}}track(data){if(!this.tracker){return}if(data.eventType==="milestone"){if(!this.options.trackMilestones&&typeof data.seeked==="undefined"){return}if(!this.options.trackSeeking&&typeof data.seeked!=="undefined"){return}}this.tracker.track({type:"video",data:data,options:this.options})}destroy(){this.detachEvents();this.options=null;this.tracker=null;this.video=null;this.playCount=null;this.ttShowCount=null;this._events=null;this._callbacks=null;observerRegistry.remove(this)}}module.exports=VideoAnalyticsObserver},{"../ErrorHandler":356,"../Tracker":358,"./observerRegistry":396,"@marcom/ac-dom-nodes/isNode":267,"@marcom/feature-detect/isHandheld":300,"@marcom/function-utils/debounce":303,"@marcom/useragent-detect":308}],396:[function(require,module,exports){let idIncrementor=0;class observerRegistry{constructor(){this.observers={}}destroy(){const obs=this.observers;Object.keys(this.observers).forEach(observerGroup=>{if(obs[observerGroup]){obs[observerGroup].forEach(observer=>{if(observer.destroy){observer.destroy()}})}});idIncrementor=0}add(observer){if(!this.observers[observer.observerType]){this.observers[observer.observerType]=[]}observer.observerId=idIncrementor;idIncrementor++;this.observers[observer.observerType].push(observer)}remove(observer){if(!this.observers[observer.observerType]){return}this.observers[observer.observerType]=this.observers[observer.observerType].filter(obs=>{if(obs.observerId!==observer.observerId){return true}});if(!this.observers[observer.observerType].length){delete this.observers[observer.observerType]}}}module.exports=new observerRegistry},{}],397:[function(require,module,exports){const errorHandler=require("./ErrorHandler");const moduleName="PassiveTracker";const passiveTrackerPath=require("./constants").dataLayer.paths.passiveTracker;const templateVarHelper=require("./helpers/templateVar");const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;function track(data,options){options=options||{};if(!data||typeof data!=="object"||Array.isArray(data)){errorHandler.warn(moduleName,"track","data must be a valid object");return}options.priority=options.priority||50;options.trackOnPageLoad=options.trackOnPageLoad===true;options.trackOnExitLink=options.trackOnExitLink===true;data.options={};if(options.overwriteAppMeasurementValues){data.options.overwriteAppMeasurementValues=true}if(options.overwriteAppMeasurementEvents===false){data.options.overwriteAppMeasurementEvents=false}if(options.trackOnPageLoad){data.options.trackOnPageLoad=true}if(options.trackOnExitLink){data.options.trackOnExitLink=true}data.options.priority=options.priority;let dataStr=JSON.stringify(data);if(!dataStr){errorHandler.warn(moduleName,"track","data was invalid because it could not be stringified");return}dataStr=templateVarHelper.translate(dataStr,templateVarHelper.set());storeTrackingData(JSON.parse(dataStr),options)}function storeTrackingData(data,options){const existingData=getExistingData(options);if(!existingData){storeData([data]);return}const mergedData=createMergedData(data,existingData,options);if(mergedData){storeData(mergedData)}}function getExistingData(options){if(options.overwriteStorageItem){return null}let existingData=get(passiveTrackerPath);if(!existingData){return}existingData=JSON.parse(existingData);if(typeof existingData!=="object"){return null}return existingData}function createMergedData(newData,existingData){existingData.push(newData);return existingData}function storeData(value){if(typeof value==="object"){value=JSON.stringify(value)}set(passiveTrackerPath,value)}module.exports=track},{"./ErrorHandler":356,"./constants":359,"./helpers/templateVar":383,"@apple/analytics-data-layer":46}],398:[function(require,module,exports){class TrackerRegistry{constructor(){this.registry={}}addEntry(type,name,order,track){this.registry[name]={type:type,name:name,order:order,track:track}}processBeaconByType(type,data){const registryArr=Object.values(this.registry);const filteredTrackers=registryArr.filter(tracker=>{return tracker.type===type});filteredTrackers.sort((a,b)=>a.order-b.order);filteredTrackers.forEach(tracker=>{tracker.track(data)})}registerAllTrackers(){const trackers=[require("./pageHide"),require("./endOfPage"),require("./pageLoad"),require("./storeDeferredBeaconAtPageLoad"),require("./customPageLoad"),require("./deferredToPageLoad"),require("./sectionEngagement"),require("./click"),require("./link"),require("./navigationalLink"),require("./gallery"),require("./video"),require("./event"),require("./elementEngagement"),require("./performance"),require("./search/begin"),require("./search/perform")];trackers.forEach(tracker=>{tracker.initialize()})}}module.exports=new TrackerRegistry},{"./click":399,"./customPageLoad":400,"./deferredToPageLoad":401,"./elementEngagement":402,"./endOfPage":403,"./event":404,"./gallery":405,"./link":406,"./navigationalLink":407,"./pageHide":408,"./pageLoad":409,"./performance":410,"./search/begin":413,"./search/perform":414,"./sectionEngagement":415,"./storeDeferredBeaconAtPageLoad":416,"./video":417}],399:[function(require,module,exports){const registry=require("./TrackerRegistry");const regions=require("./regions/regions");const parseFromDataAttribute=require("../helpers/parseFromDataAttribute");const get=require("@apple/analytics-data-layer").get;const setOptions=require("../helpers/setOptions");const separator=require("../helpers/separator");const formatter=require("../helpers/formatter");const dataLayerConfig=require("../constants").dataLayer.configuration;const confKey=dataLayerConfig.key;const confKeys=dataLayerConfig.keys;const moduleName="clickTracker";function initialize(){registry.addEntry("click",moduleName,50,track)}function track(trackingData){const data=generateSourceData(trackingData);trackingData.beacon.title=data.formattedTitle;trackingData.beacon.prop3=data.formattedTitle;trackingData.beacon.eVar1=get([confKey,confKeys.computedPageName])+separator.pipe+data.regionAncestry+data.title;_setCustomTrackingProps(trackingData);trackingData.options.async=setOptions.async(trackingData.data);return trackingData}function generateSourceData(trackingData){const data={};let title;const linkTitleAttribute=trackingData.data.targetEl.getAttribute("data-"+trackingData.options.titleDataAttribute);if(linkTitleAttribute){title=linkTitleAttribute}else{if(trackingData.data.targetEl.textContent){title=trackingData.data.targetEl.textContent.trim()}else if(trackingData.data.targetEl.innerText){title=trackingData.data.targetEl.innerText.trim()}else{title="no title available"}}title=title.toLowerCase();data.title=title;data.formattedTitle=get([confKey,confKeys.pageName])+separator.hyphen+title;data.regionAncestry=regions.getRegionAncestryByElement(trackingData.data.targetEl);data.regionAncestry=formatter.getRegionAncestry(data);return data}function _setCustomTrackingProps(trackingData){const dataAttrValue=trackingData.data.targetEl.getAttribute("data-"+trackingData.options.dataAttribute);const customProperties=dataAttrValue?parseFromDataAttribute(dataAttrValue,trackingData.data.targetEl):"";if(!customProperties&&typeof customProperties!=="object"){return}for(const key in customProperties){if(key==="usePassiveTracker"){if(customProperties[key]==="true"){trackingData.options.usePassiveTracker=true}}else if(key==="useBeacon"){if(customProperties[key]==="true"){trackingData.options.useBeacon=true}}else{trackingData.beacon[key]=customProperties[key]}}}module.exports={initialize:initialize,track:track}},{"../constants":359,"../helpers/formatter":368,"../helpers/parseFromDataAttribute":379,"../helpers/separator":380,"../helpers/setOptions":381,"./TrackerRegistry":398,"./regions/regions":412,"@apple/analytics-data-layer":46}],400:[function(require,module,exports){const registry=require("./TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const errorHandler=require("../ErrorHandler");const moduleName="customPageLoad";const dataLayerKeys=require("../constants").dataLayer;const confKey=dataLayerKeys.configuration.key;const confKeys=dataLayerKeys.configuration.keys;function initialize(){registry.addEntry("page",moduleName,100,track)}function track(trackingData){let pageData=get([confKey,confKeys.pageTrackingData]);if(!pageData){return trackingData}try{pageData=JSON.parse(pageData)}catch(e){errorHandler.warn(moduleName,"_setCustomProps","JSON.parse had an error with the input of: \n\n"+pageData+"\n\nIs it in proper JSON format? \n\nOriginal error:\n"+e)}if(!pageData||typeof pageData!=="object"||Array.isArray(pageData)){return trackingData}for(const prop in pageData){if(pageData.hasOwnProperty(prop)){trackingData.beacon[prop]=pageData[prop]}}return trackingData}module.exports={initialize:initialize,track:track}},{"../ErrorHandler":356,"../constants":359,"./TrackerRegistry":398,"@apple/analytics-data-layer":46}],401:[function(require,module,exports){const registry=require("./TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const remove=require("@apple/analytics-data-layer").remove;const dataLayerKeys=require("../constants").dataLayer;const deferredPath=dataLayerKeys.paths.deferred;const setProperty=require("../helpers/setProperty");const moduleName="deferredToPageLoad";function initialize(){registry.addEntry("page",moduleName,50,track)}function track(trackingData){const deferredData=_getDeferredData()||{};Object.keys(deferredData).forEach(key=>{setProperty(trackingData.beacon,key,deferredData[key])});if(!trackingData.beacon.prop57&&deferredData.hier1){setProperty(trackingData.beacon,"prop57",deferredData.hier1)}return trackingData}function _getDeferredData(){let deferredBeacon=get(deferredPath);remove(deferredPath);if(!deferredBeacon){deferredBeacon={}}delete deferredBeacon.eVar15;return deferredBeacon}module.exports={initialize:initialize,track:track}},{"../constants":359,"../helpers/setProperty":382,"./TrackerRegistry":398,"@apple/analytics-data-layer":46}],402:[function(require,module,exports){const registry=require("./TrackerRegistry");const moduleName="elementEngagementTracker";function initialize(){registry.addEntry("elementEngagement",moduleName,50,track)}function track(trackingData){trackingData.beacon.title="element engagement";trackingData.beacon.events="event316";trackingData.beacon.prop3=trackingData.data.engagementTitle;trackingData.beacon.eVar30=trackingData.options?.target?.dataset?.analyticsRegion||"missing region";return trackingData}module.exports={track:track,initialize:initialize}},{"./TrackerRegistry":398}],403:[function(require,module,exports){const registry=require("./TrackerRegistry");const moduleName="endOfPageTracker";function initialize(){registry.addEntry("endOfPage",moduleName,50,track)}function track(trackingData){trackingData.beacon={title:"end of page",events:trackingData.data.events};return trackingData}module.exports={initialize:initialize,track:track}},{"./TrackerRegistry":398}],404:[function(require,module,exports){const registry=require("./TrackerRegistry");const moduleName="customTracker";function initialize(){registry.addEntry("custom",moduleName,50,track)}function track(trackingData){for(const key in trackingData.data){trackingData.beacon[key]=trackingData.data[key]}return trackingData}module.exports={track:track,initialize:initialize}},{"./TrackerRegistry":398}],405:[function(require,module,exports){const registry=require("./TrackerRegistry");const ancestor=require("@marcom/dom-traversal/ancestor");const get=require("@apple/analytics-data-layer").get;const formatter=require("../helpers/formatter");const separator=require("../helpers/separator");const dataLayerConfig=require("../constants").dataLayer.configuration;const moduleName="galleryTracker";const interactionTypes={click:function(trackingData){return _triggerNavType(trackingData)||"click"},auto:function(){return"auto"},keydown:function(){return"keydown"},touchend:function(){return"swipe"},touchstart:function(){return"swipe"},touchmove:function(){return"swipe"}};const interactionTypeMap={click:"ci",keydown:"ki",swipe:"si",dotnav:"bi",thumbnav:"ci",tabnav:"ci",paddlenav:"pi",auto:"ai"};function initialize(){registry.addEntry("gallery",moduleName,50,track)}function track(trackingData){const interactionEventType=_interactionEventType(trackingData);let interactionType=interactionEventType;let outgoingInteractionType;let incomingInteractionType;if(interactionTypes[interactionEventType]){interactionType=interactionTypes[interactionEventType](trackingData)}trackingData.data.targetEl=_getTargetElement(trackingData);trackingData.data.slideInViewTime=_slideInViewTime(trackingData);trackingData.data.outgoingInteractionType=trackingData.observer.outgoingSlideInteractionType;trackingData.data.incomingInteractionType=interactionType;trackingData.data.galleryFirstTimeTrigger=_isFirstTimeGalleryTrigger(trackingData);trackingData.observer.outgoingSlideInteractionType=interactionType;if(interactionTypeMap[trackingData.data.incomingInteractionType]){incomingInteractionType=interactionTypeMap[trackingData.data.incomingInteractionType]}if(typeof incomingInteractionType==="undefined"){incomingInteractionType="ci"}if(interactionTypeMap[trackingData.data.outgoingInteractionType]){outgoingInteractionType=interactionTypeMap[trackingData.data.outgoingInteractionType]}if(typeof outgoingInteractionType==="undefined"){outgoingInteractionType="ci"}const propString=get([dataLayerConfig.key,dataLayerConfig.keys.pageName])+separator.hyphen+trackingData.options.galleryName+separator.hyphen;trackingData.beacon.prop2=formatter.eventString(outgoingInteractionType,"")+propString+trackingData.data.outgoing.id;trackingData.beacon.prop3=trackingData.beacon.title=formatter.eventString(incomingInteractionType,"")+propString+trackingData.data.incoming.id;if(trackingData.data.galleryFirstTimeTrigger===true){trackingData.beacon.prop16="gallery interaction";trackingData.beacon.eVar16=(trackingData.options.galleryName?trackingData.options.galleryName+" ":"")+"gallery interaction";trackingData.beacon.events="event1"}return trackingData}function _triggerNavType(trackingData){let type=false;const trigger=_getTargetElement(trackingData);if(trigger){type=_getNavType(trigger)}return type}function _getNavType(trigger){let containerClassName;let i;let type=null;const interactionTypeClasses=["dotnav","thumbnav","paddlenav","tabnav"];const interactionTypeAttribute="data-analytics-gallery-interaction-type";const triggerContainerSelector=".dotnav, .thumbnav, .paddlenav, .tabnav, ["+interactionTypeAttribute+"]";const triggerContainer=ancestor(trigger,triggerContainerSelector);if(triggerContainer){if(triggerContainer.hasAttribute(interactionTypeAttribute)){type=triggerContainer.getAttribute(interactionTypeAttribute)}else{containerClassName=triggerContainer.className;for(i=0;i<interactionTypeClasses.length;i++){if(containerClassName.indexOf(interactionTypeClasses[i])!==-1){type=interactionTypeClasses[i];break}}}}return type}function _getTargetElement(trackingData){const interactionEvent=trackingData.data.interactionEvent;let element=false;if(interactionEvent){element=interactionEvent.target||interactionEvent.srcElement}return element}function _slideInViewTime(trackingData){return trackingData.data.incomingSlideTimestamp-trackingData.data.outgoingSlideTimestamp}function _isFirstTimeGalleryTrigger(trackingData){const incomingInteractionType=trackingData.data.incomingInteractionType;const observer=trackingData.observer;let firstTimeGalleryTrigger=false;if(incomingInteractionType!=="auto"&&observer.trackedInteractionTypes.indexOf(incomingInteractionType)===-1){firstTimeGalleryTrigger=true;observer.trackedInteractionTypes.push(incomingInteractionType)}return firstTimeGalleryTrigger}function _interactionEventType(trackingData){const data=trackingData.data;let type="auto";if(data.interactionEvent&&data.interactionEvent.type){type=data.interactionEvent.type}return type}module.exports={track:track,initialize:initialize}},{"../constants":359,"../helpers/formatter":368,"../helpers/separator":380,"./TrackerRegistry":398,"@apple/analytics-data-layer":46,"@marcom/dom-traversal/ancestor":293}],406:[function(require,module,exports){const registry=require("./TrackerRegistry");const regions=require("./regions/regions");const separator=require("../helpers/separator");const formatter=require("../helpers/formatter");const dataLayerConfig=require("../constants").dataLayer.configuration;const get=require("@apple/analytics-data-layer").get;const moduleName="linkTracker";function initialize(){registry.addEntry("link",moduleName,50,track)}function track(trackingData){const targetElParentRegion=regions.getRegionByElement(trackingData.data.targetEl);const linkTitle=trackingData.data.targetEl.getAttribute("data-"+trackingData.options.titleDataAttribute);if(linkTitle){trackingData.data.linkText=linkTitle}else{if(trackingData.data.targetEl.textContent){trackingData.data.linkText=trackingData.data.targetEl.textContent.trim()}else if(trackingData.data.targetEl.innerText){trackingData.data.linkText=trackingData.data.targetEl.innerText.trim()}else{trackingData.data.linkText="no title available"}}trackingData.data.regionAncestry=regions.getRegionAncestryByElement(trackingData.data.targetEl);if(trackingData.data.targetEl.id){trackingData.data.linkId=trackingData.data.targetEl.id}if(typeof targetElParentRegion==="object"){trackingData.data.region=targetElParentRegion.name}setNavigationSrc(trackingData);return trackingData}function setNavigationSrc(trackingData){const data=trackingData.data;const epubBeacon={};const linkTrackingBeacon={};const regionAncestry=formatter.getRegionAncestry(data);const pageName=get([dataLayerConfig.key,dataLayerConfig.keys.computedPageName])||"";const linkText=data.linkText||"";linkTrackingBeacon.eVar1=epubBeacon.eVar1=pageName+separator.pipe+regionAncestry+linkText;linkTrackingBeacon.prop57=epubBeacon.prop57=get([dataLayerConfig.key,dataLayerConfig.keys.computedChannel])||"";trackingData.beacon=linkTrackingBeacon}module.exports={track:track,initialize:initialize}},{"../constants":359,"../helpers/formatter":368,"../helpers/separator":380,"./TrackerRegistry":398,"./regions/regions":412,"@apple/analytics-data-layer":46}],407:[function(require,module,exports){const registry=require("./TrackerRegistry");const pageHide=require("./pageHide");const moduleName="navigationalLinkTracker";function initialize(){registry.addEntry("navigationalLink",moduleName,50,track)}function track(trackingData){return pageHide.track(trackingData)}module.exports={track:track,initialize:initialize}},{"./TrackerRegistry":398,"./pageHide":408}],408:[function(require,module,exports){const registry=require("./TrackerRegistry");const moduleName="beforeUnload";const getPassiveTrackerData=require("../helpers/getPassiveTrackerData");const filterBeaconsByType=require("../helpers/filterBeaconsByType");const mergePassiveTrackerData=require("../helpers/mergePassiveTrackerData");const remove=require("@apple/analytics-data-layer").remove;const passiveTrackerPath=require("../constants").dataLayer.paths.passiveTracker;const{merge}=require("@apple/analytics-merge-beacons");function initialize(){registry.addEntry("pageHide",moduleName,50,track)}function track(trackingData){let data=getPassiveTrackerData();if(!data){return trackingData}data=filterBeaconsByType(data,"page");if(!data.length){return trackingData}data=mergePassiveTrackerData(data);trackingData.beacon=merge({target:trackingData.beacon,source:data});remove(passiveTrackerPath);return trackingData}module.exports={initialize:initialize,track:track}},{"../constants":359,"../helpers/filterBeaconsByType":367,"../helpers/getPassiveTrackerData":370,"../helpers/mergePassiveTrackerData":377,"./TrackerRegistry":398,"@apple/analytics-data-layer":46,"@apple/analytics-merge-beacons":94}],409:[function(require,module,exports){const registry=require("./TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const separator=require("../helpers/separator");const moduleName="pageLoad";const dataLayerKeys=require("../constants").dataLayer;const confKey=dataLayerKeys.configuration.key;const confKeys=dataLayerKeys.configuration.keys;const setProperty=require("../helpers/setProperty");function initialize(){registry.addEntry("page",moduleName,1,track)}function track(trackingData){setProperty(trackingData.beacon,"prop20",`AOS${separator.colon}{COUNTRY_CODE}`);setProperty(trackingData.beacon,"pageName",get([confKey,confKeys.computedPageName]));setProperty(trackingData.beacon,"channel",get([confKey,confKeys.computedChannel]));setProperty(trackingData.beacon,"eVar3",trackingData.beacon.prop20);if(window.ac_target?.ssdata){setProperty(trackingData.beacon,"eVar57",window.ac_target.ssdata)}return trackingData}module.exports={initialize:initialize,track:track}},{"../constants":359,"../helpers/separator":380,"../helpers/setProperty":382,"./TrackerRegistry":398,"@apple/analytics-data-layer":46}],410:[function(require,module,exports){const registry=require("./TrackerRegistry");const passiveTracker=require("../passiveTracker");const performanceTimingEvents=require("../constants").performanceTimingEvents;const passiveTrackerOptions={trackOnPageLoad:true,trackOnExitLink:true};const moduleName="performanceTracker";let hasTracked=false;function initialize(){registry.addEntry("readyStateComplete",moduleName,50,track)}function track(trackingData){const timing=window&&window.performance&&window.performance.timing;if(!timing||hasTracked){return}const options=trackingData.options;const interval=setInterval(()=>{if(window.performance.timing.loadEventEnd){performanceWrite(window.performance,options);trackFirstContentfulPaint(window.performance);hasTracked=true;clearInterval(interval)}},200)}function trackFirstContentfulPaint(performance){const firstContentfulPaint=performance.getEntriesByName("first-contentful-paint");if(!firstContentfulPaint||!firstContentfulPaint.length||!firstContentfulPaint[0].startTime||!firstContentfulPaint[0].startTime.toFixed(2)){return}const data={events:`event419=${(firstContentfulPaint[0].startTime/1e3).toFixed(3)},event420`};passiveTracker(data,passiveTrackerOptions)}function trackFirstMeaningfulPaint(time){if(!time){if(!window||!window.performance||!window.performance){return}time=window.performance.now()}else{time=parseFloat(time)}if(typeof time!=="number"){return}const data={events:`event421=${(time/1e3).toFixed(3)},event422`};passiveTracker(data,passiveTrackerOptions)}function performanceWrite(performance){const pt=performance.timing;const performanceDataArr=[];performanceDataArr.push(performanceCheck(pt.fetchStart,pt.navigationStart));performanceDataArr.push(performanceCheck(pt.domainLookupStart,pt.fetchStart));performanceDataArr.push(performanceCheck(pt.domainLookupEnd,pt.domainLookupStart));performanceDataArr.push(performanceCheck(pt.connectEnd,pt.connectStart));performanceDataArr.push(performanceCheck(pt.responseStart,pt.connectEnd));performanceDataArr.push(performanceCheck(pt.responseEnd,pt.responseStart));performanceDataArr.push(performanceCheck(pt.domInteractive,pt.domLoading));performanceDataArr.push(performanceCheck(pt.domContentLoadedEventEnd,pt.domInteractive));performanceDataArr.push(performanceCheck(pt.domComplete,pt.domContentLoadedEventEnd));performanceDataArr.push(performanceCheck(pt.loadEventStart,pt.domLoading));performanceDataArr.push(performanceCheck(pt.loadEventEnd,pt.loadEventStart));performanceDataArr.push(performanceCheck(pt.loadEventEnd,pt.navigationStart));const eventList=performanceTimingEvents.split(",");let eventsStr="";eventList.forEach((event,index)=>{if(typeof performanceDataArr[index]!=="undefined"){eventsStr+=`${event}=${performanceDataArr[index]},`}else{eventsStr+=`${event},`}});eventsStr=eventsStr.substring(0,eventsStr.length-1);const eventTrackingData={events:eventsStr};passiveTracker(eventTrackingData,passiveTrackerOptions)}function performanceCheck(a,b){if(a-b<6e4&&a-b>=0){return((a-b)/1e3).toFixed(3)}else{return 600}}module.exports={track:track,initialize:initialize,trackFirstMeaningfulPaint:trackFirstMeaningfulPaint}},{"../constants":359,"../passiveTracker":397,"./TrackerRegistry":398}],411:[function(require,module,exports){const dataAttribute="analytics-region";const optionsAttribute="analytics-options";const validJSONPattern=/(?:\w+:\w+)(?:,(?=(?:\w+:\w+))|$)/;const singleValuePattern=/[\w\s]+/;const dataStringToObject=require("../../helpers/dataStringToObject");class Region{constructor(regionElement){this.element=regionElement;this.childRegions={};this.parentRegion="";this.options=this.getDataOptions();this.name=this.setName()}setName(){let value="";if(this.options.name){value=this.options.name}if(!this.options.name&&this.element.id){this.options.name=this.element.id}return value}getDataOptions(){let data={};let value=this.element.getAttribute("data-"+dataAttribute);let options=this.element.getAttribute("data-"+optionsAttribute);value=this._removeTrailingCommas(value);options=this._removeTrailingCommas(options);if(this._isJSONable(value)){data=dataStringToObject(value)}else if(this._isSingleValue(value)){data.name=value}if(options&&this._isJSONable(options)){data=Object.assign({},data,dataStringToObject(options))}for(const key in data){if(data.hasOwnProperty(key)){if(data[key]==="false"){data[key]=false}else if(data[key]==="true"){data[key]=true}}}return data}_isJSONable(value){return validJSONPattern.test(value)}_isSingleValue(value){return singleValuePattern.test(value)}_removeTrailingCommas(str){if(str&&typeof str==="string"){return str.charAt(str.length-1)===","?str.substr(0,str.length-1):str}}}module.exports={Region:Region,dataAttribute:dataAttribute}},{"../../helpers/dataStringToObject":364}],412:[function(require,module,exports){const domNodes=require("@marcom/ac-dom-nodes");const Region=require("./Region").Region;const dataAttribute=require("./Region").dataAttribute;let allRegions=[];const tree={};function getAllRegions(){if(allRegions.length>0){return allRegions}const allRegionsElements=document.querySelectorAll("[data-"+dataAttribute+"]");let topLevelRegion;const regionsLen=allRegionsElements.length;let i=0;function _getChildRegions(regionObj){let childRegion;while(domNodes.isNodeType(allRegionsElements[i+1],domNodes.NODE_TYPES.ELEMENT)&&regionObj.element.contains(allRegionsElements[i+1])){childRegion=new Region(allRegionsElements[i+1]);allRegions.push(childRegion);childRegion.parentRegion=regionObj.name;regionObj.childRegions[childRegion.name]=childRegion;i+=1;_getChildRegions(childRegion)}}for(i;i<regionsLen;i+=1){topLevelRegion=new Region(allRegionsElements[i]);tree[topLevelRegion.name]=topLevelRegion;allRegions.push(topLevelRegion);_getChildRegions(topLevelRegion)}return allRegions}function getTree(){getAllRegions();if(Object.keys(tree).length>0){return tree}return undefined}function getRegionByElement(element){if(domNodes.isNodeType(element,domNodes.NODE_TYPES.ELEMENT)){const allAncestorRegions=getRegionAncestryByElement(element);let region;if(allAncestorRegions.length>0){region=allAncestorRegions.pop();return region}}return undefined}function getRegionAncestryByElement(element){const parsedRegions=getAllRegions();if(domNodes.isNodeType(element,domNodes.NODE_TYPES.ELEMENT)){return parsedRegions.filter(function(region){const containsElement=region.element.contains(element);if(containsElement){_refreshDynamicRegion(region);return true}})}return undefined}function getRegionByName(name){const parsedRegions=getAllRegions();if(typeof name==="string"){return parsedRegions.filter(function(region){_refreshDynamicRegion(region);return region.name===name})}return undefined}function _refreshDynamicRegion(region){if(region.options&&region.options.dynamic){refreshRegion(region)}}function refreshRegion(region){let regionObj=region;if(domNodes.isNodeType(region,domNodes.NODE_TYPES.ELEMENT)){regionObj=getRegionByElement(region)}if(typeof regionObj==="object"){allRegions.forEach(function(r){if(r.element===regionObj.element){r.options=r.getDataOptions();r.name=r.setName()}})}}function clearRegions(){allRegions=[]}module.exports={getTree:getTree,getAllRegions:getAllRegions,getRegionByElement:getRegionByElement,getRegionByName:getRegionByName,getRegionAncestryByElement:getRegionAncestryByElement,refreshRegion:refreshRegion,clearRegions:clearRegions}},{"./Region":411,"@marcom/ac-dom-nodes":260}],413:[function(require,module,exports){const getBeginBeacon=require("@apple/analytics-search").begin;const merge=require("@apple/analytics-merge-beacons").merge;const registry=require("../TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../constants").dataLayer.configuration;const confKey=dataLayerConfig.key;const confKeys=dataLayerConfig.keys;const pageTypeKey=[confKey,confKeys.pageType];const moduleName="beginSearchTracker";const config={action:{OPEN:"open",CLOSE:"close",ENGAGE:"engage"},errorPage:{pageType:"errorPage",id:"searchform-input"},trackEvents:["linkClick","focusin"],globalNav:".ac-gn-link-search, #globalnav-menubutton-link-search"};function initialize(){registry.addEntry("linkClick",moduleName+"LinkClick",50,track);registry.addEntry("focusin",moduleName+"FocusIn",50,track)}function track(data){const searchObj=getSearchObj(data);if(searchObj){merge({target:data.beacon,source:getBeginBeacon(searchObj)});data.beacon.title=data.beacon.prop3;return data}return null}function getSearchObj(data){if(!data||!data.type||!data.event||!data.event.dynamicEventBinderTarget){return null}const isTrackedEvent=config.trackEvents.includes(data.type);if(!isTrackedEvent){return null}const el=data.event.dynamicEventBinderTarget;const isErrorPage=get(pageTypeKey)===config.errorPage.pageType&&el.id===config.errorPage.id;if(isErrorPage){return{action:config.action.ENGAGE}}const isGlobalNav=el.matches(config.globalNav);if(isGlobalNav){const shouldOpen=Boolean(el.dataset.analyticsTitle);return{action:shouldOpen?config.action.OPEN:config.action.CLOSE}}return null}module.exports={track:track,initialize:initialize}},{"../../constants":359,"../TrackerRegistry":398,"@apple/analytics-data-layer":46,"@apple/analytics-merge-beacons":94,"@apple/analytics-search":144}],414:[function(require,module,exports){const getPerformBeacon=require("@apple/analytics-search").perform;const merge=require("@apple/analytics-merge-beacons").merge;const registry=require("../TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const dataLayerConfig=require("../../constants").dataLayer.configuration;const confKey=dataLayerConfig.key;const confKeys=dataLayerConfig.keys;const pageTypeKey=[confKey,confKeys.pageType];const moduleName="performSearchTracker";const config={errorPage:{pageType:"errorPage",id:"searchform-form"},searchPage:{pageType:"search"},trackEvents:["submit","linkClick"],globalNav:"#ac-gn-searchform, .globalnav-searchfield",globalNavLink:".ac-gn-searchresults-link, .globalnav-searchresults-list-link",searchSource:{ERROR:"error",SEARCH:"search",MARCOM:"www"},searchMethod:{TYPED:"typed",DEFAULT:"default"},keywordSelectors:{globalNav:"#ac-gn-searchform-input, .globalnav-searchfield-input",errorPage:"#searchform-input"}};function initialize(){registry.addEntry("linkClick",moduleName+"LinkClick",50,track);registry.addEntry("submit",moduleName+"FocusIn",50,track)}function track(data){const searchObj=getSearchObj(data);if(searchObj){data.options.deferred=true;data.options.silent=true;merge({target:data.beacon,source:getPerformBeacon(searchObj)});return data}return null}function getSearchObj({type,event}){if(!event||!config.trackEvents.includes(type)){return null}const el=event.dynamicEventBinderTarget;const searchObjProcessors=[submitForm,clickLink];return searchObjProcessors.reduce((acc,searchObjProcessor)=>acc||searchObjProcessor({el:el}),null)||null}function clickLink({el}){if(!el.matches(config.globalNavLink)){return null}const method=getElementDataSet(el,"section");return{keyword:getElementDataSet(el,"query"),method:method,position:getElementDataSet(el,"index"),results:getElementDataSet(el,"items"),source:getSearchSource(el),suggestedValue:getElementDataSet(el,"label"),type:method}}function getElementDataSet(element,datasetName){return element.dataset[datasetName]||null}function getSearchSource(el){const isErrorPage=get(pageTypeKey)===config.errorPage.pageType;if(isErrorPage){return config.searchSource.ERROR}const isSearchPage=get(pageTypeKey)===config.searchPage.pageType;if(isSearchPage){return config.searchSource.SEARCH}return config.searchSource.MARCOM}function getInputValue(el){const isErrorPage=get(pageTypeKey)===config.errorPage.pageType;if(isErrorPage){return el.querySelector(config.keywordSelectors.errorPage)?.value||null}const isGlobalNav=el.matches(config.globalNav);if(isGlobalNav){return el.querySelector(config.keywordSelectors.globalNav)?.value||null}return null}function submitForm({el}){const isSearchForm=el.matches(config.globalNav)||el.id===config.errorPage.id;if(isSearchForm){return{keyword:getInputValue(el),method:config.searchMethod.TYPED,source:getSearchSource(el)}}return null}module.exports={track:track,initialize:initialize}},{"../../constants":359,"../TrackerRegistry":398,"@apple/analytics-data-layer":46,"@apple/analytics-merge-beacons":94,"@apple/analytics-search":144}],415:[function(require,module,exports){const registry=require("./TrackerRegistry");const moduleName="sectionEngagement";function initialize(){registry.addEntry("section",moduleName,50,track)}function track(trackingData){const trackedElement=trackingData.data.element;const elementName=trackedElement.name||trackedElement.id||trackedElement.dataAttrValue||"";const timeInThreshold=trackedElement.thresholdExitTime-trackedElement.thresholdEnterTime;trackingData.beacon.title="section engagement";trackingData.beacon.prop34=elementName;trackingData.beacon.prop35=(timeInThreshold/1e3).toFixed(2);trackingData.beacon.prop36=trackedElement.element.position;if(trackingData.beacon.prop35){const event243WithValue="event243="+trackingData.beacon.prop35;trackingData.beacon.events=event243WithValue+",event244"}return trackingData}module.exports={initialize:initialize,track:track}},{"./TrackerRegistry":398}],416:[function(require,module,exports){const registry=require("./TrackerRegistry");const dataLayerConfig=require("../constants").dataLayer.configuration;const get=require("@apple/analytics-data-layer").get;const{merge,set}=require("@apple/analytics-passive-tracker");const moduleName="storeForNextPageTracker";function initialize(){registry.addEntry("storeAtPageLoad",moduleName,50,track)}function track(trackingData){const pageName=get([dataLayerConfig.key,dataLayerConfig.keys.computedPageName]);const epubBeacon={};trackingData.beacon.prop57=epubBeacon.prop57=get([dataLayerConfig.key,dataLayerConfig.keys.computedChannel])||"";set("pageName",pageName,{type:"page"});merge("beacon",epubBeacon,{type:"page"})}module.exports={track:track,initialize:initialize}},{"../constants":359,"./TrackerRegistry":398,"@apple/analytics-data-layer":46,"@apple/analytics-passive-tracker":126}],417:[function(require,module,exports){const registry=require("./TrackerRegistry");const get=require("@apple/analytics-data-layer").get;const formatter=require("../helpers/formatter");const separator=require("../helpers/separator");const dataLayerConfig=require("../constants").dataLayer.configuration;const moduleName="videoTracker";const eventTypes={play:function(){return"started"},ended:function(){return"ended"},texttrackshow:function(trackingData){if(trackingData.data.ttShowCount===0){return"texttrackshow"}return"texttrackshown"},milestone:function(trackingData){if(trackingData.data.seeked){return"seeked"}return"milestone"}};const interactionTypes={click:function(trackingData){return trackingData.data.event.type}};const milestoneEvents={0:{play:null,seek:"event214"},.1:{play:"event73",seek:"event215"},.25:{play:"event74",seek:"event216"},.5:{play:"event75",seek:"event217"},.75:{play:"event76",seek:"event218"},.9:{play:"event77",seek:"event219"}};const eventTypeMap={started:"s",ended:"e",texttrackshow:"ce",seeked:"sk",milestone:"m"};function initialize(){registry.addEntry("video",moduleName,50,track)}function track(trackingData){const data=trackingData.data;data.eventType=eventTypes[data.eventType]?eventTypes[data.eventType](trackingData):data.eventType;if(data.event&&interactionTypes[data.event.type]){data.interactionType=interactionTypes[data.event.type](trackingData)}if(!isNaN(data.duration)){data.duration=Math.round(data.duration).toString()}else{data.duration="unavailable"}if(!isNaN(data.currentTime)){data.currentTime=Math.round(data.currentTime).toString()}else{data.currentTime="unavailable"}if(!eventTypeMap[data.eventType]){trackingData.options.silent=true}else{trackingData.options.silent=false}const videoName=get([dataLayerConfig.key,dataLayerConfig.keys.pageName])+separator.hyphen+data.videoId;const eventType=data.eventType&&eventTypeMap[data.eventType]?eventTypeMap[data.eventType]:data.eventType;const title=_setTitle(data,videoName,eventType);const beacon={};beacon.title=beacon.prop13=title;beacon.eVar87=videoName;if(typeof data.duration!=="undefined"&&trackingData.options.trackDuration){beacon.eVar91=data.duration;_setEvents(beacon,"event233="+data.duration)}if(typeof data.currentTime!=="undefined"&&data.eventType!=="ended"&&trackingData.options.trackCurrentTime){beacon.eVar92=data.currentTime;_setEvents(beacon,"event69="+data.currentTime)}if(data.src){beacon.eVar95=data.src}if(data.eventType==="started"){beacon.prop16=beacon.eVar16="video plays";_setEvents(beacon,"event2")}if(data.eventType==="ended"){beacon.prop16=beacon.eVar16="video ends";_setEvents(beacon,"event72");if(typeof data.duration!=="undefined"&&trackingData.options.trackCurrentTime){beacon.eVar92=data.duration;_setEvents(beacon,"event69="+data.duration)}}if(data.eventType==="texttrackshow"){beacon.title=beacon.prop2=videoName+separator.hyphen+"cc";beacon.prop13=""}if(data.eventType==="milestone"||data.eventType==="seeked"){_setMilestoneEventValues(milestoneEvents,data,beacon);beacon.prop13=""}if(data.eventType==="milestone"){beacon.prop16=beacon.eVar16="video milestone"}if(data.eventType==="seeked"){beacon.eVar96=""+data.milestone*100;beacon.prop16=beacon.eVar16="video seek"}if(data.videoType&&data.playerType){beacon.prop18=data.videoType+" via "+data.playerType}trackingData.beacon=beacon;return trackingData}function _setMilestoneEventValues(events,data,beacon){let event;if(data.seeked){event=events[data.milestone].seek}else{event=events[data.milestone].play}_setEvents(beacon,event)}function _setEvents(beacon,event){if(beacon.events){beacon.events+=","+event}else{beacon.events=event}}function _setTitle(data,videoName,eventType){let title=formatter.eventString("v",eventType);let milestoneNumber=null;if(data.hasOwnProperty("milestone")&&!isNaN(data.milestone)){milestoneNumber=data.milestone*100}if(milestoneNumber!==null){title+=milestoneNumber}title+=": "+videoName;return title}module.exports={track:track,initialize:initialize}},{"../constants":359,"../helpers/formatter":368,"../helpers/separator":380,"./TrackerRegistry":398,"@apple/analytics-data-layer":46}],"@marcom/ac-analytics":[function(require,module,exports){const get=require("@apple/analytics-data-layer").get;const set=require("@apple/analytics-data-layer").set;const dataLayer=require("./ac-analytics/constants").dataLayer;const configuration=dataLayer.configuration;const meta=dataLayer.meta;module.exports={createBasicObserverSuite:require("./ac-analytics/initialize"),initialize:require("./ac-analytics/initialize"),observer:{Click:require("./ac-analytics/observers/Click"),Event:require("./ac-analytics/observers/Event"),Gallery:require("./ac-analytics/observers/Gallery"),Link:require("./ac-analytics/observers/Link"),Page:require("./ac-analytics/observers/Page"),Section:require("./ac-analytics/observers/Section"),Video:require("./ac-analytics/observers/Video"),Registry:require("./ac-analytics/observers/observerRegistry")},track:require("./ac-analytics/Tracker").trackGeneric,passiveTracker:require("./ac-analytics/passiveTracker"),regions:require("./ac-analytics/trackers/regions/regions"),reset:require("./ac-analytics/destroy"),destroy:require("./ac-analytics/destroy"),resetActivityMap:require("./ac-analytics/Appmeasurement/appMeasurementPlugins/activitymap/ActivityMapCollection").createActivityMapCollection,addActivityMapItem:require("./ac-analytics/Appmeasurement/appMeasurementPlugins/activitymap/ActivityMapCollection").addElToCollection,errorHandler:require("./ac-analytics/ErrorHandler"),trackFirstMeaningfulPaint:require("./ac-analytics/trackers/performance").trackFirstMeaningfulPaint,dataLayer:{get:get,set:set,configuration:{key:configuration.key,keys:configuration.keys,get:()=>get(configuration.key)},meta:{key:meta.key,keys:meta.keys,get:()=>get(meta.key)}}}},{"./ac-analytics/Appmeasurement/appMeasurementPlugins/activitymap/ActivityMapCollection":312,"./ac-analytics/ErrorHandler":356,"./ac-analytics/Tracker":358,"./ac-analytics/constants":359,"./ac-analytics/destroy":360,"./ac-analytics/initialize":386,"./ac-analytics/observers/Click":388,"./ac-analytics/observers/Event":390,"./ac-analytics/observers/Gallery":391,"./ac-analytics/observers/Link":392,"./ac-analytics/observers/Page":393,"./ac-analytics/observers/Section":394,"./ac-analytics/observers/Video":395,"./ac-analytics/observers/observerRegistry":396,"./ac-analytics/passiveTracker":397,"./ac-analytics/trackers/performance":410,"./ac-analytics/trackers/regions/regions":412,"@apple/analytics-data-layer":46}]},{},[]);